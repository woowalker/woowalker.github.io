{"version":3,"sources":["assets/custom/flicker.gif","assets/custom/paper-company.svg","assets/custom/paper-machine.svg","assets/custom/engine-stop.png","assets/custom/engine-start.gif","components/common/EasyModal.tsx","components/common/EnergyIcon.tsx","components/common/NowTime.tsx","hooks/index.ts","components/common/CountTime.tsx","components/common/Title.tsx","components/common/PaginationSelect.tsx","components/common/Loading.tsx","components/common/CollpaseZone.tsx","components/common/ColorPicker.tsx","components/page/components/ZoneStyle.tsx","components/page/Zone.tsx","components/root/FormPage.tsx","components/root/ListPage.tsx","components/base/helper.ts","components/root/components/EditPageSubTable.tsx","utils/common.ts","components/root/helper.ts","components/root/EditPage.tsx","components/root/CustomPage.tsx","modules/custom/components/TargetOffset.tsx","modules/custom/components/SPValueImport.tsx","modules/custom/components/ControlConfigSet.tsx","modules/custom/components/ControlLoopSet.tsx","modules/custom/components/CDChart.tsx","modules/custom/components/CDChartShow.tsx","modules/custom/components/TimeChart.tsx","modules/custom/components/TimeChartShow.tsx","modules/custom/components/HistoryChart.tsx","modules/custom/components/HistoryChartShow.tsx","modules/custom/components/DataPreviewRealtime.tsx","modules/custom/components/DataPreviewAvg.tsx","modules/custom/components/DataPreviewTwosigma.tsx","modules/custom/components/DataPreviewHistory.tsx","modules/custom/components/PaperMachineStatus.tsx","modules/custom/components/PaperMonitorControl.tsx","modules/custom/components/PaperMonitorChart.tsx","modules/custom/components/RealTimeAct.tsx","assets/base64.ts","modules/custom/components/RealTimeMea.tsx","modules/custom/components/HistoryPreviewMain.tsx","modules/custom/components/HistoryPreviewAlign.tsx","modules/custom/Home.tsx","modules/custom/PaperMonitor.tsx","utils/socket.ts","modules/custom/ControlMonitor.tsx","modules/custom/DataPreview.tsx","components/root/LoadablePage.tsx","components/root/buttons/list/CustomModalBtn.tsx","components/root/buttons/list/DeleteConfirmBtn.tsx","components/root/buttons/list/AddBtn.tsx","components/root/buttons/edit/SaveBtn.tsx","components/root/buttons/edit/AddBtn.tsx","components/root/LoadableButton.tsx","components/root/controls/TextInput.tsx","components/root/controls/NumberInput.tsx","components/root/controls/PaginationSelect.tsx","components/root/controls/SwitchControl.tsx","components/root/LoadableControl.tsx","components/base/ListTable.tsx","modules/main/index.tsx"],"names":["ModalContext","React","createContext","undefined","EasyModal","props","useState","visible","setVisible","contextValue","useMemo","show","close","fullModal","slot","slotClass","slotStyle","modalProps","omit","Fragment","onClick","disabled","className","style","onOk","Function","promise","Promise","then","onCancel","Provider","value","children","defaultProps","destroyOnClose","title","width","footer","display","cursor","css_prefix_text","icons","allIcons","glyphs","map","item","font_class","EnergyIcon","matchIcon","find","icon","type","defaultIcon","size","allowBlank","fontSize","lineHeight","PictureOutlined","NowTime","dayjs","format","nowTime","setNowTime","useEffect","timer","setInterval","clearInterval","extraFont","useLatest","ref","useRef","current","usePrevious","useDomSize","clientWidth","clientHeight","domSize","setDomSize","ro","ResizeObserver","entries","entry","clearTimeout","setTimeout","target","now","prev","isEqual","observe","disconnect","CountTime","count","setCount","refOfCountChange","onCountChange","refOfCountDone","onCountDone","seconds","targetCount","revert","time","hours","Math","floor","minutes","getTime","Title","backgroundColor","color","Option","Paragraph","PaginationSelect","data","setData","dataTotal","setDataTotal","dataLoading","setDataLoading","search","setSearch","showData","setShowData","debounceSearch","debounce","val","setCurrent","debounceTime","initSearch","setInitSearch","promiseQueue","length","done","push","doing","func","name","remoteMethod","dataField","dataTotalField","res","IsSuccessful","get","resolve","loop","arr","finally","splice","selectProps","paginationProps","optionKeyField","optionLabelField","loading","showSearch","filterOption","onSearch","filterResult","filter","toLowerCase","indexOf","onChange","dropdownRender","menu","spinning","margin","total","textAlign","page","label","evt","stopPropagation","copyable","text","tooltips","defaultActiveFirstOption","placeholder","Loading","percent","setPercent","start","setStart","handler","step","delay","CollpaseZone","sizeStyle","expandSize","collapseSize","left","right","showHandler","zoneClass","zoneStyle","zoneLeftClass","zoneLeftStyle","zoneRightClass","zoneRightStyle","collapse","CaretRightOutlined","CaretLeftOutlined","ColorPicker","curr","setCurr","trigger","content","rgb","rgba","r","g","b","a","overlayClassName","ItemLabel","ZoneStyle","formBase","setFormBase","verify","setVerify","modal","useContext","handleCancel","layout","span","Item","required","validateStatus","min","validateForm","Zone","setZoneStyle","enableTools","tools","settings","forEach","set","$consts","maskClosable","SettingOutlined","CheckFormPage","formState","FORM_TYPE","CODE","formCode","FormPage","setFormState","orgid","commonStore","userinfo","ORG_ID","$api","Key","ListContext","ListPage","tableConfig","setTableConfig","headerBtns","Btns","refOfTable","btn","pageType","config","ID","Nav_Form","NAME","onRef","onLoadedData","tableData","renderTableCell","options","record","field","cell","Array","isArray","join","SubTable","edit","EditContext","Nav_Btns","columns","Nav_Columns","LABEL","FIELD_NAME","dataIndex","render","dataSource","NavFields","pagination","EditPageSubTable","configs","index","initFilter","init","OrgId","Parameter1","Parameter2","Parameter3","Parameter4","Parameter5","Parameter6","Keyword","Sort","Order","PageIndex","Limit","Start","SelectField","RuleCount","IncludeCount","OrderCount","FilterGroupCount","Include","Orders","FilterGroup","Rules","Groups","DataRule","getSingleRule","Field","Operate","Value","IsSysParamRule","toString","extendRules","rules","concat","getSingleGroup","parentGroup","isAnd","childGroups","singleGroup","IsAnd","initGroup","groupRules","operator","isSysParam","extendGroups","groups","verifyField","REQUIRED","fieldValue","isEmpty","EditMain","verifyWhiteList","setVerifyWhiteList","verifyFormBase","useCallback","Nav_PageEdit","includes","table","ListTableContext","selectedData","Nav_SubPageEdits","deepConfig","QUERY_API_URL","payload","singleRule","navFields","col","fields","split","getNavFields","uniq","url","dynamicJs","JS_FILES","formItems","labelCol","wrapperCol","gutter","EditPage","CustomPage","Nav_PageCustom","COMPONENT_NAME","actionApi","TargetOffset","File","IsSaveController","addonAfter","readOnly","showUploadList","maxCount","beforeUpload","file","marginLeft","colon","checked","FormData","append","controlId","mesuringObjectId","axios","getBaseURL","method","message","success","onSuccess","ControllerId","MesuringObjectId","pick","SPValueImport","SPValue","allowClear","actuatorId","ActuatorId","TabPane","changeTimeOptions","ControlConfigSet","isCustom","setIsCustom","groupList","setGroupList","setTargetGroup","Id","targetGroup","targetTimes","setTargetTimes","timeType","setTimeType","AutoInitVarId","DCSVarId","DebugVarId","controlDetail","getDataSource","params","handleSourceSelect","tab","counter","group","IsAutoChangeGroup","InfoCircleOutlined","GroupName","fieldNames","leftTime","onGroupSwitch","presetColors","CDChart","option","setOption","chartData","alignChartData","chartOption","seriesData","position","PositionNumbers","initPoints","Name","Unit","CoordinateMax","CoordinateMin","alignPoints","targetAlign","markLines","markLine","symbol","silent","animation","formatter","lineStyle","xAxis","yAxis","copyData","cloneDeep","points","matchItem","AlignPositionNumber","PositionNumber","chart","checkLoop","IsCloseLoop","itemStyle","notFillEmpty","zeroToUndefined","chartsData","xMin","xMax","yVals","i","yAxisMax","ceil","max","interval","maxInterval","top","textStyle","fontWeight","legend","series","lineOption","barOption","lineName","barName","grid","bottom","containLabel","tooltip","borderColor","seriesName","marker","axisLine","axisTick","alignWithLabel","axisLabel","findIndex","splitLine","nameLocation","nameGap","offset","nameTextStyle","itemColor","areaStyle","x","y","x2","y2","colorStops","barWidth","seriesOption","lazyUpdate","height","CDChartShow","validPoints","range","slider","setSlider","getValidSlider","handleSliderChange","sort","prevPoints","sliderVisible","refOfInitDone","validSlider","onAlignChange","matchChartData","onChartChange","checkedKeys","setCheckedKeys","onCheckedChange","prevChartData","refOfSlider","chartWidth","sliderStyle","timeVisible","checkboxVisible","chartHeight","gap","tipFormatter","CurrentDataTime","LastSnapTime","indeterminate","handleCheckAll","point","TimeChart","Data","Time","TimeChartShow","sliderPosition","HistoryChart","xAxisData","T","yAxisData","P","p","virtualMapRange","fieldIndex","yMapToXData","pi","splitArea","showMinLabel","showMaxLabel","visualMap","emphasis","shadowBlur","shadowColor","HistoryChartShow","validAlignPoint","align","onRangeChange","newSlider","prevDiff","nextDiff","matchMain","matchAlign","main","refOfDiv","sliderPadding","padding","DataPreviewRealtime","previewType","MatchChartOptions","suffix","ClockCircleOutlined","matchChart","Max","Min","Avg","DataPreviewAvg","request","timeRange","MeasuringObjectId","Type","isSigma","MeasuringObjectIds","StartTime","moment","EndTime","actChartsField","meaChartsField","mainChartField","alignChartsField","ActuatorIds","actCharts","meaCharts","charts","setCharts","matchMainChart","setMatchMainChart","matchAlignCharts","matchCharts","alignField","mainField","DataPreviewTwosigma","chartType","yAxisRange","xAxisChart","yAxisChart","S","A","I","unit","sliderDisabled","onSliderChange","DataPreviewHistory","urls","dataChartsField","all","datas","setRange","setMatchChart","preview","setPreview","handlePreview","$evt","addListener","removeListener","progressive","matchSlider","PaperMachineStatus","status","borderRadius","PaperMonitorControl","history","useHistory","machine","CVList","MVList","fakeCount","fakes","fill","UpOutlined","flatMenus","Nav_MenuForm","pathname","orgId","Icon","TowSigma","backgroundImage","require","default","Values","v","vi","f","fi","lineTypes","PaperMonitorChart","actuatorList","setActuatorList","actuator","setActuator","measureList","setMeasureList","measures","setMeasures","setChartData","lineType","setLineType","targetData","se","matchData","d","No","console","log","mode","RealTimeAct","actChart","measureCharts","getCharts","funcs","measureAlignChart","alignChart","j","actAlignChart","actPoints","act","matchActChart","setMatchChartData","matchMeasureCharts","measureSeries","actSeries","barMaxWidth","symbolSize","opacity","PVValue","AlignValue","TwoSigma","UMax","UMin","UAvg","chartPoints","actFind","getAlignChart","baseOption","Object","assign","PVValues","dataZoom","yAxisIndex","filterMode","startValue","endValue","getMeasureChart","YMax","YMin","YAvg","dashLine_bcbcbc","RealTimeMea","measureChart","matchMeaChart","matchActCharts","getActChart","chartSeries","getActSeries","MainMDPreview","mainChart","maxText","minText","MainCDPreview","HistoryPreviewMain","AlignMDPreview","AlignCDPreview","HistoryPreviewAlign","Home","machines","setMachines","Img","IsOnline","Tops","collapsed","copyTops","isName","DownOutlined","t","ti","block","handleNav","gi","Vars","description","switchOptions","PaperMonitor","location","useLocation","queryString","parse","setMachine","getMachine","switchType","setSwitchType","autoHide","autoHeight","autoHeightMax","autoHideTimeout","autoHideDuration","storageSocket","this","socket","onopen","onmessage","onerror","onclose","reconnectTimer","GlobalSocket","autoReconnect","reconnectInterval","socketUrl","reconnectCount","constructorSocket","window","WebSocket","evalFuncs","err","error","Date","toLocaleString","code","reason","reconnect","restProps","pow","generateInterval","Socket","newSocket","globalSocket","socketEvtIndex","readyState","send","observer","setGroup","getGroupDetail","controlStore","setGroupChangeStatus","controlList","Controllers","setControlId","missControlId","latestControlId","setControlDetail","getControlDetail","setControlStatus","controlStatus","refOfTimerStatus","filterList","cvList","mvList","setFilter","missFilterId","MeasuringObject","Actuator","posData","setPosData","getPosData","refOfTimerPos","matchMeasureChart","setCounter","countTime","updateCountTime","LeavingSeconds","handleAutoSwitchEnable","reject","refOfTargetGroup","groupChanging","setGroupChanging","reaction","groupChangeDone","flicker","setFlicker","refOfTimerFlicker","getSocketURL","JSON","TypeCode","handleLoop","IsClose","customActuator","setCustomActuator","chartActuator","copyActuator","SetSPValue","handleSetControl","Cmd","handleControlEnable","startDisable","Status","MidStatus","stopDisable","startStatusDom","gif","src","alt","writeStatusDom","ok","IsSuccess","groupLeftTime","secs","sec","itemWidth","itemHeight","LotNumber","ScanCycle","CycleUnit","MidStatusInfo","danger","IsSemiClosedLoop","IsDCS","IsDebug","IsAutoInit","MaxValue","MinValue","CameraOutlined","ImportOutlined","ExportOutlined","tenant","headers","Tenant","exportUrl","open","TargetGroupChangeTime","NewGroupId","catch","RangePicker","Filter","actFilterList","setActFilterList","meaFilterList","setMeaFilterList","onFilterChange","emit","btns","handleSnapshot","handleExport","currTab","maxTagCount","subtract","setTimeRange","setPreviewType","setCurrTab","showTime","dates","copyDates","isSame","isAfter","add","warning","SearchOutlined","loadingStore","animated","activeKey","tabBarExtraContent","LoadablePage","Component","customPages","CustomModalBtn","ICON","FORM_CODE","ALIAS","DeleteConfirmBtn","onConfirm","API_URL","id","reload","DeleteOutlined","AddBtn","list","CSS","afterClose","SaveBtn","PlusOutlined","EditButton","BTN_TYPE","EditBtns","ListButton","ListBtns","LoadableButton","TextInput","evtConfig","hidden","NumberInput","source","setSource","INPUT_DATA_API","filters","Nav_Filters","OPERATION","VALUE","fullData","extraFields","nav","INPUT_NAV_FIELD","save","INPUT_SAVE_FIELD","navs","saves","getExtraSaveField","SwitchControl","LoadableControl","setEvtConfig","disableControl","enableControl","handleChange","fieldBase","CHANGE_FUNC","baseVerify","matchVerify","CONTROL_TYPE","useFormOptions","formOptions","setFormOptions","getFormOptions","useTablesConfig","getTablesConfig","Nav_Tables","promiseFunc","setTablesConfig","tablesConfig","useTablesData","pageOption","getTableData","extraData","getTableColumns","PageTable","RowBtns","IS_SHOW_ROW_NO","key","IS_DEFAULT","getTableLoadPayload","TableParams","SORT","ORDER","DefaultPageSize","NO_SELECT_FIELD","filterRules","IS_CUSTOM","IS_SYS_PARAM","orgType","menuParameter","OrgType","MenuParameter","splitFileds","splitValues","n","commonRules","FilterGroup_Rules","FilterGroup_Groups","addRuleAndGroups","ROW_NO","TotalCount","tables","setTables","ListTable","setTableData","pageSize","setPagination","setPageOption","newOption","tablesData","selectedKeys","setSelectedKeys","setSelectedData","newData","rowSelection","radioEnable","checkboxEnable","fixed","columnWidth","selectedRowKeys","newKeys","onSelectChange","scroll","setScroll","newScroll","wrapper","document","getElementsByClassName","getElementsByTagName","offsetWidth","offsetHeight","rowKey","singlePageTable","onRow"],"mappings":"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","file":"static/js/5.9989bd80.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/flicker.aac0b453.gif\";","export default __webpack_public_path__ + \"static/media/paper-company.950c0a27.svg\";","export default __webpack_public_path__ + \"static/media/paper-machine.20d3f930.svg\";","export default __webpack_public_path__ + \"static/media/engine-stop.21a7485e.png\";","export default __webpack_public_path__ + \"static/media/engine-start.a4d2e40a.gif\";","import React, { useState, useMemo } from 'react'\r\nimport { Modal, Button } from 'antd'\r\nimport { omit } from 'lodash'\r\n\r\ntype Props = {\r\n  disabled?: boolean,\r\n  fullModal?: boolean,\r\n  slot: React.ReactNode,\r\n  slotClass?: string,\r\n  slotStyle?: Object,\r\n  [propName: string]: any\r\n}\r\n\r\nconst ModalContext = React.createContext<any>(undefined)\r\nconst EasyModal = (props: Props) => {\r\n  const [visible, setVisible] = useState(false)\r\n\r\n  const handleShowModal = () => {\r\n    !props.disabled && setVisible(true)\r\n  }\r\n\r\n  const handleOk = () => {\r\n    if (props.onOk instanceof Function) {\r\n      const promise = props.onOk()\r\n      if (promise instanceof Promise) {\r\n        promise.then(() => {\r\n          setVisible(false)\r\n        })\r\n      } else {\r\n        setVisible(!!promise)\r\n      }\r\n      return\r\n    }\r\n    setVisible(false)\r\n  }\r\n\r\n  const handleCancel = () => {\r\n    props.onCancel instanceof Function && props.onCancel()\r\n    setVisible(false)\r\n  }\r\n\r\n  const contextValue = useMemo(() => {\r\n    return {\r\n      show: () => setVisible(true),\r\n      close: () => setVisible(false)\r\n    }\r\n  }, [])\r\n\r\n  const { fullModal, slot, slotClass, slotStyle } = props\r\n  const modalProps = omit(props, ['className', 'disabled', 'slot', 'slotStyle', 'slotClass', 'children'])\r\n  return (\r\n    <React.Fragment>\r\n      <div onClick={handleShowModal} className={slotClass} style={slotStyle}>{slot}</div>\r\n      <Modal\r\n        {...modalProps}\r\n        visible={visible}\r\n        onOk={handleOk}\r\n        onCancel={handleCancel}\r\n        className={`${props.className} ${fullModal ? 'full-height' : ''}`}\r\n      >\r\n        <ModalContext.Provider value={contextValue}>\r\n          {props.children}\r\n        </ModalContext.Provider>\r\n      </Modal>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\nEasyModal.defaultProps = {\r\n  destroyOnClose: true,\r\n  title: '基本弹框',\r\n  width: '80%',\r\n  footer: null,\r\n  // 自定义 props\r\n  disabled: false,\r\n  fullModal: false,\r\n  slot: <Button>按钮</Button>,\r\n  slotClass: 'form-modal__slot',\r\n  slotStyle: { display: 'inline-block', cursor: 'pointer' }\r\n}\r\n\r\nexport { ModalContext }\r\nexport default EasyModal","import { useMemo } from 'react'\r\nimport { PictureOutlined } from '@ant-design/icons'\r\nimport icons from 'src/styles/fonts/iconfont.json'\r\n\r\nconst { css_prefix_text, glyphs } = icons\r\nconst allIcons = glyphs.map((item: any) => `${css_prefix_text}${item.font_class}`)\r\n\r\ntype Props = {\r\n  type: string,\r\n  size?: number,\r\n  defaultIcon?: string,\r\n  allowBlank?: boolean,\r\n  className?: string,\r\n  style?: Object\r\n}\r\n\r\nconst EnergyIcon = (props: Props) => {\r\n  const matchIcon = useMemo(() => {\r\n    const find = allIcons.find((icon: string) => icon === props.type)\r\n    return find || props.defaultIcon\r\n  }, [props.type, props.defaultIcon])\r\n\r\n  const { size = 14, allowBlank = false, className, style } = props\r\n  if (matchIcon) {\r\n    return (\r\n      <i\r\n        className={`iconfont ${matchIcon} ${className}`}\r\n        style={{\r\n          fontSize: size,\r\n          lineHeight: 1,\r\n          ...style\r\n        }}\r\n      />\r\n    )\r\n  }\r\n  if (!allowBlank) {\r\n    return (\r\n      <PictureOutlined\r\n        className={className}\r\n        style={{\r\n          fontSize: size,\r\n          ...style\r\n        }}\r\n      />\r\n    )\r\n  }\r\n  return null\r\n}\r\n\r\nexport default EnergyIcon","import { useState, useEffect } from 'react'\r\nimport dayjs from 'dayjs'\r\n\r\ntype Props = {\r\n  extraFont?: string,\r\n  className?: string,\r\n  style?: Object\r\n}\r\n\r\nconst NowTime = (props: Props) => {\r\n  const [nowTime, setNowTime] = useState(dayjs().format('YYYY-MM-DD HH:mm:ss'))\r\n\r\n  useEffect(() => {\r\n    let timer = setInterval(() => {\r\n      setNowTime(dayjs().format('YYYY-MM-DD HH:mm:ss'))\r\n    }, 1000)\r\n    return () => clearInterval(timer)\r\n  }, [])\r\n\r\n  return <span className={props.className} style={props.style}>{`${props.extraFont}${nowTime}`}</span>\r\n}\r\n\r\nexport default NowTime","import { useState, useRef, useEffect } from 'react'\r\nimport ResizeObserver from 'resize-observer-polyfill'\r\nimport { isEqual } from 'lodash'\r\n\r\nexport function useLatest<T> (value: T) {\r\n  const ref = useRef(value)\r\n  ref.current = value\r\n\r\n  return ref\r\n}\r\n\r\nexport function usePrevious (value: any) {\r\n  const ref = useRef()\r\n  useEffect(() => {\r\n    ref.current = value\r\n  })\r\n  return ref.current\r\n}\r\n\r\nexport function useWindowSize () {\r\n  const [windowSize, setWindowSize] = useState({\r\n    width: 0,\r\n    height: 0\r\n  })\r\n\r\n  useEffect(() => {\r\n    function handleResize () {\r\n      setWindowSize({\r\n        width: window.innerWidth,\r\n        height: window.innerHeight\r\n      })\r\n    }\r\n    window.addEventListener('resize', handleResize)\r\n    handleResize()\r\n\r\n    return () => window.removeEventListener('resize', handleResize)\r\n  }, [])\r\n\r\n  return windowSize\r\n}\r\n\r\nexport function useDomSize (ref: any) {\r\n  const [domSize, setDomSize] = useState({ clientWidth: 0, clientHeight: 0 })\r\n\r\n  useEffect(() => {\r\n    if (!ref?.current) return\r\n\r\n    let timer: any = -1\r\n    const ro = new ResizeObserver((entries) => {\r\n      for (const entry of entries) {\r\n        clearTimeout(timer)\r\n        timer = setTimeout(() => {\r\n          const { clientWidth, clientHeight } = entry.target\r\n          const now = { clientWidth, clientHeight }\r\n          setDomSize(prev => isEqual(prev, now) ? prev : now)\r\n        }, 200)\r\n      }\r\n    })\r\n\r\n    ro.observe(ref.current)\r\n\r\n    return () => {\r\n      clearTimeout(timer)\r\n      ro.disconnect()\r\n    }\r\n  }, [])\r\n\r\n  return domSize\r\n}","import { useState, useEffect, useMemo } from 'react'\r\nimport { useLatest } from 'src/hooks'\r\n\r\nconst getTime = (time: number) => {\r\n  const hours = Math.floor(time / 3600)\r\n  const minutes = Math.floor((time - hours * 3600) / 60)\r\n  const seconds = time - hours * 3600 - minutes * 60\r\n  return `${hours < 10 ? '0' + hours : hours}:${minutes < 10 ? '0' + minutes : minutes}:${seconds < 10 ? '0' + seconds : seconds}`\r\n}\r\n\r\ntype Props = {\r\n  seconds: number,\r\n  targetCount?: number,\r\n  onCountChange?: Function,\r\n  onCountDone?: Function,\r\n  revert?: boolean,\r\n  extraFont?: string,\r\n  className?: string,\r\n  style?: Object\r\n}\r\n\r\nconst CountTime = (props: Props) => {\r\n  const [count, setCount] = useState<number>(0)\r\n \r\n  const refOfCountChange = useLatest(props.onCountChange)\r\n  useEffect(() => {\r\n    refOfCountChange.current?.(count)\r\n  }, [count])\r\n\r\n  const refOfCountDone = useLatest(props.onCountDone)\r\n  useEffect(() => {\r\n    let { seconds, targetCount = 0, revert } = props\r\n    if (!seconds) {\r\n      setCount(0)\r\n      return\r\n    }\r\n\r\n    // 立即执行一次\r\n    setCount(seconds)\r\n\r\n    const timer = setInterval(() => {\r\n      setCount(revert ? ++seconds : --seconds)\r\n      if (seconds === targetCount) {\r\n        clearInterval(timer)\r\n        refOfCountDone.current?.()\r\n      }\r\n    }, 1000)\r\n\r\n    return () => clearInterval(timer)\r\n\r\n  }, [props.seconds, props.targetCount, props.revert])\r\n\r\n  const nowTime = useMemo(() => {\r\n    return getTime(count)\r\n  }, [count])\r\n\r\n  return <span className={props.className} style={props.style}>{`${props.extraFont}${nowTime}`}</span>\r\n}\r\n\r\nexport default CountTime","import 'src/styles/components/common/title.less'\r\n\r\ntype Props = {\r\n  className?: string,\r\n  style?: Object,\r\n  title: string,\r\n  color?: string\r\n}\r\n\r\nconst Title = (props: Props) => {\r\n  return (\r\n    <div className={`title ${props.className || ''}`} style={props.style}>\r\n      <div className='title__divide' style={{ backgroundColor: props.color }} />\r\n      <span className='title__title' style={{ color: props.color }}>{props.title}</span>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Title","import { useState, useEffect } from 'react'\r\nimport { Pagination, Select, Divider, Spin, Typography } from 'antd'\r\nimport { get, debounce } from 'lodash'\r\nimport 'src/styles/components/common/paginationSelect.less'\r\n\r\nconst { Option } = Select\r\nconst { Paragraph } = Typography\r\n\r\ntype Props = {\r\n  name?: string,\r\n  value?: string | number,\r\n  remoteMethod: Function,\r\n  onChange?: Function,\r\n  selectProps?: any,\r\n  paginationProps?: Object,\r\n  dataField?: string,\r\n  dataTotalField?: string,\r\n  optionKeyField?: string,\r\n  optionLabelField?: string,\r\n  debounceTime?: number,\r\n  style?: Object\r\n}\r\n\r\nfunction PaginationSelect (props: Props) {\r\n  const [data, setData] = useState([])\r\n  const [dataTotal, setDataTotal] = useState(0)\r\n  const [dataLoading, setDataLoading] = useState(false)\r\n\r\n  /**\r\n   * 搜索与远程搜索\r\n   */\r\n  const [search, setSearch] = useState('')\r\n  const [showData, setShowData] = useState([])\r\n\r\n  const debounceSearch = debounce((val) => {\r\n    setSearch(val)\r\n    setCurrent(1)\r\n  }, props.debounceTime)\r\n  const handleSearch = (value: string) => {\r\n    const { optionKeyField = '', optionLabelField = '' } = props\r\n    if (value) {\r\n      const filterResult = data.filter((item: any) => {\r\n        return item[optionKeyField].toLowerCase().indexOf(value.toLowerCase()) !== -1 || item[optionLabelField].toLowerCase().indexOf(value.toLowerCase()) !== -1\r\n      })\r\n      filterResult.length ? setShowData(filterResult) : debounceSearch(value)\r\n    } else {\r\n      debounceSearch('')\r\n    }\r\n  }\r\n\r\n  const handleChange = (value: string | number) => {\r\n    const { onChange } = props\r\n    onChange instanceof Function && onChange(value)\r\n  }\r\n\r\n  useEffect(() => {\r\n    setShowData(data)\r\n  }, [data])\r\n\r\n  /**\r\n   * 分页数据的首次搜索\r\n   * initSearch: 默认ID值\r\n   */\r\n  const [initSearch, setInitSearch] = useState<any>('')\r\n  useEffect(() => {\r\n    if (initSearch !== props.value) {\r\n      setInitSearch(props.value)\r\n      setCurrent(1)\r\n    }\r\n  }, [props.value, initSearch])\r\n\r\n  /**\r\n   * 分页\r\n   */\r\n  const [current, setCurrent] = useState(1)\r\n  const [promiseQueue] = useState<any>([])\r\n\r\n  useEffect(() => {\r\n    // 此处逻辑是为了保证调用顺序和接口返回数据一致，避免调用两次，而第二次的数据返回快于第一次的情况\r\n    if (!promiseQueue.length || !promiseQueue[0].done) {\r\n      promiseQueue.push({\r\n        done: false,\r\n        doing: false,\r\n        func: () => {\r\n          const { name, remoteMethod, dataField = '', dataTotalField = '' } = props\r\n          if (remoteMethod instanceof Function) {\r\n            return remoteMethod({\r\n              name,\r\n              initSearch,\r\n              search,\r\n              current\r\n            }).then((res: any) => {\r\n              if (res && res.IsSuccessful) {\r\n                setData(get(res, dataField))\r\n                setDataTotal(get(res, dataTotalField))\r\n              }\r\n            })\r\n          } else {\r\n            return Promise.resolve()\r\n          }\r\n        }\r\n      })\r\n    }\r\n\r\n    function loop (arr: any) {\r\n      if (!arr[0].done && !arr[0].doing) {\r\n        arr[0].doing = true\r\n        setDataLoading(true)\r\n        arr[0].func().finally(() => {\r\n          setDataLoading(false)\r\n          arr.splice(0, 1)\r\n          arr.length && loop(arr)\r\n        })\r\n      }\r\n    }\r\n\r\n    loop(promiseQueue)\r\n  }, [initSearch, search, current])\r\n\r\n  const { value, selectProps, paginationProps, optionKeyField = '', optionLabelField = '' } = props\r\n  return (\r\n    <Select\r\n      loading={dataLoading}\r\n      {...selectProps}\r\n      value={value}\r\n      showSearch\r\n      filterOption={false}\r\n      onSearch={handleSearch}\r\n      onChange={handleChange}\r\n      dropdownRender={(menu: any) => (\r\n        <Spin spinning={selectProps.loading || dataLoading}>\r\n          {menu}\r\n          <Divider style={{ margin: '4px 0' }} />\r\n          <Pagination\r\n            size='small'\r\n            total={dataTotal}\r\n            style={{ textAlign: 'center' }}\r\n            {...paginationProps}\r\n            current={current}\r\n            onChange={page => setCurrent(page)}\r\n          />\r\n        </Spin>\r\n      )}\r\n      style={props.style}\r\n    >\r\n      {\r\n        showData.map(item => {\r\n          const label = get(item, optionLabelField)\r\n          const value = get(item, optionKeyField)\r\n          return (\r\n            <Option key={value} value={value} title={label}>\r\n              <div className='text-overflow pagination-select__option'>\r\n                <span>{label}</span>\r\n                <Paragraph\r\n                  onClick={(evt: any) => evt.stopPropagation()}\r\n                  copyable={{ text: label, tooltips: ['复制', '成功'] }}\r\n                  className='pagination-select__copyable'\r\n                />\r\n              </div>\r\n            </Option>\r\n          )\r\n        })\r\n      }\r\n    </Select>\r\n  )\r\n}\r\n\r\nPaginationSelect.defaultProps = {\r\n  name: '',\r\n  value: '',\r\n  remoteMethod: () => [],\r\n  onChange: () => [],\r\n  selectProps: {\r\n    loading: false,\r\n    defaultActiveFirstOption: false,\r\n    placeholder: '请选择'\r\n  },\r\n  paginationProps: {},\r\n  dataField: 'Data',\r\n  dataTotalField: 'TotalCount',\r\n  optionKeyField: 'ID',\r\n  optionLabelField: 'NAME',\r\n  debounceTime: 500,\r\n  style: { width: '100%' }\r\n}\r\n\r\nexport default PaginationSelect\r\n","import { useState, useEffect } from 'react'\r\nimport 'src/styles/components/common/loading.less'\r\n\r\ntype Props = {\r\n  loading: boolean,\r\n  delay?: number\r\n}\r\nconst Loading = (props: Props) => {\r\n  const [visible, setVisible] = useState(props.loading)\r\n  const [percent, setPercent] = useState(0)\r\n  const [start, setStart] = useState(false)\r\n\r\n  useEffect(() => {\r\n    let handler: any = -1\r\n    const step = percent > 80 ? 0.01 : percent > 60 ? 0.04 : percent > 40 ? 0.1 : percent > 20 ? 0.2 : 0.5\r\n    \r\n    if (props.loading) {\r\n      if (start) {\r\n        setVisible(true)\r\n        handler = setTimeout(() => {\r\n          percent <= 90 && setPercent(percent + step)\r\n        }, 10)\r\n      } else {\r\n        handler = setTimeout(() => {\r\n          setStart(true)\r\n        }, props.delay || 200)\r\n      }\r\n    } else {\r\n      setVisible(false)\r\n      setPercent(0)\r\n      setStart(false)\r\n    }\r\n\r\n    return () => clearTimeout(handler)\r\n  }, [props.loading, percent, start])\r\n\r\n  if (!visible) return null\r\n\r\n  return (\r\n    <div className='loading'>\r\n      <div className='loading__content'>\r\n        <div className='loading__content-shape shape-1' />\r\n        <div className='loading__content-shape shape-2' />\r\n        <div className='loading__content-shape shape-3' />\r\n        <div className='loading__content-shape shape-4' />\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Loading\r\n","import React, { useState, useEffect, useMemo } from 'react'\r\nimport { CaretLeftOutlined, CaretRightOutlined } from '@ant-design/icons'\r\nimport 'src/styles/components/common/collapseZone.less'\r\n\r\ntype Props = {\r\n  children: any,\r\n  collapse: any,\r\n  visible?: boolean,\r\n  onChange?: Function,\r\n  showHandler?: boolean,\r\n  expandSize?: string,\r\n  collapseSize?: string,\r\n  zoneClass?: string,\r\n  zoneStyle?: Object,\r\n  zoneLeftClass?: string,\r\n  zoneLeftStyle?: Object,\r\n  zoneRightClass?: string,\r\n  zoneRightStyle?: Object\r\n}\r\nconst CollpaseZone = (props: Props) => {\r\n  const [visible, setVisible] = useState<boolean | undefined>(false)\r\n  useEffect(() => {\r\n    setVisible(prev => prev === props.visible ? prev : props.visible)\r\n  }, [props.visible])\r\n  useEffect(() => {\r\n    props.onChange instanceof Function && props.onChange(visible)\r\n  }, [visible])\r\n\r\n  const sizeStyle = useMemo(() => {\r\n    const { expandSize = '270px', collapseSize = '0px' } = props\r\n    return {\r\n      left: visible ? `calc(100% - ${expandSize})` : `calc(100% - ${collapseSize})`,\r\n      right: visible ? expandSize : collapseSize\r\n    }\r\n  }, [visible, props.expandSize, props.collapseSize])\r\n\r\n  const { showHandler = true, zoneClass, zoneStyle, zoneLeftClass, zoneLeftStyle, zoneRightClass, zoneRightStyle } = props\r\n  return (\r\n    <div className={`collapse-zone ${zoneClass}`} style={zoneStyle}>\r\n      <div className={`collapse-zone__left ${zoneLeftClass}`} style={{ ...zoneLeftStyle, width: sizeStyle.left }}>\r\n        {props.children}\r\n      </div>\r\n      <div className={`collapse-zone__right ${zoneRightClass}`} style={{ ...zoneRightStyle, width: sizeStyle.right }}>\r\n        {props.collapse}\r\n        {\r\n          showHandler\r\n            ? (\r\n              <div onClick={() => setVisible(!visible)} className='collapse-zone__right-collapse'>\r\n                {visible ? <CaretRightOutlined style={{ fontSize: 24 }} /> : <CaretLeftOutlined style={{ fontSize: 24 }} />}\r\n              </div>\r\n            )\r\n            : null\r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default CollpaseZone","import { useState, useEffect, useRef } from 'react'\r\nimport { Popover } from 'antd'\r\nimport { SketchPicker } from 'react-color'\r\nimport 'src/styles/components/common/colorPicker.less'\r\n\r\nconst getSketchRGBA = (rgb: { r: number, g: number, b: number, a: number }) => {\r\n  return `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, ${rgb.a})`\r\n}\r\n\r\ntype Props = {\r\n  color: string,\r\n  onChange?: Function\r\n}\r\nconst ColorPicker = (props: Props) => {\r\n  const [curr, setCurr] = useState('#ffffff')\r\n\r\n  useEffect(() => {\r\n    setCurr(prev => prev !== props.color ? props.color : prev)\r\n  }, [props.color])\r\n\r\n  const timer = useRef<any>(-1)\r\n  const handleColorChange = (color: any) => {\r\n    const rgba = getSketchRGBA(color.rgb)\r\n    setCurr(rgba)\r\n\r\n    // 防抖\r\n    clearTimeout(timer.current)\r\n    timer.current = setTimeout(() => {\r\n      const { onChange } = props\r\n      onChange instanceof Function && onChange(rgba)\r\n    }, 200)\r\n  }\r\n\r\n  return (\r\n    <Popover\r\n      trigger='click'\r\n      content={\r\n        <SketchPicker\r\n          width='240px'\r\n          color={curr}\r\n          onChange={handleColorChange}\r\n        />\r\n      }\r\n      overlayClassName='color-picker'\r\n    >\r\n      <div className='color-picker__color' style={{ backgroundColor: curr }} />\r\n    </Popover>\r\n  )\r\n}\r\n\r\nexport default ColorPicker","import React, { useEffect, useState, useContext } from 'react'\r\nimport { Form, InputNumber, Row, Col, Button } from 'antd'\r\nimport { ModalContext, ColorPicker } from 'src/components'\r\n\r\ntype Label = {\r\n  label: string,\r\n  width?: number\r\n}\r\nconst ItemLabel = (props: Label) => {\r\n  const { label, width = 60 } = props\r\n  return <div style={{ width }}>{label}</div>\r\n}\r\n\r\ntype Props = {\r\n  zoneStyle?: Object,\r\n  onChange?: Function\r\n}\r\nconst ZoneStyle = (props: Props) => {\r\n  const [formBase, setFormBase] = useState({\r\n    backgroundColor: '#ffffff',\r\n    color: '#ffffff',\r\n    fontSize: 14\r\n  })\r\n  useEffect(() => {\r\n    setFormBase(prev => ({ ...prev, ...props.zoneStyle }))\r\n  }, [props.zoneStyle])\r\n\r\n  // form 表单验证状态\r\n  const [verify, setVerify] = useState<any>({})\r\n  const validateForm = () => {\r\n    const { fontSize } = formBase\r\n    !fontSize ? (verify.fontSize = 'error') : (verify.fontSize = undefined)\r\n    setVerify({ ...verify })\r\n    return !fontSize\r\n  }\r\n\r\n  // 弹框\r\n  const modal = useContext(ModalContext)\r\n  const handleOk = () => {\r\n    if (validateForm()) return\r\n\r\n    props.onChange instanceof Function && props.onChange(formBase)\r\n    handleCancel()\r\n  }\r\n  const handleCancel = () => {\r\n    modal.close()\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Form layout='inline'>\r\n        <Row>\r\n          <Col span={24} className='mg-b12'>\r\n            <Form.Item label={<ItemLabel label='背景颜色' />}>\r\n              <ColorPicker\r\n                color={formBase.backgroundColor}\r\n                onChange={(rgba: string) => setFormBase({ ...formBase, backgroundColor: rgba })}\r\n              />\r\n            </Form.Item>\r\n          </Col>\r\n          <Col span={24} className='mg-b12'>\r\n            <Form.Item label={<ItemLabel label='文字颜色' />}>\r\n              <ColorPicker\r\n                color={formBase.color}\r\n                onChange={(rgba: string) => setFormBase({ ...formBase, color: rgba })}\r\n              />\r\n            </Form.Item>\r\n          </Col>\r\n          <Col span={24} className='mg-b12'>\r\n            <Form.Item\r\n              label={<ItemLabel label='文字大小' />}\r\n              required\r\n              validateStatus={verify.fontSize}\r\n            >\r\n              <InputNumber\r\n                min={12}\r\n                value={formBase.fontSize}\r\n                onChange={(val: number) => setFormBase({ ...formBase, fontSize: val })}\r\n              />\r\n            </Form.Item>\r\n          </Col>\r\n        </Row>\r\n      </Form>\r\n      <div className='ant-modal-footer'>\r\n        <Button onClick={handleCancel}>取消</Button>\r\n        <Button type='primary' onClick={handleOk}>确定</Button>\r\n      </div>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\nexport default ZoneStyle","import React, { useState, useMemo } from 'react'\r\nimport { SettingOutlined } from '@ant-design/icons'\r\nimport { EasyModal } from 'src/components'\r\nimport { ZoneStyle } from './components'\r\nimport { $consts } from 'src/plugins'\r\nimport 'src/styles/components/page/zone.less'\r\n\r\ntype Props = {\r\n  settings: ('Style' | 'Menus')[],\r\n  children: React.ReactChild | React.ReactChild[]\r\n}\r\nconst Zone = (props: Props) => {\r\n  const [zoneStyle, setZoneStyle] = useState()\r\n\r\n  const enableTools = useMemo(() => {\r\n    const tools: any = {}\r\n    props.settings.forEach((set: string) => {\r\n      tools[set] = true\r\n    })\r\n    return tools\r\n  }, [props.settings])\r\n\r\n  return (\r\n    <div className='zone'>\r\n      <div className='zone__content' style={zoneStyle}>\r\n        {props.children}\r\n      </div>\r\n      <div className='zone__tool'>\r\n        {\r\n          enableTools[$consts['COMMON/ZONE_TOOL_STYLE']]\r\n            ? (\r\n              <EasyModal\r\n                title='区域样式'\r\n                width='300px'\r\n                maskClosable={false}\r\n                slot={<SettingOutlined title='区域样式' />}\r\n              >\r\n                <ZoneStyle zoneStyle={zoneStyle} onChange={setZoneStyle} />\r\n              </EasyModal>\r\n            )\r\n            : null\r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Zone","import { useState, useEffect } from 'react'\r\nimport { ListPage, CustomPage, EditPage } from 'src/components'\r\nimport { commonStore } from 'src/stores'\r\nimport { $api, $consts } from 'src/plugins'\r\n\r\ntype CheckProps = {\r\n  formCode: string,\r\n  formState?: any\r\n}\r\n\r\nconst CheckFormPage = (props: CheckProps) => {\r\n  const { formState } = props\r\n  if (formState) {\r\n    const { FORM_TYPE, CODE } = formState\r\n    switch (FORM_TYPE) {\r\n      // 列表表单\r\n      case $consts['TABLE/FORM_TYPE_LIST_PAGE']:\r\n        return <ListPage formCode={CODE} />\r\n      // 自定义表单\r\n      case $consts['TABLE/FORM_TYPE_CUSTOM_PAGE']:\r\n        return <CustomPage formCode={CODE} />\r\n      // 编辑表单\r\n      case $consts['TABLE/FORM_TYPE_EDIT_PAGE']:\r\n        return <EditPage formCode={CODE} />\r\n      default:\r\n        return null\r\n    }\r\n  }\r\n\r\n  return null\r\n}\r\n\r\ntype Props = {\r\n  formCode: string\r\n}\r\n\r\nconst FormPage = (props: Props) => {\r\n  const [formState, setFormState] = useState()\r\n\r\n  useEffect(() => {\r\n    const { ORG_ID: orgid } = commonStore.userinfo\r\n    $api['app/getByRedis']({\r\n      Key: props.formCode,\r\n      orgid\r\n    }).then((res: any) => {\r\n      res && setFormState(res)\r\n    })\r\n  }, [props.formCode])\r\n\r\n  return (\r\n    <CheckFormPage\r\n      formCode={props.formCode}\r\n      formState={formState}\r\n    />\r\n  )\r\n}\r\n\r\nexport default FormPage","import React, { useState, useMemo, useRef } from 'react'\r\nimport { Title, LoadableButton, ListTable } from 'src/components'\r\nimport { $consts } from 'src/plugins'\r\nimport 'src/styles/components/root/listPage.less'\r\n\r\ntype Props = {\r\n  formCode: string\r\n}\r\n\r\nconst ListContext = React.createContext<any>(undefined)\r\nconst ListPage = (props: Props) => {\r\n  const [tableConfig, setTableConfig] = useState<any>()\r\n\r\n  const handleLoadedData = (tableData: any) => {\r\n    setTableConfig(tableData.config)\r\n  }\r\n\r\n  const headerBtns = useMemo(() => {\r\n    return tableConfig?.Btns || []\r\n  }, [tableConfig])\r\n\r\n  const refOfTable = useRef()\r\n  return (\r\n    <ListContext.Provider value={refOfTable.current}>\r\n      <div className='list-page'>\r\n        {\r\n          headerBtns.length\r\n            ? (\r\n              <div className='list-page__header'>\r\n                {headerBtns.map((btn: any) => <LoadableButton key={btn.ID} pageType={$consts['TABLE/FORM_TYPE_LIST_PAGE']} config={btn} />)}\r\n              </div>\r\n            )\r\n            : null\r\n        }\r\n        <div className='list-page__table'>\r\n          <Title title={tableConfig?.Nav_Form?.NAME || '基础表格'} className='mg-b18' />\r\n          <ListTable\r\n            onRef={(ref: any) => refOfTable.current = ref}\r\n            formCode={props.formCode}\r\n            onLoadedData={handleLoadedData}\r\n          />\r\n        </div>\r\n      </div>\r\n    </ListContext.Provider>\r\n  )\r\n}\r\n\r\nexport { ListContext }\r\nexport default ListPage","import { get } from 'lodash'\r\n\r\ntype CellOptions = {\r\n  record: any,\r\n  field: string\r\n}\r\nexport const renderTableCell = (options: CellOptions) => {\r\n  const { record, field } = options\r\n  let cell = get(record, field)\r\n  if (Array.isArray(cell)) {\r\n    cell = cell.join(';')\r\n  }\r\n  return cell\r\n}","import { useMemo, useContext } from 'react'\r\nimport { Table, Popover } from 'antd'\r\nimport { EditContext, LoadableButton } from 'src/components'\r\nimport { $consts } from 'src/plugins'\r\nimport { renderTableCell } from 'src/components/base/helper'\r\nimport { get } from 'lodash'\r\n\r\ntype SubProps = {\r\n  config: any\r\n}\r\nconst SubTable = (props: SubProps) => {\r\n  const edit = useContext(EditContext)\r\n\r\n  // 配置的头部按钮\r\n  const headerBtns = useMemo(() => {\r\n    const { Nav_Btns = [] } = props.config\r\n    if (!Nav_Btns.length) return null\r\n    return (\r\n      <div className='edit-page__subtable-header'>\r\n        {Nav_Btns.map((btn: any) => <LoadableButton key={btn.ID} pageType={$consts['TABLE/FORM_TYPE_EDIT_PAGE']} config={btn} />)}\r\n      </div>\r\n    )\r\n  }, [props.config])\r\n\r\n  const columns = useMemo(() => {\r\n    const { Nav_Columns = [] } = props.config\r\n    return Nav_Columns.map((item: any) => {\r\n      const { LABEL, FIELD_NAME } = item\r\n      return {\r\n        title: LABEL,\r\n        dataIndex: FIELD_NAME,\r\n        render: (text: any, record: any) => {\r\n          return (\r\n            <Popover trigger='click'>\r\n              <span>{renderTableCell({ record, field: FIELD_NAME })}</span>\r\n            </Popover>\r\n          )\r\n        }\r\n      }\r\n    })\r\n  }, [props.config])\r\n\r\n  const dataSource = useMemo(() => {\r\n    return get(edit?.formBase, props.config?.NavFields)\r\n  }, [props.config])\r\n\r\n  return (\r\n    <div className='edit-page__subtable'>\r\n      {headerBtns}\r\n      <Table\r\n        pagination={false}\r\n        columns={columns}\r\n        dataSource={dataSource}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\ntype Props = {\r\n  configs: any[]\r\n}\r\nconst EditPageSubTable = (props: Props) => {\r\n  const { configs } = props\r\n  if (!Array.isArray(configs) || !configs.length) return null\r\n\r\n  return (\r\n    <div className='mg-t12 border-top'>\r\n      {configs.map((config: any, index: number) => <SubTable key={`edit-page__subtable-${index}`} config={config} />)}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default EditPageSubTable","import { uniq } from 'lodash'\r\n\r\ntype Filter = {\r\n  OrgId: string,\r\n  Parameter1?: string | number,\r\n  Parameter2?: string | number,\r\n  Parameter3?: string | number,\r\n  Parameter4?: string | number,\r\n  Parameter5?: string | number,\r\n  Parameter6?: string | number,\r\n  Keyword?: string | number,\r\n  Sort?: string | number,\r\n  Order?: number,\r\n  PageIndex?: number,\r\n  Limit?: number,\r\n  Start?: number,\r\n  SelectField?: Array<any>\r\n}\r\n\r\nexport function initFilter (init: Filter) {\r\n  const {\r\n    OrgId,\r\n    Parameter1,\r\n    Parameter2,\r\n    Parameter3,\r\n    Parameter4,\r\n    Parameter5,\r\n    Parameter6,\r\n    Keyword = \"\",\r\n    Sort,\r\n    Order = 0,\r\n    PageIndex = 1,\r\n    Limit = 10,\r\n    Start = ((init.PageIndex || 1) - 1) * (init.Limit || 10),\r\n    SelectField = []\r\n  } = init\r\n  return {\r\n    OrgId,\r\n    Parameter1,\r\n    Parameter2,\r\n    Parameter3,\r\n    Parameter4,\r\n    Parameter5,\r\n    Parameter6,\r\n    Keyword,\r\n    Sort,\r\n    Order,\r\n    PageIndex,\r\n    Limit,\r\n    Start,\r\n    RuleCount: 0,\r\n    IncludeCount: 0,\r\n    OrderCount: 0,\r\n    FilterGroupCount: 0,\r\n    Include: [],\r\n    Orders: [],\r\n    FilterGroup: { Rules: [], Groups: [] },\r\n    SelectField,\r\n    DataRule: []\r\n  }\r\n}\r\n\r\n/**\r\n * 获取单个 rule\r\n * @param Field 字段\r\n * @param Operate 操作符\r\n * @param Value 值\r\n * @param IsSysParamRule 系统规则\r\n * @returns \r\n */\r\nexport function getSingleRule (Field: string, Operate: number, Value: number | string, IsSysParamRule?: boolean) {\r\n  Value = Value === null ? '' : Value\r\n  return {\r\n    Field,\r\n    Operate,\r\n    Value: IsSysParamRule ? Value.toString() : Value,\r\n    IsSysParamRule: !!IsSysParamRule\r\n  }\r\n}\r\n\r\n/**\r\n * 扩展 FilterGroup.Rules 数组\r\n * @param target \r\n * @param rules \r\n */\r\nexport function extendRules (target: any, rules: any) {\r\n  if (Array.isArray(target?.Rules)) {\r\n    target.Rules = [].concat(target.Rules, rules)\r\n  }\r\n}\r\n\r\n/**\r\n * 扩展 filter.Include 数组\r\n * @param target \r\n * @param includes \r\n */\r\nexport function extendInclude (target: any, includes: string[]) {\r\n  if (Array.isArray(target?.Include)) {\r\n    target.Include = uniq(([] as string[]).concat(target.Include, includes))\r\n  }\r\n}\r\n\r\n/**\r\n * FilterGroup.Groups 对象\r\n * @param IsAnd 与条件\r\n * @returns \r\n */\r\nexport function initGroup (IsAnd: boolean = true) {\r\n  return {\r\n    IsAnd,\r\n    Rules: [],\r\n    Groups: [],\r\n  }\r\n}\r\n\r\ntype Group = {\r\n  isAnd: boolean,\r\n  rules: Array<any>,\r\n  childGroups: Array<any>,\r\n  Groups: Array<any>\r\n}\r\n\r\n/**\r\n * 获取单个 FilterGroup.Groups 对象具体的 Rules 和 Groups\r\n * @param {Group} param0 \r\n * @param parentGroup FilterGroup.Groups 对象\r\n * @returns \r\n */\r\nexport function getSingleGroup ({ isAnd, rules, childGroups }: Group, parentGroup?: Group) {\r\n  const singleGroup = initGroup(isAnd)\r\n\r\n  if (Array.isArray(rules) && rules.length) {\r\n    const groupRules: any = []\r\n    rules.forEach(({ field, operator, value, isSysParam }) => {\r\n      groupRules.push(getSingleRule(field, operator, value, isSysParam))\r\n    })\r\n    extendRules(singleGroup, groupRules)\r\n  }\r\n\r\n  if (Array.isArray(childGroups) && childGroups.length) {\r\n    childGroups.forEach(item => {\r\n      getSingleGroup(item, parentGroup)\r\n    })\r\n  }\r\n\r\n  parentGroup && parentGroup.Groups.push(singleGroup)\r\n\r\n  return singleGroup\r\n}\r\n\r\n/**\r\n * 扩展 FilterGroup.Groups 数组\r\n * @param target \r\n * @param groups \r\n */\r\nexport function extendGroups (target: any, groups: any) {\r\n  if (Array.isArray(target?.Groups)) {\r\n    target.Groups = [].concat(target.Groups, groups)\r\n  }\r\n}\r\n\r\n/**\r\n * target 添加 OrgType 或 MenuParameter，target.FilterGroup 添加 Rules 和 Groups\r\n * @param {Object} target 目标对象\r\n * @param {Object} target.FilterGroup\r\n * @param {Object} target.OrgType\r\n * @param {Object} target.MenuParameter\r\n * @param {Object} source\r\n * @param {Object} source.rules\r\n * @param {Object} source.groups\r\n * @param {Object} source.orgType\r\n * @param {Object} source.menuParameter\r\n */\r\ntype Target = {\r\n  FilterGroup: Object,\r\n  OrgType?: number | string,\r\n  MenuParameter?: number | string,\r\n  [propName: string]: any\r\n}\r\n\r\ntype Source = {\r\n  rules?: Array<any>,\r\n  groups?: Array<any>,\r\n  orgType?: number | string,\r\n  menuParameter?: number | string\r\n}\r\n\r\nexport function addRuleAndGroups (target: Target, source: Source = {}) {\r\n  const { rules, groups, orgType, menuParameter } = source\r\n  orgType && (target.OrgType = orgType)\r\n  menuParameter && (target.MenuParameter = menuParameter)\r\n\r\n  if (Array.isArray(rules) && rules.length) {\r\n    // 自定义过滤规则\r\n    const customRules = rules.filter(item => item.isCustom)\r\n    customRules.forEach(({ field, value }) => {\r\n      if (field.indexOf(',') !== -1) {\r\n        const splitFileds = field.split(',')\r\n        const splitValues = value.toString().split(',')\r\n        splitFileds.forEach((n: any, i: number) => {\r\n          target[n] = splitValues[i]\r\n        })\r\n      } else {\r\n        target[field] = value\r\n      }\r\n    })\r\n\r\n    // 过滤规则: pf001 -> 列表配置 -> 操作：过滤\r\n    const commonRules = rules.filter(item => !item.isCustom)\r\n    const FilterGroup_Rules: any = []\r\n    commonRules.forEach(({ field, operator, value, isSysParam }) => {\r\n      FilterGroup_Rules.push(getSingleRule(field, operator, value, isSysParam))\r\n    })\r\n    extendRules(target.FilterGroup, FilterGroup_Rules)\r\n  }\r\n\r\n  if (Array.isArray(groups) && groups.length) {\r\n    const FilterGroup_Groups: any = []\r\n    groups.forEach(item => {\r\n      FilterGroup_Groups.push(getSingleGroup(item))\r\n    })\r\n    extendGroups(target.FilterGroup, FilterGroup_Groups)\r\n  }\r\n}","import { get } from 'lodash'\r\nimport { isEmpty } from 'src/utils/tools'\r\n\r\n/**\r\n * 编辑表单 form 校验域\r\n * @param config 配置项配置\r\n * @param data formBase 需要提交的数据\r\n * @returns \r\n */\r\nexport const verifyField = (config: any, data: any) => {\r\n  const { REQUIRED, FIELD_NAME } = config\r\n  const fieldValue = get(data, FIELD_NAME)\r\n  return REQUIRED && isEmpty(fieldValue)\r\n}\r\n\r\n/**\r\n * 编辑表单子表的导航属性获取\r\n * @param subPages 编辑表单子表\r\n * @returns \r\n */\r\nexport const getNavFields = (subPages: any[] = []) => {\r\n  const navFields: string[] = []\r\n  subPages.forEach((item: any) => {\r\n    const { NavFields, Nav_Columns = [] } = item\r\n    NavFields && navFields.push(NavFields)\r\n    Nav_Columns.forEach((col: any) => {\r\n      const { FIELD_NAME } = col\r\n      const fields = FIELD_NAME.split('.')\r\n      if (fields.length > 1) {\r\n        fields.splice(fields.length - 1, 1)\r\n        NavFields && fields.splice(0, 0, NavFields)\r\n        navFields.push(fields.join('.'))\r\n      }\r\n    })\r\n  })\r\n  return navFields\r\n}","import React, { useState, useEffect, useMemo, useCallback, useContext } from 'react'\r\nimport { Form, Row, Col } from 'antd'\r\nimport { ListTableContext, LoadableButton, LoadableControl } from 'src/components'\r\nimport { EditPageSubTable } from './components'\r\nimport { commonStore } from 'src/stores'\r\nimport { $api, $consts } from 'src/plugins'\r\nimport { initFilter, getSingleRule, extendRules, extendInclude } from 'src/utils/common'\r\nimport { verifyField, getNavFields } from 'src/components/root/helper'\r\nimport 'src/styles/components/root/editPage.less'\r\n\r\ntype EditProps = {\r\n  formCode: string,\r\n  formState: any,\r\n  record?: any\r\n}\r\n\r\nconst EditContext = React.createContext<any>(undefined)\r\nconst EditMain = (props: EditProps) => {\r\n  // 表单数据\r\n  const [formBase, setFormBase] = useState({})\r\n\r\n  // 表单校验\r\n  const [verify, setVerify] = useState({})\r\n  // 表单校验白名单\r\n  const [verifyWhiteList, setVerifyWhiteList] = useState<string[]>([])\r\n  const verifyFormBase = useCallback(() => {\r\n    const { Nav_PageEdit } = props.formState\r\n    const { Nav_Columns = [] } = Nav_PageEdit\r\n    const verify: any = {}\r\n    Nav_Columns.forEach((item: any) => {\r\n      if (verifyWhiteList.includes(item.FIELD_NAME)) return\r\n\r\n      verify[item.FIELD_NAME] = verifyField(item, formBase)\r\n    })\r\n    setVerify(verify)\r\n    return verify\r\n  }, [props.formState, formBase])\r\n\r\n  // 编辑表单详情\r\n  const table = useContext(ListTableContext)\r\n  const record = useMemo(() => {\r\n    return table?.selectedData[0] || props.record\r\n  }, [table, props.record])\r\n  useEffect(() => {\r\n    const { Nav_PageEdit, Nav_SubPageEdits = [] } = props.formState\r\n    const { Nav_PageEdit: deepConfig } = Nav_PageEdit\r\n    if (record?.ID && deepConfig?.QUERY_API_URL) {\r\n      const { ORG_ID: OrgId } = commonStore.userinfo\r\n      const payload = initFilter({ OrgId })\r\n      const singleRule = getSingleRule('ID', 1, record.ID)\r\n      extendRules(payload.FilterGroup, singleRule)\r\n      // 获取导航属性\r\n      const navFields = getNavFields(Nav_SubPageEdits)\r\n      navFields.length && extendInclude(payload, navFields)\r\n\r\n      $api['app/getDataByPost'](\r\n        payload,\r\n        { url: deepConfig.QUERY_API_URL }\r\n      ).then((res: any) => {\r\n        res && setFormBase(res)\r\n      })\r\n    }\r\n  }, [record, props.formState])\r\n\r\n  // 配置的头部按钮\r\n  const headerBtns = useMemo(() => {\r\n    const { Nav_PageEdit } = props.formState\r\n    const { Nav_Btns = [] } = Nav_PageEdit\r\n    if (!Nav_Btns.length) return null\r\n    return (\r\n      <div className='edit-page__header'>\r\n        {Nav_Btns.map((btn: any) => <LoadableButton key={btn.ID} pageType={$consts['TABLE/FORM_TYPE_EDIT_PAGE']} config={btn} />)}\r\n      </div>\r\n    )\r\n  }, [props.formState])\r\n\r\n  // 配置的动态加载的 js（表单配置了需要动态加载的 js 文件名，控件配置 js 文件中要执行的方法名）\r\n  const dynamicJs = useMemo(() => {\r\n    const { Nav_Form } = props.formState\r\n    const { JS_FILES } = Nav_Form\r\n    const funcs = $consts[`DYNAMICJS/${JS_FILES}`]\r\n    return funcs || {}\r\n  }, [props.formState])\r\n\r\n  // 配置字段对应的 Form.Item 项，根据对应配置的组件渲染\r\n  const formItems = useMemo(() => {\r\n    const { Nav_PageEdit } = props.formState\r\n    const { Nav_Columns = [] } = Nav_PageEdit\r\n    return Nav_Columns.map((item: any) => {\r\n      return (\r\n        <Col key={item.ID} span={6}>\r\n          <LoadableControl config={item} />\r\n        </Col>\r\n      )\r\n    })\r\n  }, [props.formState])\r\n\r\n  // context 向下传递\r\n  const contextValue = useMemo(() => {\r\n    return {\r\n      // 编辑表单字段基础信息\r\n      formBase,\r\n      setFormBase,\r\n      // 编辑表单字段检验信息\r\n      verify,\r\n      verifyFormBase,\r\n      // 编辑表单字段检验白名单\r\n      verifyWhiteList,\r\n      setVerifyWhiteList,\r\n      // 编辑表单配置\r\n      formState: props.formState,\r\n      // 表单动态加载 js\r\n      dynamicJs\r\n    }\r\n  }, [props.formState, formBase, verify, verifyWhiteList])\r\n\r\n  const { Nav_SubPageEdits = [] } = props.formState\r\n  return (\r\n    <EditContext.Provider value={contextValue}>\r\n      <div className='edit-page'>\r\n        {headerBtns}\r\n        <Form\r\n          layout='horizontal'\r\n          labelCol={{ span: 8 }}\r\n          wrapperCol={{ span: 16 }}\r\n        >\r\n          <Row gutter={16}>{formItems}</Row>\r\n        </Form>\r\n        <EditPageSubTable configs={Nav_SubPageEdits} />\r\n      </div>\r\n    </EditContext.Provider>\r\n  )\r\n}\r\n\r\ntype Props = {\r\n  formCode: string,\r\n  record?: any\r\n}\r\nconst EditPage = (props: Props) => {\r\n  const [formState, setFormState] = useState()\r\n\r\n  // 编辑表单配置\r\n  useEffect(() => {\r\n    const { ORG_ID: OrgId } = commonStore.userinfo\r\n    const payload = initFilter({ OrgId, Keyword: props.formCode })\r\n    $api['edit/getEditPageConfigInfo'](payload).then((res: any) => {\r\n      res && setFormState(res)\r\n    })\r\n  }, [props.formCode])\r\n\r\n\r\n  if (!formState) return null\r\n\r\n  return <EditMain formCode={props.formCode} formState={formState} record={props.record} />\r\n}\r\n\r\nexport { EditContext }\r\nexport default EditPage","import { useState, useEffect } from 'react'\r\nimport { LoadablePage } from 'src/components'\r\nimport { commonStore } from 'src/stores'\r\nimport { $api } from 'src/plugins'\r\nimport { initFilter } from 'src/utils/common'\r\n\r\ntype Props = {\r\n  formCode: string\r\n}\r\n\r\nconst CustomPage = (props: Props) => {\r\n  const [formState, setFormState] = useState()\r\n\r\n  useEffect(() => {\r\n    const { ORG_ID: OrgId } = commonStore.userinfo\r\n    const payload = initFilter({ OrgId, Keyword: props.formCode })\r\n    $api['app/getCustomPageConfigInfo'](payload).then((res: any) => {\r\n      res && setFormState(res)\r\n    })\r\n  }, [props.formCode])\r\n\r\n\r\n  if (!formState) return null\r\n\r\n  const { Nav_PageCustom = {} } = formState as any\r\n  return <LoadablePage name={Nav_PageCustom.COMPONENT_NAME} />\r\n}\r\n\r\nexport default CustomPage","import React, { useState, useContext } from 'react'\r\nimport { ModalContext } from 'src/components'\r\nimport { Form, Input, Button, Checkbox, Upload, message } from 'antd'\r\nimport axios from 'axios'\r\nimport { $api } from 'src/plugins'\r\nimport { getBaseURL } from 'src/utils/tools'\r\nimport { pick } from 'lodash'\r\n\r\ntype Props = {\r\n  controlId: string | number,\r\n  mesuringObjectId: string,\r\n  onSuccess: Function\r\n}\r\n\r\nconst actionApi = 'CFG/ControllerMonitor/ImportTargetDeviation'\r\n\r\nconst TargetOffset = (props: Props) => {\r\n  // 表单数据\r\n  const [formBase, setFormBase] = useState<any>({\r\n    Value: '', // 预设值\r\n    File: '', // 上传的文件\r\n    IsSaveController: false // 存入当前控制器\r\n  })\r\n\r\n  // 上传的文件\r\n  const handleUpload = (file: any) => {\r\n    setFormBase({ ...formBase, File: file })\r\n    return false\r\n  }\r\n\r\n  // form 表单验证状态\r\n  const [verify, setVerify] = useState<any>({})\r\n  const validateForm = () => {\r\n    !formBase.Value && !formBase.File ? (verify.required = 'error') : (verify.required = undefined)\r\n    setVerify({ ...verify })\r\n    return !formBase.Value && !formBase.File\r\n  }\r\n\r\n  // 弹框\r\n  const modal = useContext(ModalContext)\r\n  const handleOk = () => {\r\n    if (validateForm()) return\r\n\r\n    if (formBase.File) {\r\n      const file: any = new FormData()\r\n      file.append('File', formBase.File)\r\n      file.append('IsSaveController', formBase.IsSaveController)\r\n      file.append('ControllerId', props.controlId)\r\n      file.append('MesuringObjectId', props.mesuringObjectId)\r\n      axios({\r\n        url: `${getBaseURL(actionApi)}/${actionApi}`,\r\n        method: 'POST',\r\n        data: file\r\n      }).then((res: any) => {\r\n        if (res) {\r\n          message.success('操作成功')\r\n          props.onSuccess()\r\n          handleCancel()\r\n        }\r\n      })\r\n      return\r\n    }\r\n\r\n    $api['controlmonitor/setTargetDeviation']({\r\n      ControllerId: props.controlId,\r\n      MesuringObjectId: props.mesuringObjectId,\r\n      ...pick(formBase, ['Value', 'IsSaveController'])\r\n    }).then((res: any) => {\r\n      if (res) {\r\n        message.success('操作成功')\r\n        props.onSuccess()\r\n        handleCancel()\r\n      }\r\n    })\r\n  }\r\n  const handleCancel = () => {\r\n    modal.close()\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Form layout='horizontal' labelCol={{ span: 4 }} wrapperCol={{ span: 20 }}>\r\n        <Form.Item label='预设值' validateStatus={verify.required}>\r\n          <Input\r\n            disabled={formBase.File}\r\n            value={formBase.Value}\r\n            onChange={evt => setFormBase({ ...formBase, Value: evt.target.value })}\r\n            addonAfter='单位'\r\n          />\r\n        </Form.Item>\r\n        <Form.Item label='导入' validateStatus={verify.required}>\r\n          <div className='display-flex'>\r\n            <Input\r\n              readOnly\r\n              disabled={formBase.Value}\r\n              value={formBase.File?.name}\r\n              className='flex-1'\r\n            />\r\n            <Upload\r\n              showUploadList={false}\r\n              maxCount={1}\r\n              beforeUpload={handleUpload}\r\n              disabled={formBase.Value}\r\n            >\r\n              <Button type='primary' disabled={formBase.Value} style={{ marginLeft: 8 }}>选择</Button>\r\n            </Upload>\r\n            {\r\n              formBase.File\r\n                ? <Button type='primary' onClick={() => setFormBase({ ...formBase, File: '' })} className='mg-l4'>重置</Button>\r\n                : null\r\n            }\r\n          </div>\r\n        </Form.Item>\r\n        <Form.Item label=' ' colon={false}>\r\n          <Checkbox\r\n            checked={formBase.IsSaveController}\r\n            onChange={evt => setFormBase({ ...formBase, IsSaveController: evt.target.checked })}\r\n          />\r\n          <span className='pd-l8'>存入当前控制器</span>\r\n        </Form.Item>\r\n      </Form>\r\n      <div className='ant-modal-footer'>\r\n        <Button onClick={handleCancel}>取消</Button>\r\n        <Button type='primary' onClick={handleOk}>确定</Button>\r\n      </div>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\nexport default TargetOffset","import React, { useState, useContext } from 'react'\r\nimport { ModalContext } from 'src/components'\r\nimport { Form, Input, Button, Upload, message } from 'antd'\r\nimport axios from 'axios'\r\nimport { $api } from 'src/plugins'\r\nimport { getBaseURL } from 'src/utils/tools'\r\n\r\ntype Props = {\r\n  controlId: string | number,\r\n  actuatorId: string,\r\n  onSuccess: Function\r\n}\r\n\r\nconst actionApi = 'CFG/ControllerMonitor/ImportSPValue'\r\n\r\nconst SPValueImport = (props: Props) => {\r\n  // 表单数据\r\n  const [formBase, setFormBase] = useState<any>({\r\n    SPValue: '', // 预设值\r\n    file: '', // 上传的文件\r\n  })\r\n\r\n  // 上传的文件\r\n  const handleUpload = (file: any) => {\r\n    setFormBase({ ...formBase, file })\r\n    return false\r\n  }\r\n\r\n  // form 表单验证状态\r\n  const [verify, setVerify] = useState<any>({})\r\n  const validateForm = () => {\r\n    !formBase.SPValue && !formBase.file ? (verify.required = 'error') : (verify.required = undefined)\r\n    setVerify({ ...verify })\r\n    return !formBase.SPValue && !formBase.file\r\n  }\r\n\r\n  // 弹框\r\n  const modal = useContext(ModalContext)\r\n  const handleOk = () => {\r\n    if (validateForm()) return\r\n\r\n    if (formBase.file) {\r\n      const file: any = new FormData()\r\n      file.append('file', formBase.file)\r\n      file.append('ControllerId', props.controlId)\r\n      file.append('ActuatorId', props.actuatorId)\r\n      axios({\r\n        url: `${getBaseURL(actionApi)}/${actionApi}`,\r\n        method: 'POST',\r\n        data: file\r\n      }).then((res: any) => {\r\n        if (res) {\r\n          message.success('操作成功')\r\n          props.onSuccess()\r\n          handleCancel()\r\n        }\r\n      })\r\n      return\r\n    }\r\n\r\n    $api['controlmonitor/setSPValue']({\r\n      ControllerId: props.controlId,\r\n      ActuatorId: props.actuatorId,\r\n      SPValue: formBase.SPValue\r\n    }).then((res: any) => {\r\n      if (res) {\r\n        message.success('操作成功')\r\n        props.onSuccess()\r\n        handleCancel()\r\n      }\r\n    })\r\n  }\r\n  const handleCancel = () => {\r\n    modal.close()\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Form layout='horizontal' labelCol={{ span: 4 }} wrapperCol={{ span: 20 }}>\r\n        <Form.Item label='预设值' validateStatus={verify.required}>\r\n          <Input\r\n            disabled={formBase.file}\r\n            value={formBase.SPValue}\r\n            onChange={evt => setFormBase({ ...formBase, SPValue: evt.target.value })}\r\n            addonAfter='单位'\r\n          />\r\n        </Form.Item>\r\n        <Form.Item label='导入' validateStatus={verify.required}>\r\n          <div className='display-flex'>\r\n            <Input\r\n              readOnly\r\n              allowClear\r\n              disabled={formBase.SPValue}\r\n              value={formBase.file?.name}\r\n              className='flex-1'\r\n            />\r\n            <Upload\r\n              showUploadList={false}\r\n              maxCount={1}\r\n              beforeUpload={handleUpload}\r\n              disabled={formBase.SPValue}\r\n            >\r\n              <Button type='primary' disabled={formBase.SPValue} style={{ marginLeft: 8 }}>选择</Button>\r\n            </Upload>\r\n            {formBase.file ? <Button type='primary' onClick={() => setFormBase({ ...formBase, file: '' })} className='mg-l4'>重置</Button> : null}\r\n          </div>\r\n        </Form.Item>\r\n      </Form>\r\n      <div className='ant-modal-footer'>\r\n        <Button onClick={handleCancel}>取消</Button>\r\n        <Button type='primary' onClick={handleOk}>确定</Button>\r\n      </div>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\nexport default SPValueImport","import { useState, useEffect, useContext } from 'react'\r\nimport { Form, Button, Select, Input, InputNumber, Row, Col, Tabs, Switch, message } from 'antd'\r\nimport { InfoCircleOutlined } from '@ant-design/icons'\r\nimport { ModalContext, PaginationSelect, CountTime } from 'src/components'\r\nimport { commonStore } from 'src/stores'\r\nimport { $api } from 'src/plugins'\r\nimport { initFilter, getSingleRule, extendRules } from 'src/utils/common'\r\nimport { pick } from 'lodash'\r\n\r\nconst { TabPane } = Tabs\r\n\r\ntype Props = {\r\n  group: any,\r\n  controlDetail: any,\r\n  counter: number,\r\n  onGroupSwitch: Function,\r\n  onSuccess: Function\r\n}\r\n\r\nconst changeTimeOptions = [\r\n  { label: '秒', value: 'seconds' },\r\n  { label: '分', value: 'minutes' },\r\n  { label: '时', value: 'hours' }\r\n]\r\nconst ControlConfigSet = (props: Props) => {\r\n  // 组切换\r\n  const [isCustom, setIsCustom] = useState(false)\r\n\r\n  // 可切换组列表\r\n  const [groupList, setGroupList] = useState([])\r\n  useEffect(() => {\r\n    $api['controlmonitor/getOtherControllerGroups']().then((res: any) => {\r\n      if (res) {\r\n        setGroupList(res)\r\n        setTargetGroup(res[0].Id)\r\n      }\r\n    })\r\n  }, [])\r\n\r\n  // 手动组切换\r\n  const [targetGroup, setTargetGroup] = useState('')\r\n  const [targetTimes, setTargetTimes] = useState(60)\r\n  const [timeType, setTimeType] = useState('seconds')\r\n\r\n  const handleGroupSwitch = () => {\r\n    if (!targetTimes) return\r\n    // 如果自动组切换开启，则将其关闭\r\n    let leftTime = targetTimes\r\n    switch (timeType) {\r\n      case 'minutes':\r\n        leftTime = targetTimes * 60\r\n        break\r\n      case 'hours':\r\n        leftTime = targetTimes * 60 * 60\r\n        break\r\n    }\r\n    props.onGroupSwitch({\r\n      leftTime,\r\n      targetGroup,\r\n      targetTimes,\r\n      timeType\r\n    })\r\n    handleCancel()\r\n  }\r\n\r\n  // 表单数据\r\n  const [formBase, setFormBase] = useState({\r\n    AutoInitVarId: '', // 自动初始化源点 ID\r\n    DCSVarId: '', // DCS 源点 ID\r\n    DebugVarId: '' // 调试源点 ID\r\n  })\r\n  useEffect(() => {\r\n    setFormBase(pick(props.controlDetail, ['AutoInitVarId', 'DebugVarId', 'DCSVarId']))\r\n  }, [props.controlDetail])\r\n\r\n  // form 表单验证状态\r\n  const [verify, setVerify] = useState<any>({})\r\n  const validateForm = () => {\r\n    const { AutoInitVarId, DCSVarId, DebugVarId } = formBase\r\n    !AutoInitVarId ? (verify.AutoInitVarId = 'error') : (verify.AutoInitVarId = undefined)\r\n    !DCSVarId ? (verify.DCSVarId = 'error') : (verify.DCSVarId = undefined)\r\n    !DebugVarId ? (verify.DebugVarId = 'error') : (verify.DebugVarId = undefined)\r\n    setVerify({ ...verify })\r\n    return !AutoInitVarId || !DebugVarId || !DCSVarId\r\n  }\r\n\r\n  // 获取变量数据源分页列表\r\n  const getDataSource = (params: any, type: string) => {\r\n    const { current: PageIndex, search, initSearch } = params\r\n    const { ORG_ID: OrgId } = commonStore.userinfo\r\n    const payload = initFilter({ OrgId, PageIndex })\r\n    const singleRule = [getSingleRule('NAME', 9, search)]\r\n    !search && initSearch && singleRule.push(getSingleRule('ID', 1, initSearch))\r\n    extendRules(payload.FilterGroup, singleRule)\r\n\r\n    return $api['app/orderPagedTwo'](payload)\r\n  }\r\n  // 数据源选择\r\n  const handleSourceSelect = (val: string, type: string) => {\r\n    if (type === 'autoSource') {\r\n      setFormBase({ ...formBase, AutoInitVarId: val })\r\n    }\r\n    if (type === 'dcsSource') {\r\n      setFormBase({ ...formBase, DCSVarId: val })\r\n    }\r\n    if (type === 'debugSource') {\r\n      setFormBase({ ...formBase, DebugVarId: val })\r\n    }\r\n  }\r\n\r\n  // 弹框\r\n  const modal = useContext(ModalContext)\r\n  const handleOk = () => {\r\n    if (validateForm()) return\r\n\r\n    $api['controlmonitor/updateContorlSet']({\r\n      ControllerId: props.controlDetail.Id,\r\n      ...formBase\r\n    }).then((res: any) => {\r\n      if (res) {\r\n        message.success('操作成功')\r\n        props.onSuccess()\r\n        handleCancel()\r\n      }\r\n    })\r\n  }\r\n  const handleCancel = () => {\r\n    modal.close()\r\n  }\r\n\r\n  return (\r\n    <Tabs>\r\n      <TabPane key='group-switch' tab='组切换'>\r\n        <CountTime extraFont='组切换倒计时：' seconds={props.counter || 0} className='display-block mg-b12' />\r\n        <Form layout='horizontal'>\r\n          <Form.Item label='当前组切换策略'>\r\n            <span style={{ color: props.group?.IsAutoChangeGroup ? '#73d13d' : '#bfbfbf' }}>{props.group?.IsAutoChangeGroup ? '已开启自动组切换' : '未开启自动组切换'}</span>\r\n          </Form.Item>\r\n          <Form.Item label='手动组切换'>\r\n            <Switch checked={isCustom} onChange={setIsCustom} />\r\n            {\r\n              props.group?.IsAutoChangeGroup && isCustom\r\n                ? (\r\n                  <span style={{ color: '#ff7875' }} className='vertical-middle pd-l16'>\r\n                    <InfoCircleOutlined className='mg-r4' />\r\n                    <span>手动组切换开启后，将关闭自动组切换</span>\r\n                  </span>\r\n                )\r\n                : null\r\n            }\r\n          </Form.Item>\r\n        </Form>\r\n        {\r\n          isCustom\r\n            ? (\r\n              <Form layout='vertical' className='mg-t8'>\r\n                <Row gutter={8}>\r\n                  <Col span={8}>\r\n                    <Form.Item label='当前组'>\r\n                      <Input disabled value={props.group?.GroupName} />\r\n                    </Form.Item>\r\n                  </Col>\r\n                  <Col span={8}>\r\n                    <Form.Item label='目标组'>\r\n                      <Select\r\n                        fieldNames={{ label: 'Name', value: 'Id' }}\r\n                        options={groupList}\r\n                        value={targetGroup}\r\n                        onChange={setTargetGroup}\r\n                      />\r\n                    </Form.Item>\r\n                  </Col>\r\n                  <Col span={8}>\r\n                    <Form.Item label='切换时间' validateStatus={!targetTimes ? 'error' : undefined}>\r\n                      <Row gutter={8}>\r\n                        <Col span={16}>\r\n                          <InputNumber min={1} value={targetTimes} onChange={setTargetTimes} style={{ width: '100%' }} />\r\n                        </Col>\r\n                        <Col span={8}>\r\n                          <Select options={changeTimeOptions} value={timeType} onChange={setTimeType} />\r\n                        </Col>\r\n                      </Row>\r\n                    </Form.Item>\r\n                  </Col>\r\n                </Row>\r\n              </Form>\r\n            )\r\n            : null\r\n        }\r\n        {\r\n          isCustom\r\n            ? (\r\n              <div className='ant-modal-footer mg-t8'>\r\n                <Button onClick={handleCancel}>取消</Button>\r\n                <Button type='primary' onClick={handleGroupSwitch}>确定</Button>\r\n              </div>\r\n            )\r\n            : null\r\n        }\r\n      </TabPane>\r\n      <TabPane key='func-config' tab='功能配置'>\r\n        <Form layout='vertical'>\r\n          <Row gutter={8}>\r\n            <Col span={12}>\r\n              <Form.Item\r\n                required\r\n                validateStatus={verify.AutoInitVarId}\r\n                label='自动初始化点'\r\n              >\r\n                <PaginationSelect\r\n                  value={formBase.AutoInitVarId}\r\n                  remoteMethod={(params: any) => getDataSource(params, 'autoSource')}\r\n                  onChange={(data: any) => handleSourceSelect(data, 'autoSource')}\r\n                  selectProps={{\r\n                    allowClear: true\r\n                  }}\r\n                />\r\n              </Form.Item>\r\n            </Col>\r\n            <Col span={12}>\r\n              <Form.Item\r\n                required\r\n                validateStatus={verify.DCSVarId}\r\n                label='DCS控制点'\r\n              >\r\n                <PaginationSelect\r\n                  value={formBase.DCSVarId}\r\n                  remoteMethod={(params: any) => getDataSource(params, 'dcsSource')}\r\n                  onChange={(data: any) => handleSourceSelect(data, 'dcsSource')}\r\n                  selectProps={{\r\n                    allowClear: true\r\n                  }}\r\n                />\r\n              </Form.Item>\r\n            </Col>\r\n            <Col span={12}>\r\n              <Form.Item\r\n                required\r\n                validateStatus={verify.DebugVarId}\r\n                label='调试'\r\n              >\r\n                <PaginationSelect\r\n                  value={formBase.DebugVarId}\r\n                  remoteMethod={(params: any) => getDataSource(params, 'debugSource')}\r\n                  onChange={(data: any) => handleSourceSelect(data, 'debugSource')}\r\n                  selectProps={{\r\n                    allowClear: true\r\n                  }}\r\n                />\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n        </Form>\r\n        <div className='ant-modal-footer'>\r\n          <Button onClick={handleCancel}>取消</Button>\r\n          <Button type='primary' onClick={handleOk}>确定</Button>\r\n        </div>\r\n      </TabPane>\r\n    </Tabs>\r\n  )\r\n}\r\n\r\nexport default ControlConfigSet","import React, { useState, useEffect, useMemo, useRef } from 'react'\r\nimport { autorun } from 'mobx'\r\nimport { Form, Select, InputNumber, Tabs, Button, Modal, message } from 'antd'\r\nimport { CameraOutlined } from '@ant-design/icons'\r\nimport { EnergyIcon, CollpaseZone } from 'src/components'\r\nimport { CDChartShow } from './'\r\nimport { noticeStore } from 'src/stores'\r\nimport { $api, $consts } from 'src/plugins'\r\nimport { uuid } from 'src/utils/tools'\r\nimport { cloneDeep } from 'lodash'\r\n\r\nconst { TabPane } = Tabs\r\n\r\ntype Props = {\r\n  onSuccess: Function\r\n}\r\nconst ControlLoopSet = (props: Props) => {\r\n  // 弹框\r\n  const [visible, setVisible] = useState(false)\r\n\r\n  // 控制器\r\n  const messageId = useRef<string>('')\r\n  const [controllerId, setControllerId] = useState<string>()\r\n  useEffect(() => {\r\n    const dispose = autorun(() => {\r\n      const { Id = '', RelateId, TypeCode } = noticeStore.activeNotice || {}\r\n      if (TypeCode === $consts['SOCKET/LOOP_LIST']) {\r\n        messageId.current = Id\r\n        setControllerId(RelateId)\r\n        setVisible(true)\r\n      }\r\n    })\r\n    return dispose\r\n  }, [])\r\n\r\n  // 所有执行器\r\n  const [mvList, setMVList] = useState<any>([])\r\n  useEffect(() => {\r\n    if (controllerId) {\r\n      $api['controlmonitor/getActuatorByWrite']({\r\n        ControllerId: controllerId\r\n      }).then((res: any) => {\r\n        res && setMVList(res)\r\n      })\r\n    }\r\n  }, [controllerId])\r\n\r\n  // 测量对象与执行器过滤\r\n  const [filter, setFilter] = useState({ MeasuringObjectId: '', ActuatorId: '' })\r\n  useEffect(() => {\r\n    const initFilter = { MeasuringObjectId: '', ActuatorId: '' }\r\n    mvList[0]?.Id && (initFilter.ActuatorId = mvList[0].Id)\r\n    mvList[0]?.CVList && mvList[0]?.CVList[0]?.Id && (initFilter.MeasuringObjectId = mvList[0].CVList[0].Id)\r\n    setFilter(initFilter)\r\n  }, [mvList])\r\n\r\n  const missFilterId = (show?: boolean): boolean => {\r\n    const { MeasuringObjectId, ActuatorId } = filter\r\n    !MeasuringObjectId && show && message.error('请选择测量对象')\r\n    !ActuatorId && show && message.error('请选择执行器')\r\n    return !MeasuringObjectId || !ActuatorId\r\n  }\r\n\r\n  const cvList = useMemo(() => {\r\n    const find: any = mvList.find((item: any) => item.Id === filter.ActuatorId)\r\n    return find?.CVList || []\r\n  }, [mvList, filter])\r\n\r\n  // 控制器位号数据\r\n  const [uniqueKey, setUniqueKey] = useState(uuid())\r\n  const [posData, setPosData] = useState<any>({ MeasuringObject: {}, Actuator: {} })\r\n  const getPosData = () => {\r\n    if (missFilterId()) return\r\n\r\n    $api['controlmonitor/getPositionData']({\r\n      ControllerId: controllerId,\r\n      ...filter\r\n    }).then((res: any) => {\r\n      if (res) {\r\n        setPosData(res)\r\n        setUniqueKey(uuid())\r\n      }\r\n    })\r\n  }\r\n  useEffect(() => {\r\n    getPosData()\r\n  }, [controllerId, filter])\r\n\r\n  // Slider 对应图表数据\r\n  const [slider, setSlider] = useState(0)\r\n  const [matchActChart, setMatchChartData] = useState<any>()\r\n  const matchMeasureChart = useMemo(() => {\r\n    const { PositionNumbers = [] } = posData.MeasuringObject\r\n    return PositionNumbers.find((item: any) => item.PositionNumber === matchActChart?.AlignPositionNumber)\r\n  }, [posData, matchActChart])\r\n\r\n  // options 展开收起\r\n  const [optionShow, setOptionShow] = useState(false)\r\n\r\n  // 测量对象快照\r\n  const handleMeasureSnapshot = () => {\r\n    if (missFilterId(true)) return\r\n\r\n    $api['controlmonitor/saveMeasuringObjectSnapshot']({\r\n      Id: filter.MeasuringObjectId\r\n    }).then((res: any) => {\r\n      if (res) {\r\n        message.success('操作成功')\r\n        getPosData()\r\n      }\r\n    })\r\n  }\r\n\r\n  // 手动设定 SP\r\n  const handleSetWriteSP = (val: number) => {\r\n    const copyActuator = cloneDeep(posData.Actuator)\r\n    const { PositionNumbers = [] } = copyActuator\r\n    const find: any = PositionNumbers.find((item: any) => item.PositionNumber === slider)\r\n    if (find) {\r\n      find.WriteSP = val\r\n      setPosData({ ...posData, Actuator: copyActuator })\r\n    }\r\n  }\r\n\r\n  // 关闭当前 Tab\r\n  const disposeCurrTab = () => {\r\n    if (mvList.length <= 1) {\r\n      setVisible(false)\r\n      return\r\n    }\r\n    setMVList(mvList.filter((item: any) => item.Id !== filter.ActuatorId))\r\n  }\r\n\r\n  // 恢复当前位号\r\n  const handleResetCurr = () => {\r\n    const copyActuator = cloneDeep(posData.Actuator)\r\n    const { PositionNumbers = [] } = copyActuator\r\n    const find: any = PositionNumbers.find((item: any) => item.PositionNumber === slider)\r\n    if (find) {\r\n      find.WriteSP = find.AlgorithmicSP\r\n      setPosData({ ...posData, Actuator: copyActuator })\r\n    }\r\n  }\r\n\r\n  // 恢复所有位号\r\n  const handleResetAll = () => {\r\n    const copyActuator = cloneDeep(posData.Actuator)\r\n    const { PositionNumbers = [] } = copyActuator\r\n    PositionNumbers.forEach((item: any) => {\r\n      item.WriteSP = item.AlgorithmicSP\r\n    })\r\n    setPosData({ ...posData, Actuator: copyActuator })\r\n  }\r\n\r\n  // 写入\r\n  const handleWriteSP = () => {\r\n    const { PositionNumbers = [] } = posData.Actuator\r\n\r\n    $api['controlmonitor/writeSemiClosedLoopData']({\r\n      ControllerId: controllerId,\r\n      ActuatorData: [\r\n        {\r\n          ActuatorId: filter.ActuatorId,\r\n          PositionNumbers: PositionNumbers.map((item: any) => ({ PositionNumber: item.PositionNumber, SPValue: item.WriteSP }))\r\n        }\r\n      ]\r\n    }).then((res: any) => {\r\n      if (res) {\r\n        message.success('操作成功')\r\n        props.onSuccess($consts['SOCKET/LOOP_READ'], messageId.current, true)\r\n        disposeCurrTab()\r\n      }\r\n    })\r\n  }\r\n\r\n  // 放弃\r\n  const handleDropSP = () => {\r\n    $api['controlmonitor/giveUpSemiClosedLoopData']({\r\n      ControllerId: controllerId,\r\n      ...filter\r\n    }).then((res: any) => {\r\n      if (res) {\r\n        message.success('操作成功')\r\n        props.onSuccess($consts['SOCKET/LOOP_READ'], messageId.current, true)\r\n        disposeCurrTab()\r\n      }\r\n    })\r\n  }\r\n\r\n  // 测量对象图表 series 数据\r\n  const measureSeries = [\r\n    {\r\n      field: 'PVValue',\r\n      chartOption: {\r\n        lineOption: {\r\n          name: '当前值',\r\n        }\r\n      },\r\n    },\r\n    {\r\n      field: 'SnapPVValue',\r\n      chartOption: {\r\n        lineOption: {\r\n          name: '快照值',\r\n        }\r\n      },\r\n    }\r\n  ]\r\n\r\n  // 测量对象图表配置\r\n  const measureChart = useMemo(() => {\r\n    const { PositionNumbers = [] } = posData.MeasuringObject\r\n    const PVValues = PositionNumbers.map((item: any) => item.PVValue).filter((item: number) => item)\r\n    const max = Math.max(...PVValues)\r\n    const min = Math.min(...PVValues)\r\n    return {\r\n      title: { top: 40 },\r\n      grid: { top: 60 },\r\n      xAxis: { axisLabel: { showMinLabel: true, showMaxLabel: true } },\r\n      dataZoom: [\r\n        {\r\n          type: 'slider',\r\n          right: 10,\r\n          width: 18,\r\n          yAxisIndex: 0,\r\n          filterMode: 'none',\r\n          startValue: min || 0,\r\n          endValue: max || undefined\r\n        },\r\n        {\r\n          type: 'inside',\r\n          yAxisIndex: 0,\r\n          filterMode: 'none'\r\n        }\r\n      ]\r\n    }\r\n  }, [posData.MeasuringObject])\r\n\r\n  // 执行器图表 series 数据\r\n  const actSeries = useMemo(() => {\r\n    const { PositionNumbers = [] } = posData.Actuator\r\n    const barMaxWidth = 13 - Math.floor(PositionNumbers.length / 50) * 2\r\n    return [\r\n      {\r\n        field: 'SPValue',\r\n        zeroToUndefined: true, // 0 值不画\r\n        chartOption: {\r\n          legend: { data: [{ icon: 'circle' }] },\r\n          lineOption: {\r\n            name: '当前SP',\r\n            symbol: 'circle',\r\n            symbolSize: 6,\r\n            lineStyle: { opacity: 0 },\r\n            areaStyle: { color: 'rgba(0,0,0,0)' }\r\n          }\r\n        }\r\n      },\r\n      {\r\n        field: 'PVValue',\r\n        zeroToUndefined: true, // 0 值不画\r\n        chartOption: {\r\n          legend: { data: [{ icon: 'circle' }] },\r\n          lineOption: {\r\n            name: '当前PV',\r\n            symbol: 'circle',\r\n            symbolSize: 6,\r\n            lineStyle: { opacity: 0 },\r\n            areaStyle: { color: 'rgba(0,0,0,0)' }\r\n          },\r\n        }\r\n      },\r\n      {\r\n        field: 'WriteSP',\r\n        chartOption: {\r\n          barOption: {\r\n            name: '新SP值',\r\n            barMaxWidth\r\n          }\r\n        }\r\n      }\r\n    ]\r\n  }, [posData.Actuator])\r\n\r\n  // 执行器图表配置\r\n  const actChart = useMemo(() => {\r\n    const { PositionNumbers = [] } = posData.Actuator\r\n    const maxInterval = Math.ceil(PositionNumbers.length / 50)\r\n    return {\r\n      title: { show: false },\r\n      legend: { itemWidth: 24, itemHeight: 12 },\r\n      xAxis: { maxInterval, axisTick: { show: false } }\r\n    }\r\n  }, [posData.Actuator])\r\n\r\n  return (\r\n    <Modal\r\n      destroyOnClose\r\n      width='98%'\r\n      title='请处理'\r\n      footer={null}\r\n      visible={visible}\r\n      onCancel={() => setVisible(false)}\r\n    >\r\n      <Tabs type='card' onChange={val => setFilter({ ...filter, ActuatorId: val })}>\r\n        {mvList.map((pane: any, index: number) => <TabPane tab={pane.Name} key={`${pane.Id}_${index}`} />)}\r\n      </Tabs>\r\n      <div className='control-monitor loop-set'>\r\n        <Select\r\n          fieldNames={{ label: 'Name', value: 'Id' }}\r\n          options={cvList}\r\n          value={filter.MeasuringObjectId}\r\n          onChange={(val: any) => setFilter({ ...filter, MeasuringObjectId: val })}\r\n          className='control-monitor__select'\r\n        />\r\n        {/** CD 测量对象图表 */}\r\n        <CollpaseZone\r\n          collapse={\r\n            <React.Fragment>\r\n              <Form layout='horizontal' labelCol={{ span: 10 }} wrapperCol={{ span: 14 }}>\r\n                <Form.Item label='对齐位号'>\r\n                  <InputNumber\r\n                    disabled\r\n                    value={matchActChart?.AlignPositionNumber}\r\n                    className='control-monitor__form-input'\r\n                  />\r\n                </Form.Item>\r\n                <Form.Item label='目标'>\r\n                  <InputNumber\r\n                    disabled\r\n                    value={matchMeasureChart?.SPValue}\r\n                    className='control-monitor__form-input'\r\n                  />\r\n                </Form.Item>\r\n                <Form.Item label='当前值'>\r\n                  <InputNumber\r\n                    disabled\r\n                    value={matchMeasureChart?.PVValue}\r\n                    className='control-monitor__form-input'\r\n                  />\r\n                </Form.Item>\r\n                <Form.Item label='坐标上界'>\r\n                  <InputNumber\r\n                    disabled\r\n                    value={posData.MeasuringObject.CoordinateMax}\r\n                    className='control-monitor__form-input'\r\n                  />\r\n                </Form.Item>\r\n                <Form.Item label='坐标下界'>\r\n                  <InputNumber\r\n                    disabled\r\n                    value={posData.MeasuringObject.CoordinateMin}\r\n                    className='control-monitor__form-input'\r\n                  />\r\n                </Form.Item>\r\n                <Form.Item label='2σ'>\r\n                  <InputNumber\r\n                    disabled\r\n                    value={matchMeasureChart?.TwoSigma}\r\n                    className='control-monitor__form-input'\r\n                  />\r\n                </Form.Item>\r\n              </Form>\r\n              <div className='mg-t20 pd-l16 pd-r10 text-center'>\r\n                <Button block type='primary' icon={<CameraOutlined />} onClick={handleMeasureSnapshot}>快照</Button>\r\n              </div>\r\n            </React.Fragment>\r\n          }\r\n          onChange={setOptionShow}\r\n          zoneRightClass='pd-t12'\r\n        >\r\n          <CDChartShow\r\n            timeVisible\r\n            slider={matchActChart?.AlignPositionNumber}\r\n            sliderVisible={false}\r\n            chartData={posData.MeasuringObject}\r\n            chartOption={measureChart}\r\n            chartHeight={298}\r\n            seriesData={measureSeries}\r\n          />\r\n        </CollpaseZone>\r\n        {/** CD 执行器对齐图表 */}\r\n        <CollpaseZone\r\n          showHandler={false}\r\n          visible={optionShow}\r\n          collapse={\r\n            <Form layout='horizontal' labelCol={{ span: 10 }} wrapperCol={{ span: 14 }}>\r\n              <Form.Item label='位号'>\r\n                <InputNumber\r\n                  value={slider}\r\n                  onChange={setSlider}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='对齐测量值'>\r\n                <InputNumber\r\n                  disabled\r\n                  value={matchActChart?.AlignValue}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='算法输出SP'>\r\n                <InputNumber\r\n                  disabled\r\n                  value={matchActChart?.AlgorithmicSP}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='回写输出SP'>\r\n                <InputNumber\r\n                  value={matchActChart?.WriteSP}\r\n                  onChange={handleSetWriteSP}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='当前SP'>\r\n                <InputNumber\r\n                  disabled\r\n                  value={matchActChart?.SPValue}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='当前PV'>\r\n                <InputNumber\r\n                  disabled\r\n                  value={matchActChart?.PVValue}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='坐标上界'>\r\n                <InputNumber\r\n                  disabled\r\n                  value={posData.Actuator.CoordinateMax}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='坐标下界'>\r\n                <InputNumber\r\n                  disabled\r\n                  value={posData.Actuator.CoordinateMin}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n            </Form>\r\n          }\r\n        >\r\n          <CDChartShow\r\n            key={uniqueKey}\r\n            slider={slider}\r\n            chartData={posData.Actuator}\r\n            alignChartData={posData.MeasuringObject}\r\n            chartOption={actChart}\r\n            chartHeight={320}\r\n            seriesData={actSeries}\r\n            onChange={setSlider}\r\n            onChartChange={setMatchChartData}\r\n          />\r\n        </CollpaseZone>\r\n        {/** 操作按钮 */}\r\n        <div className='pd-t12 text-right border-top'>\r\n          <Button onClick={handleResetCurr} type='primary' icon={<EnergyIcon type='icon-shujuhuifu' className='pd-r8' />} className='mg-l12'>恢复当前位号</Button>\r\n          <Button onClick={handleResetAll} type='primary' icon={<EnergyIcon type='icon-shujuhuifu' className='pd-r8' />} className='mg-l12'>恢复全部</Button>\r\n          <Button onClick={handleWriteSP} type='primary' icon={<EnergyIcon type='icon-xieru' className='pd-r8' />} className='mg-l12'>写入</Button>\r\n          <Button onClick={handleDropSP} type='primary' icon={<EnergyIcon type='icon-fangqiruzhi' className='pd-r8' />} className='mg-l12'>放弃</Button>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  )\r\n}\r\n\r\nexport default ControlLoopSet","import { useState, useEffect } from 'react'\r\nimport ReactEcharts from 'echarts-for-react'\r\nimport { cloneDeep } from 'lodash'\r\n\r\ntype BarOption = {\r\n  // echarts 配置\r\n  name: string,\r\n  itemStyle: any\r\n}\r\n\r\ntype LineOption = {\r\n  // echarts 配置\r\n  name: string,\r\n  lineStyle: any,\r\n  itemStyle: any,\r\n  areaStyle: any\r\n}\r\n\r\ntype ChartOption = {\r\n  // echarts 配置\r\n  title: any,\r\n  legend: any,\r\n  grid: any,\r\n  tooltip: any,\r\n  xAxis: any,\r\n  yAxis: any,\r\n  // 自定义配置\r\n  lineOption: LineOption,\r\n  barOption: BarOption\r\n}\r\n\r\ntype SeriesData = {\r\n  // 自定义配置\r\n  field: string,\r\n  data: any[],\r\n  checkLoop?: boolean,\r\n  chartOption?: ChartOption\r\n}\r\n\r\nconst barMaxWidth = 13\r\nconst presetColors = [\r\n  '133, 84, 158',\r\n  '0, 183, 238',\r\n  '50, 177, 108',\r\n  '250, 140, 22',\r\n  '255, 77, 79',\r\n  '255, 236, 61',\r\n  '8, 151, 156',\r\n  '158, 16, 104',\r\n  '255, 251, 230',\r\n  '120, 6, 80'\r\n]\r\nconst seriesOption = (chart: SeriesData, index: number) => {\r\n  const { data, chartOption = {} } = chart\r\n  const { lineOption, barOption } = chartOption as ChartOption\r\n\r\n  const itemColor = presetColors[index % presetColors.length]\r\n\r\n  if (lineOption) {\r\n    return {\r\n      symbol: 'none',\r\n      ...lineOption,\r\n      type: 'line',\r\n      lineStyle: {\r\n        color: `rgba(${itemColor}, 1)`,\r\n        ...lineOption?.lineStyle\r\n      },\r\n      itemStyle: {\r\n        color: `rgba(${itemColor}, 1)`,\r\n        ...lineOption?.itemStyle\r\n      },\r\n      areaStyle: {\r\n        color: {\r\n          type: 'linear',\r\n          x: 0,\r\n          y: 0,\r\n          x2: 0,\r\n          y2: 1,\r\n          colorStops: [\r\n            {\r\n              offset: 0,\r\n              color: `rgba(${itemColor}, 0.6)`\r\n            },\r\n            {\r\n              offset: 1,\r\n              color: `rgba(${itemColor}, 0.05)`\r\n            }\r\n          ]\r\n        },\r\n        ...lineOption?.areaStyle\r\n      },\r\n      data\r\n    }\r\n  }\r\n\r\n  if (barOption) {\r\n    return {\r\n      barWidth: barMaxWidth,\r\n      ...barOption,\r\n      type: 'bar',\r\n      itemStyle: {\r\n        color: `rgba(${itemColor}, 1)`,\r\n        ...barOption?.itemStyle\r\n      },\r\n      data\r\n    }\r\n  }\r\n\r\n  return { data }\r\n}\r\n\r\ntype Props = {\r\n  chartData: any,\r\n  alignChartData?: any,\r\n  chartOption?: ChartOption,\r\n  seriesData: SeriesData[],\r\n  position?: number\r\n}\r\n\r\nconst CDChart = (props: Props) => {\r\n  const [option, setOption] = useState<any>()\r\n  useEffect(() => {\r\n    // 定时器保证图表是在最后更新的，以提高界面显示性能\r\n    let timer = setTimeout(() => {\r\n      const { chartData, alignChartData = {}, chartOption, seriesData, position } = props\r\n      const { PositionNumbers: initPoints = [], Name: name, Unit: title = 'gsm', CoordinateMax = 0, CoordinateMin = 0 } = chartData\r\n      const { PositionNumbers: alignPoints = [] } = alignChartData\r\n\r\n      // 是否根据对齐数据画图\r\n      const targetAlign = alignPoints.length\r\n\r\n      // 标记线\r\n      const markLines: any = {\r\n        name: 'markLines',\r\n        type: 'line',\r\n        markLine: {\r\n          symbol: 'none',\r\n          silent: true,\r\n          animation: false,\r\n          label: {\r\n            position: 'insideEndTop',\r\n            formatter: '{b}: {c}'\r\n          },\r\n          lineStyle: {\r\n            type: 'solid',\r\n            color: '#bcbcbc'\r\n          },\r\n          data: []\r\n        }\r\n      }\r\n      // 位号标记线\r\n      position !== undefined && markLines.markLine.data.push({\r\n        name: '位号',\r\n        xAxis: position,\r\n        label: { formatter: '' }\r\n      })\r\n      // 上界标记线\r\n      CoordinateMax && markLines.markLine.data.push({\r\n        name: '上界',\r\n        yAxis: CoordinateMax\r\n      })\r\n      // 下界标记线\r\n      CoordinateMin && markLines.markLine.data.push({\r\n        name: '下界',\r\n        yAxis: CoordinateMin\r\n      })\r\n\r\n      // 根据 seriesData 筛选出需要展示的数据\r\n      const copyData = cloneDeep(seriesData)\r\n      const points = targetAlign ? alignPoints : initPoints\r\n      points.forEach((item: any, index: number) => {\r\n        const matchItem = targetAlign ? (initPoints.find((init: any) => init.AlignPositionNumber === item.PositionNumber) || {}) : item\r\n        copyData.forEach((chart: any) => {\r\n          // PositionNumbers 里面有的字段才显示在图表上\r\n          !chart.data && (chart.data = [])\r\n          if (matchItem[chart.field] !== undefined) {\r\n            if (chart.checkLoop && matchItem.IsCloseLoop !== undefined) {\r\n              chart.data[index] = {\r\n                value: [item.PositionNumber, matchItem[chart.field]],\r\n                itemStyle: { color: matchItem.IsCloseLoop ? '#ffc355' : '#5bb86d' }\r\n              }\r\n            } else {\r\n              chart.data[index] = {\r\n                value: [item.PositionNumber, matchItem[chart.field]]\r\n              }\r\n            }\r\n          } else {\r\n            // 因为存在对齐表，所以有些 alignPoints 是对不上 initPoints，这些对不上的就不画或画0\r\n            if (!chart.notFillEmpty && !chart.data[index]) {\r\n              chart.data[index] = { value: [item.PositionNumber, chart.zeroToUndefined ? undefined : 0] }\r\n            }\r\n          }\r\n        })\r\n      })\r\n      const chartsData = copyData.filter((item: any) => item.data?.length)\r\n\r\n      // 计算 XMin XMax 的值\r\n      const xMin = points[0]?.PositionNumber\r\n      const xMax = points[points.length - 1]?.PositionNumber\r\n      // 计算 YMax 的值\r\n      const yVals: any = []\r\n      chartsData.forEach((item: any) => yVals.push(...item.data.map((i: any) => i.value[1])))\r\n      const yAxisMax = Math.ceil(Math.max(CoordinateMax, ...yVals.filter((item: any) => item !== undefined)) * 1.15)\r\n\r\n      // xAxis interval 值（对齐时，要根据对齐的数据画 X 轴的 label）\r\n      const interval = chartOption?.xAxis?.maxInterval || 10\r\n\r\n      setOption({\r\n        ...chartOption,\r\n        title: {\r\n          top: 0,\r\n          left: 60,\r\n          text: title,\r\n          ...chartOption?.title,\r\n          // 注意 chartOption 的展开位置，后面的属性不允许被 chartOption 完全覆盖\r\n          textStyle: {\r\n            fontSize: 12,\r\n            fontWeight: 'normal',\r\n            color: '#aaa',\r\n            ...chartOption?.title?.textStyle\r\n          },\r\n        },\r\n        legend: {\r\n          top: 0,\r\n          ...chartOption?.legend,\r\n          // 注意 chartOption 的展开位置，后面的属性不允许被 chartOption 完全覆盖\r\n          data: chartsData.map((series: SeriesData) => {\r\n            const { chartOption = {} } = series\r\n            const { legend = {}, lineOption = {}, barOption = {} } = chartOption as ChartOption\r\n            const { name: lineName } = lineOption as LineOption\r\n            const { name: barName } = barOption as LineOption\r\n            const { data = [] } = legend\r\n            return {\r\n              name: lineName || barName,\r\n              ...data[0]\r\n            }\r\n          }),\r\n        },\r\n        grid: {\r\n          top: 20,\r\n          right: 30,\r\n          bottom: 20,\r\n          left: 60,\r\n          containLabel: false,\r\n          ...chartOption?.grid\r\n        },\r\n        tooltip: {\r\n          /**\r\n           * axis 表示 tooltip 根据 xAxis 进行触发，这样鼠标只要在图上，就会自动匹配到 X 轴数据，并显示对应的 Y 轴数据\r\n           * item 表示 tooltip 只会根据选中的项进行触发，如果鼠标不在选中项上，则 tooltip 不会触发\r\n           */\r\n          trigger: !targetAlign ? 'axis' : 'item',\r\n          borderColor: 'rgba(0,0,0,0)',\r\n          ...chartOption?.tooltip,\r\n          // 注意 chartOption 的展开位置，后面的属性不允许被 chartOption 完全覆盖\r\n          formatter: !targetAlign ? '' : (params: any) => {\r\n            const { seriesName, marker, value } = params\r\n            const find = initPoints.find((item: any) => item.AlignPositionNumber === value[0])\r\n            return (`\r\n              <div>\r\n                <p>${find ? find.PositionNumber : ''}</p>\r\n                <span>${marker}${seriesName} ${value[1]}</span>\r\n              </div>\r\n            `)\r\n          },\r\n        },\r\n        xAxis: {\r\n          min: xMin || null,\r\n          max: xMax || null,\r\n          ...chartOption?.xAxis,\r\n          // 注意 chartOption 的展开位置，后面的属性不允许被 chartOption 完全覆盖\r\n          maxInterval: !targetAlign ? interval : 1,\r\n          type: 'value',\r\n          axisLine: {\r\n            lineStyle: {\r\n              color: '#BFBFBF'\r\n            }\r\n          },\r\n          axisTick: {\r\n            alignWithLabel: true,\r\n            ...chartOption?.xAxis?.axisTick\r\n          },\r\n          axisLabel: {\r\n            color: '#BFBFBF',\r\n            fontSize: 11,\r\n            ...chartOption?.xAxis?.axisLabel,\r\n            formatter: !targetAlign ? '{value}' : (val: number) => {\r\n              const findIndex = initPoints.findIndex((item: any) => item.AlignPositionNumber === val)\r\n              const find = initPoints[findIndex]\r\n              // findIndex === 0: showMinLabel; findIndex === initPoints.length - 1: showMaxLabel\r\n              const matchInterval = findIndex % interval === 0 || findIndex === 0 || findIndex === initPoints.length - 1\r\n              return matchInterval ? find?.PositionNumber : undefined\r\n            }\r\n          },\r\n          splitLine: {\r\n            show: false\r\n          }\r\n        },\r\n        yAxis: {\r\n          type: 'value',\r\n          name,\r\n          nameLocation: 'center',\r\n          nameGap: 40,\r\n          min: null,\r\n          max: yAxisMax,\r\n          offset: barMaxWidth,\r\n          ...chartOption?.yAxis,\r\n          // 注意 chartOption 的展开位置，后面的属性不允许被 chartOption 完全覆盖\r\n          nameTextStyle: {\r\n            color: '#000000'\r\n          },\r\n          splitLine: {\r\n            show: false\r\n          },\r\n          axisLine: {\r\n            show: true,\r\n            lineStyle: {\r\n              color: '#BFBFBF'\r\n            }\r\n          },\r\n          axisTick: {\r\n            show: true,\r\n            lineStyle: {\r\n              color: '#C5C5C5'\r\n            }\r\n          },\r\n          axisLabel: {\r\n            color: '#7B7B7B',\r\n            fontSize: 11\r\n          },\r\n        },\r\n        series: [markLines].concat(chartsData.map((series: SeriesData, index: number) => seriesOption(series, index)))\r\n      })\r\n    }, 300)\r\n    return () => clearTimeout(timer)\r\n  }, [props.chartData, props.alignChartData, props.chartOption, props.position])\r\n\r\n  if (!option) return null\r\n\r\n  return (\r\n    <ReactEcharts\r\n      lazyUpdate\r\n      option={option}\r\n      style={{ height: '100%' }}\r\n    />\r\n  )\r\n}\r\n\r\nexport default CDChart","import { useState, useEffect, useMemo, useRef } from 'react'\r\nimport { Slider, Checkbox } from 'antd'\r\nimport CDChart from './CDChart'\r\nimport { usePrevious, useDomSize } from 'src/hooks'\r\nimport { cloneDeep, isEqual } from 'lodash'\r\nimport 'src/styles/modules/components/chartShow.less'\r\n\r\ntype Props = {\r\n  chartData: any,\r\n  alignChartData?: any,\r\n  chartOption?: any,\r\n  chartHeight?: number,\r\n  seriesData: any,\r\n  slider?: number,\r\n  sliderStyle?: Object,\r\n  sliderVisible?: boolean,\r\n  timeVisible?: boolean,\r\n  checkboxVisible?: boolean,\r\n  onChange?: Function,\r\n  onAlignChange?: Function,\r\n  onChartChange?: Function,\r\n  onCheckedChange?: Function\r\n}\r\n\r\nconst CDChartShow = (props: Props) => {\r\n  // 是否根据对齐数据画图\r\n  const targetAlign = useMemo(() => {\r\n    const { PositionNumbers: alignPoints = [] } = props.alignChartData || {}\r\n    return !!alignPoints.length\r\n  }, [props.alignChartData])\r\n\r\n  // 图表数据有效的 PositionNumber 集\r\n  const validPoints = useMemo(() => {\r\n    const { PositionNumbers: initPoints = [] } = props.chartData\r\n    return initPoints.map((item: any) => item[targetAlign ? 'AlignPositionNumber' : 'PositionNumber'])\r\n  }, [props.chartData, targetAlign])\r\n\r\n  // Slider min max 范围\r\n  const range = useMemo(() => {\r\n    const { chartData, alignChartData = {} } = props\r\n    const { PositionNumbers: initPoints = [] } = chartData\r\n    const { PositionNumbers: alignPoints = [] } = alignChartData\r\n    const points = targetAlign ? alignPoints : initPoints\r\n    return {\r\n      min: points[0]?.PositionNumber || 1,\r\n      max: points[points.length - 1]?.PositionNumber || 100\r\n    }\r\n  }, [props.chartData, targetAlign])\r\n\r\n  // Slider\r\n  const [slider, setSlider] = useState(0)\r\n\r\n  // 根据对齐数据画图计算出对应的 Slider\r\n  const getValidSlider = (value: number | undefined, revert: boolean = false) => {\r\n    if (!targetAlign) return value\r\n\r\n    const { chartData } = props\r\n    const { PositionNumbers: initPoints = [] } = chartData\r\n    if (revert) {\r\n      const find = initPoints.find((item: any) => item.PositionNumber === value)\r\n      return find?.AlignPositionNumber\r\n    }\r\n    const find = initPoints.find((item: any) => item.AlignPositionNumber === value)\r\n    return find?.PositionNumber\r\n  }\r\n\r\n  // 滑块滑动时，从 validPoints 中取离当前滑块最近的一个有效值\r\n  const handleSliderChange = (val: number) => {\r\n    if (!validPoints.includes(val)) {\r\n      const copyData = cloneDeep(validPoints)\r\n      copyData.push(val)\r\n      copyData.sort((a: number, b: number) => a - b)\r\n      const index = copyData.indexOf(val)\r\n      if (index === 0 || index === copyData.length - 1) {\r\n        val = index === 0 ? validPoints[0] : validPoints[validPoints.length - 1]\r\n      } else {\r\n        const prevDiff = copyData[index] - copyData[index - 1]\r\n        const nextDiff = copyData[index + 1] - copyData[index]\r\n        val = prevDiff > nextDiff ? copyData[index + 1] : copyData[index - 1]\r\n      }\r\n    }\r\n    setSlider(val)\r\n    props.onChange instanceof Function && props.onChange(getValidSlider(val))\r\n  }\r\n\r\n  // 初始化 Slider 的位置\r\n  const prevPoints = usePrevious(validPoints)\r\n  useEffect(() => {\r\n    // 切换执行器和测量对象预览时候，会出现位号标记线，所以这边 slider 不显示的时候，不设置 slider\r\n    const { sliderVisible = true } = props\r\n    // 当 props.chartData 变更时候（手动设定SP），validPoints 依赖这个属性，这时候不希望 slider 变化，所以添加 isEqual 判断\r\n    if (!isEqual(prevPoints, validPoints) && sliderVisible) {\r\n      handleSliderChange(validPoints[Math.floor((validPoints.length - 1) / 2)])\r\n    }\r\n  }, [validPoints])\r\n\r\n  // 同步更新父组件的 props.slider，注意该 effect 需要在【初始化 Slider 的位置】的 effect 后面，以 props.slider 为主\r\n  useEffect(() => {\r\n    setSlider(getValidSlider(props.slider, true)) // 不判断 props.slider !== undefined，因为对不齐的情况下，不显示位号标记线\r\n  }, [props.slider])\r\n\r\n  // 如果是对齐图表，并且最终的 slider 为 undefined，表明被对齐图表的位号在该对齐图表中不存在，这时候调整 slider，以确保位号线初始存在\r\n  const refOfInitDone = useRef(false)\r\n  useEffect(() => {\r\n    // 定时器是为了保证渲染完毕，slider 是最终的值，因为一开始 props.slider 也可能是 undefined，但是这个时候并不希望这个 effect 调用\r\n    let timer = setTimeout(() => {\r\n      if (slider === undefined && targetAlign && !refOfInitDone.current) {\r\n        refOfInitDone.current = true\r\n        const validSlider = validPoints[Math.floor((validPoints.length - 1) / 2)]\r\n        props.onAlignChange instanceof Function && props.onAlignChange(validSlider)\r\n      }\r\n    }, 200)\r\n    return () => clearTimeout(timer)\r\n  }, [slider, targetAlign, validPoints])\r\n\r\n  // 滑块值匹配的图表数据\r\n  const matchChartData = useMemo(() => {\r\n    const { PositionNumbers = [] } = props.chartData\r\n    return PositionNumbers.find((item: any) => item.PositionNumber === getValidSlider(slider))\r\n  }, [slider, props.chartData])\r\n  useEffect(() => {\r\n    props.onChartChange instanceof Function && props.onChartChange(matchChartData)\r\n  }, [matchChartData])\r\n\r\n  // 柱状图表复选框\r\n  const [checkedKeys, setCheckedKeys] = useState<number[]>([])\r\n  const handleCheckChange = (val: number, checked: boolean) => {\r\n    checked ? setCheckedKeys(checkedKeys.concat(val)) : setCheckedKeys(checkedKeys.filter((item: number) => item !== val))\r\n  }\r\n  const handleCheckAll = (checked: boolean) => {\r\n    const { chartData } = props\r\n    checked ? setCheckedKeys(chartData.PositionNumbers.map((item: any) => item.PositionNumber)) : setCheckedKeys([])\r\n  }\r\n  useEffect(() => {\r\n    props.onCheckedChange instanceof Function && props.onCheckedChange(checkedKeys)\r\n  }, [checkedKeys])\r\n\r\n  // 判断图表数据是否更新\r\n  const prevChartData = usePrevious(props.chartData)\r\n  useEffect(() => {\r\n    const updated = !isEqual(prevChartData, props.chartData)\r\n    updated && setCheckedKeys([])\r\n  }, [props.chartData])\r\n\r\n  // 图表宽度\r\n  const refOfSlider = useRef(null)\r\n  const domSize = useDomSize(refOfSlider)\r\n  const chartWidth = useMemo(() => {\r\n    // 90: slider 的 padding 值\r\n    return domSize.clientWidth - 90\r\n  }, [domSize])\r\n\r\n  const {\r\n    sliderStyle,\r\n    sliderVisible = true,\r\n    timeVisible,\r\n    checkboxVisible = false,\r\n    chartData,\r\n    alignChartData = {},\r\n    chartHeight,\r\n    chartOption,\r\n    seriesData\r\n  } = props\r\n\r\n  const { PositionNumbers: initPoints = [] } = chartData\r\n  const { PositionNumbers: alignPoints = [] } = alignChartData\r\n  const points = targetAlign ? alignPoints : initPoints\r\n  const gap = chartWidth / (points.length - 1)\r\n\r\n  return (\r\n    <div className='chart-show'>\r\n      {\r\n        sliderVisible\r\n          ? (\r\n            <div ref={refOfSlider} className='chart-show__slider' style={sliderStyle}>\r\n              <Slider\r\n                {...range}\r\n                value={slider}\r\n                tipFormatter={val => getValidSlider(val)}\r\n                onChange={handleSliderChange}\r\n              />\r\n            </div>\r\n          )\r\n          : null\r\n      }\r\n      <div className='chart-show__chart' style={{ height: chartHeight || 360 }}>\r\n        {\r\n          timeVisible\r\n            ? (\r\n              <div className='chart-show__chart-time'>\r\n                {chartData.CurrentDataTime ? <span>当前时间：{chartData.CurrentDataTime}</span> : null}\r\n                {chartData.LastSnapTime ? <span>快照时间：{chartData.LastSnapTime}</span> : null}\r\n              </div>\r\n            )\r\n            : null\r\n        }\r\n        <CDChart\r\n          chartData={chartData}\r\n          alignChartData={alignChartData}\r\n          chartOption={chartOption}\r\n          seriesData={seriesData}\r\n          position={slider}\r\n        />\r\n      </div>\r\n      {\r\n        checkboxVisible\r\n          ? (\r\n            <div className='chart-show__checkbox'>\r\n              {\r\n                points.length\r\n                  ? (\r\n                    <Checkbox\r\n                      indeterminate={!!checkedKeys.length && checkedKeys.length !== chartData.PositionNumbers.length}\r\n                      onChange={evt => handleCheckAll(evt.target.checked)}\r\n                      className='chart-show__checkbox-all'\r\n                    />\r\n                  )\r\n                  : null\r\n              }\r\n              {\r\n                points.map((item: any, index: number) => {\r\n                  let { PositionNumber: point } = item\r\n                  if (targetAlign) {\r\n                    const find = initPoints.find((init: any) => init.AlignPositionNumber === point)\r\n                    point = find?.PositionNumber\r\n                  }\r\n                  if (point) {\r\n                    return (\r\n                      <div\r\n                        key={`${point}_${index}`}\r\n                        className='chart-show__checkbox-point'\r\n                        style={{ left: `${gap * index + 60}px` }}\r\n                      >\r\n                        <Checkbox\r\n                          checked={checkedKeys.indexOf(point) !== -1}\r\n                          onChange={evt => handleCheckChange(point, evt.target.checked)}\r\n                        />\r\n                      </div>\r\n                    )\r\n                  }\r\n                  return <div key={`${point}_${index}`} className='chart-show__checkbox-point opacity-0' />\r\n                })\r\n              }\r\n            </div>\r\n          )\r\n          : null\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default CDChartShow","import { useState, useEffect } from 'react'\r\nimport ReactEcharts from 'echarts-for-react'\r\nimport { cloneDeep } from 'lodash'\r\n\r\ntype BarOption = {\r\n  // echarts 配置\r\n  name: string,\r\n  itemStyle: any\r\n}\r\n\r\ntype LineOption = {\r\n  // echarts 配置\r\n  name: string,\r\n  lineStyle: any,\r\n  itemStyle: any,\r\n  areaStyle: any\r\n}\r\n\r\ntype ChartOption = {\r\n  // echarts 配置\r\n  title: any,\r\n  legend: any,\r\n  grid: any,\r\n  tooltip: any,\r\n  xAxis: any,\r\n  yAxis: any,\r\n  // 自定义配置\r\n  lineOption: LineOption,\r\n  barOption: BarOption\r\n}\r\n\r\ntype SeriesData = {\r\n  // 自定义配置\r\n  field: string,\r\n  data: any[],\r\n  checkLoop?: boolean,\r\n  chartOption?: ChartOption\r\n}\r\n\r\nconst barMaxWidth = 13\r\nconst presetColors = [\r\n  '133, 84, 158',\r\n  '0, 183, 238',\r\n  '50, 177, 108',\r\n  '250, 140, 22',\r\n  '255, 77, 79',\r\n  '255, 236, 61',\r\n  '8, 151, 156',\r\n  '158, 16, 104',\r\n  '255, 251, 230',\r\n  '120, 6, 80'\r\n]\r\nconst seriesOption = (chart: SeriesData, index: number) => {\r\n  const { data, chartOption = {} } = chart\r\n  const { lineOption, barOption } = chartOption as ChartOption\r\n\r\n  const itemColor = presetColors[index % presetColors.length]\r\n\r\n  if (lineOption) {\r\n    return {\r\n      symbol: 'none',\r\n      ...lineOption,\r\n      type: 'line',\r\n      lineStyle: {\r\n        color: `rgba(${itemColor}, 1)`,\r\n        ...lineOption?.lineStyle\r\n      },\r\n      itemStyle: {\r\n        color: `rgba(${itemColor}, 1)`,\r\n        ...lineOption?.itemStyle\r\n      },\r\n      areaStyle: {\r\n        color: {\r\n          type: 'linear',\r\n          x: 0,\r\n          y: 0,\r\n          x2: 0,\r\n          y2: 1,\r\n          colorStops: [\r\n            {\r\n              offset: 0,\r\n              color: `rgba(${itemColor}, 0.6)`\r\n            },\r\n            {\r\n              offset: 1,\r\n              color: `rgba(${itemColor}, 0.05)`\r\n            }\r\n          ]\r\n        },\r\n        ...lineOption?.areaStyle\r\n      },\r\n      data\r\n    }\r\n  }\r\n\r\n  if (barOption) {\r\n    return {\r\n      barWidth: barMaxWidth,\r\n      ...barOption,\r\n      type: 'bar',\r\n      itemStyle: {\r\n        color: `rgba(${itemColor}, 1)`,\r\n        ...barOption?.itemStyle\r\n      },\r\n      data\r\n    }\r\n  }\r\n\r\n  return { data }\r\n}\r\n\r\ntype Props = {\r\n  chartData: any,\r\n  chartOption?: ChartOption,\r\n  seriesData: SeriesData[],\r\n  position?: number\r\n}\r\n\r\nconst TimeChart = (props: Props) => {\r\n  const [option, setOption] = useState<any>()\r\n  useEffect(() => {\r\n    // 定时器保证图表是在最后更新的，以提高界面显示性能\r\n    let timer = setTimeout(() => {\r\n      const { chartData, chartOption, seriesData, position } = props\r\n      const { Data = [], Name: name, Unit: title = 'gsm', CoordinateMax = 0, CoordinateMin = 0 } = chartData\r\n\r\n      // 将类目轴转成数值轴\r\n      const points = cloneDeep(Data)\r\n      points.forEach((point: any, index: number) => {\r\n        point.PositionNumber = index + 1\r\n      })\r\n\r\n      // 标记线\r\n      const markLines: any = {\r\n        name: 'markLines',\r\n        type: 'line',\r\n        markLine: {\r\n          symbol: 'none',\r\n          silent: true,\r\n          animation: false,\r\n          label: {\r\n            position: 'insideEndTop',\r\n            formatter: '{b}: {c}'\r\n          },\r\n          lineStyle: {\r\n            type: 'solid',\r\n            color: '#bcbcbc'\r\n          },\r\n          data: []\r\n        }\r\n      }\r\n      // 位号标记线\r\n      position !== undefined && markLines.markLine.data.push({\r\n        name: '位号',\r\n        xAxis: position,\r\n        label: { formatter: '' }\r\n      })\r\n      // 上界标记线\r\n      CoordinateMax && markLines.markLine.data.push({\r\n        name: '上界',\r\n        yAxis: CoordinateMax\r\n      })\r\n      // 下界标记线\r\n      CoordinateMin && markLines.markLine.data.push({\r\n        name: '下界',\r\n        yAxis: CoordinateMin\r\n      })\r\n\r\n      // 根据 seriesData 筛选出需要展示的数据\r\n      const copyData = cloneDeep(seriesData)\r\n      points.forEach((item: any, index: number) => {\r\n        copyData.forEach((chart: any) => {\r\n          // PositionNumbers 里面有的字段才显示在图表上\r\n          if (item[chart.field] !== undefined) {\r\n            !chart.data && (chart.data = [])\r\n            if (chart.checkLoop && item.IsCloseLoop !== undefined) {\r\n              chart.data[index] = {\r\n                value: [item.PositionNumber, item[chart.field]],\r\n                itemStyle: { color: item.IsCloseLoop ? '#ffc355' : '#5bb86d' }\r\n              }\r\n            } else {\r\n              chart.data[index] = {\r\n                value: [item.PositionNumber, item[chart.field]]\r\n              }\r\n            }\r\n          }\r\n        })\r\n      })\r\n      const chartsData = copyData.filter((item: any) => item.data?.length)\r\n\r\n      // 计算 XMin XMax 的值\r\n      const xMin = points[0]?.PositionNumber\r\n      const xMax = points[points.length - 1]?.PositionNumber\r\n      // 计算 YMax 的值\r\n      const yVals: any = []\r\n      chartsData.forEach((item: any) => yVals.push(...item.data.map((i: any) => i.value[1])))\r\n      const yAxisMax = Math.ceil(Math.max(CoordinateMax, ...yVals.filter((item: any) => item !== undefined)) * 1.15)\r\n      setOption({\r\n        title: {\r\n          top: 0,\r\n          left: 60,\r\n          text: title,\r\n          ...chartOption?.title,\r\n          // 注意 chartOption 的展开位置，后面的属性不允许被 chartOption 完全覆盖\r\n          textStyle: {\r\n            fontSize: 12,\r\n            fontWeight: 'normal',\r\n            color: '#aaa',\r\n            ...chartOption?.title?.textStyle\r\n          },\r\n        },\r\n        legend: {\r\n          top: 0,\r\n          ...chartOption?.legend,\r\n          // 注意 chartOption 的展开位置，后面的属性不允许被 chartOption 完全覆盖\r\n          data: chartsData.map((series: SeriesData) => {\r\n            const { chartOption = {} } = series\r\n            const { legend = {}, lineOption = {}, barOption = {} } = chartOption as ChartOption\r\n            const { name: lineName } = lineOption as LineOption\r\n            const { name: barName } = barOption as LineOption\r\n            const { data = [] } = legend\r\n            return {\r\n              name: lineName || barName,\r\n              ...data[0]\r\n            }\r\n          }),\r\n        },\r\n        grid: {\r\n          top: 20,\r\n          right: 30,\r\n          bottom: 20,\r\n          left: 60,\r\n          containLabel: false,\r\n          ...chartOption?.grid\r\n        },\r\n        tooltip: {\r\n          /**\r\n           * axis 表示 tooltip 根据 xAxis 进行触发，这样鼠标只要在图上，就会自动匹配到 X 轴数据，并显示对应的 Y 轴数据\r\n           * item 表示 tooltip 只会根据选中的项进行触发，如果鼠标不在选中项上，则 tooltip 不会触发\r\n           */\r\n          trigger: 'axis',\r\n          borderColor: 'rgba(0,0,0,0)',\r\n          ...chartOption?.tooltip,\r\n          // 注意 chartOption 的展开位置，后面的属性不允许被 chartOption 完全覆盖\r\n          formatter: (params: any) => {\r\n            const { seriesName, marker, value } = params[0]\r\n            const find = points.find((item: any) => item.PositionNumber === value[0])\r\n            return (`\r\n            <div>\r\n              <p>${find?.Time || ''}</p>\r\n              <span>${marker}${seriesName} ${value[1]}</span>\r\n            </div>\r\n          `)\r\n          },\r\n        },\r\n        xAxis: {\r\n          min: xMin || null,\r\n          max: xMax || null,\r\n          maxInterval: 50,\r\n          ...chartOption?.xAxis,\r\n          // 注意 chartOption 的展开位置，后面的属性不允许被 chartOption 完全覆盖\r\n          type: 'value',\r\n          axisLine: {\r\n            lineStyle: {\r\n              color: '#BFBFBF'\r\n            }\r\n          },\r\n          axisTick: {\r\n            alignWithLabel: true,\r\n            ...chartOption?.xAxis?.axisTick\r\n          },\r\n          axisLabel: {\r\n            color: '#BFBFBF',\r\n            fontSize: 11,\r\n            formatter: (val: number) => {\r\n              const find = points.find((item: any) => item.PositionNumber === val)\r\n              return find?.Time\r\n            }\r\n          },\r\n          splitLine: {\r\n            show: false\r\n          }\r\n        },\r\n        yAxis: {\r\n          type: 'value',\r\n          name,\r\n          nameLocation: 'center',\r\n          nameGap: 40,\r\n          min: null,\r\n          max: yAxisMax,\r\n          offset: barMaxWidth,\r\n          ...chartOption?.yAxis,\r\n          // 注意 chartOption 的展开位置，后面的属性不允许被 chartOption 完全覆盖\r\n          nameTextStyle: {\r\n            color: '#000000'\r\n          },\r\n          splitLine: {\r\n            show: false\r\n          },\r\n          axisLine: {\r\n            show: true,\r\n            lineStyle: {\r\n              color: '#BFBFBF'\r\n            }\r\n          },\r\n          axisTick: {\r\n            show: true,\r\n            lineStyle: {\r\n              color: '#C5C5C5'\r\n            }\r\n          },\r\n          axisLabel: {\r\n            color: '#7B7B7B',\r\n            fontSize: 11\r\n          },\r\n        },\r\n        series: [markLines].concat(chartsData.map((series: SeriesData, index: number) => seriesOption(series, index)))\r\n      })\r\n    }, 300)\r\n\r\n    return () => clearTimeout(timer)\r\n  }, [props.chartData, props.chartOption, props.position])\r\n\r\n  if (!option) return null\r\n\r\n  return (\r\n    <ReactEcharts\r\n      lazyUpdate\r\n      option={option}\r\n      style={{ height: '100%' }}\r\n    />\r\n  )\r\n}\r\n\r\nexport default TimeChart","import { useState, useEffect, useMemo } from 'react'\r\nimport { Slider } from 'antd'\r\nimport TimeChart from './TimeChart'\r\nimport 'src/styles/modules/components/chartShow.less'\r\n\r\ntype Props = {\r\n  chartData: any,\r\n  chartOption?: any,\r\n  chartHeight?: number,\r\n  seriesData: any,\r\n  slider?: string,\r\n  sliderPosition?: 'top' | 'bottom',\r\n  sliderStyle?: Object,\r\n  sliderVisible?: boolean,\r\n  onChange?: Function,\r\n  onChartChange?: Function\r\n}\r\n\r\nconst TimeChartShow = (props: Props) => {\r\n  // 图表数据有效的 PositionNumber 集\r\n  const validPoints = useMemo(() => {\r\n    const { Data = [] } = props.chartData\r\n    return Data.map((item: any) => item.Time)\r\n  }, [props.chartData])\r\n\r\n  // Slider min max 范围\r\n  const range = useMemo(() => {\r\n    return {\r\n      min: 1,\r\n      max: validPoints.length\r\n    }\r\n  }, [validPoints])\r\n\r\n  // Slider\r\n  const [slider, setSlider] = useState(0)\r\n\r\n  // slider 和 time 相互转换\r\n  const getValidSlider = (value: string | number, revert: boolean = false) => {\r\n    // @ts-ignore\r\n    return revert ? validPoints.indexOf(value) + 1 : validPoints[value - 1]\r\n  }\r\n\r\n  // 滑块滑动处理\r\n  const handleSliderChange = (val: number) => {\r\n    setSlider(val)\r\n    props.onChange instanceof Function && props.onChange(getValidSlider(val))\r\n  }\r\n\r\n  // 初始化 Slider 的位置\r\n  useEffect(() => {\r\n    // 切换执行器和测量对象预览时候，会出现位号标记线，所以这边 slider 不显示的时候，不设置 slider\r\n    const { sliderVisible = true } = props\r\n    sliderVisible && handleSliderChange(Math.ceil(validPoints.length / 2))\r\n  }, [props.sliderVisible, validPoints])\r\n\r\n  // 同步更新父组件的 props.slider，注意该 effect 需要在【初始化 Slider 的位置】的 effect 后面，以 props.slider 为主\r\n  useEffect(() => {\r\n    setSlider(getValidSlider(props.slider || 0, true)) // 不判断 props.slider !== undefined，因为一些情况下，不需要显示位号标记线\r\n  }, [props.slider])\r\n\r\n  // 滑块值匹配的图表数据\r\n  const matchChartData = useMemo(() => {\r\n    const { Data = [] } = props.chartData\r\n    return Data.find((item: any) => item.Time === getValidSlider(slider))\r\n  }, [slider, props.chartData])\r\n  useEffect(() => {\r\n    props.onChartChange instanceof Function && props.onChartChange(matchChartData)\r\n  }, [matchChartData])\r\n\r\n  const {\r\n    sliderPosition = 'top',\r\n    sliderStyle,\r\n    sliderVisible = true,\r\n    chartData,\r\n    chartHeight,\r\n    chartOption,\r\n    seriesData\r\n  } = props\r\n\r\n  return (\r\n    <div className='chart-show'>\r\n      {\r\n        sliderVisible && sliderPosition === 'top'\r\n          ? (\r\n            <div className='chart-show__slider' style={sliderStyle}>\r\n              <Slider\r\n                {...range}\r\n                value={slider}\r\n                // @ts-ignore\r\n                tipFormatter={val => getValidSlider(val)}\r\n                onChange={handleSliderChange}\r\n              />\r\n            </div>\r\n          )\r\n          : null\r\n      }\r\n      <div className='chart-show__chart' style={{ height: chartHeight || 360 }}>\r\n        <TimeChart\r\n          chartData={chartData}\r\n          chartOption={chartOption}\r\n          seriesData={seriesData}\r\n          position={slider}\r\n        />\r\n      </div>\r\n      {\r\n        sliderVisible && sliderPosition === 'bottom'\r\n          ? (\r\n            <div className='chart-show__slider' style={sliderStyle}>\r\n              <Slider\r\n                {...range}\r\n                value={slider}\r\n                // @ts-ignore\r\n                tipFormatter={val => getValidSlider(val)}\r\n                onChange={handleSliderChange}\r\n              />\r\n            </div>\r\n          )\r\n          : null\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default TimeChartShow","import { useState, useEffect } from 'react'\r\nimport ReactEcharts from 'echarts-for-react'\r\nimport { cloneDeep } from 'lodash'\r\n\r\ntype ChartOption = {\r\n  // echarts 配置\r\n  title: any,\r\n  legend: any,\r\n  grid: any,\r\n  tooltip: any,\r\n  xAxis: any,\r\n  yAxis: any,\r\n  [propName: string]: any\r\n}\r\n\r\ntype SeriesData = {\r\n  // 自定义配置\r\n  field: string,\r\n  data: any[],\r\n  chartOption?: ChartOption\r\n}\r\n\r\nconst seriesOption = (chart: SeriesData) => {\r\n  const { data, chartOption = {} as ChartOption } = chart\r\n\r\n  return {\r\n    ...chartOption,\r\n    type: 'heatmap',\r\n    data,\r\n    emphasis: {\r\n      itemStyle: {\r\n        shadowBlur: 10,\r\n        shadowColor: 'rgba(0, 0, 0, 0.5)'\r\n      },\r\n      ...chartOption.emphasis\r\n    }\r\n  }\r\n}\r\n\r\ntype Props = {\r\n  chartData: any,\r\n  chartOption?: ChartOption,\r\n  seriesData: SeriesData[],\r\n  slider?: { xAxis: number, yAxis: number }\r\n}\r\n\r\nconst HistoryChart = (props: Props) => {\r\n  const [option, setOption] = useState<any>()\r\n  useEffect(() => {\r\n    // 定时器保证图表是在最后更新的，以提高界面显示性能\r\n    let timer = setTimeout(() => {\r\n      const { chartData, chartOption, seriesData, slider } = props\r\n      const { Data = [], Name: name, Unit: title = 'gsm' } = chartData\r\n\r\n      const points = cloneDeep(Data)\r\n\r\n      // 标记线\r\n      const markLines: any = {\r\n        name: 'markLines',\r\n        type: 'line',\r\n        markLine: {\r\n          symbol: 'none',\r\n          silent: true,\r\n          animation: false,\r\n          label: {\r\n            position: 'insideEndTop',\r\n            formatter: '{b}: {c}'\r\n          },\r\n          lineStyle: {\r\n            type: 'solid',\r\n            color: '#bcbcbc'\r\n          },\r\n          data: []\r\n        }\r\n      }\r\n      // 时间标记线\r\n      slider?.xAxis !== undefined && markLines.markLine.data.push({\r\n        name: '时间',\r\n        xAxis: slider.xAxis,\r\n        label: { formatter: '' }\r\n      })\r\n      // 位号标记线\r\n      slider?.yAxis !== undefined && markLines.markLine.data.push({\r\n        name: '位号',\r\n        yAxis: slider.yAxis - 1,\r\n        label: {\r\n          formatter: function (params: any) {\r\n            const { name, value } = params\r\n            return `${name}：${value + 1}`\r\n          }\r\n        }\r\n      })\r\n\r\n      // x轴数据\r\n      const xAxisData = points.map((point: any) => point.T)\r\n\r\n      // y轴数据\r\n      const yAxisData = points[0]?.P.map((p: any) => p[0]) || []\r\n\r\n      // 根据 seriesData 筛选出需要展示的数据\r\n      const copyData = cloneDeep(seriesData)\r\n      const virtualMapRange: any = []\r\n      points.forEach((item: any, index: number) => {\r\n        const { P = [] } = item\r\n        copyData.forEach((chart: any) => {\r\n          // 根据 fieldIndex 对应 P 中的数据\r\n          if (chart.fieldIndex !== undefined) {\r\n            !chart.data && (chart.data = [])\r\n            const yMapToXData: any = []\r\n            P.forEach((p: any, pi: number) => {\r\n              yMapToXData.push([index, pi, p[chart.fieldIndex]])\r\n              virtualMapRange.push(p[chart.fieldIndex])\r\n            })\r\n            chart.data.push(...yMapToXData)\r\n          }\r\n        })\r\n      })\r\n      const chartsData = copyData.filter((item: any) => item.data?.length)\r\n\r\n      setOption({\r\n        title: {\r\n          top: 0,\r\n          left: 60,\r\n          text: title,\r\n          ...chartOption?.title,\r\n          // 注意 chartOption 的展开位置，后面的属性不允许被 chartOption 完全覆盖\r\n          textStyle: {\r\n            fontSize: 12,\r\n            fontWeight: 'normal',\r\n            color: '#aaa',\r\n            ...chartOption?.title?.textStyle\r\n          },\r\n        },\r\n        grid: {\r\n          top: 20,\r\n          right: 30,\r\n          bottom: 20,\r\n          left: 60,\r\n          containLabel: false,\r\n          ...chartOption?.grid\r\n        },\r\n        tooltip: {\r\n          borderColor: 'rgba(0,0,0,0)',\r\n          ...chartOption?.tooltip,\r\n          // 注意 chartOption 的展开位置，后面的属性不允许被 chartOption 完全覆盖\r\n          formatter: (params: any) => {\r\n            const { name, marker, value } = params\r\n            return (`\r\n            <div>\r\n              <p>${name}</p>\r\n              <span>${marker}位号${value[1] + 1} ${value[2]}</span>\r\n            </div>\r\n          `)\r\n          },\r\n        },\r\n        xAxis: {\r\n          ...chartOption?.xAxis,\r\n          // 注意 chartOption 的展开位置，后面的属性不允许被 chartOption 完全覆盖\r\n          type: 'category',\r\n          data: xAxisData,\r\n          splitArea: {\r\n            show: true\r\n          },\r\n          axisTick: {\r\n            alignWithLabel: true\r\n          },\r\n          axisLabel: {\r\n            showMinLabel: true,\r\n            showMaxLabel: true\r\n          }\r\n        },\r\n        yAxis: {\r\n          name,\r\n          nameLocation: 'center',\r\n          nameGap: 40,\r\n          offset: 13,\r\n          ...chartOption?.yAxis,\r\n          // 注意 chartOption 的展开位置，后面的属性不允许被 chartOption 完全覆盖\r\n          type: 'category',\r\n          data: yAxisData,\r\n          nameTextStyle: {\r\n            color: '#000000'\r\n          },\r\n          splitArea: {\r\n            show: true\r\n          },\r\n          axisTick: {\r\n            alignWithLabel: true\r\n          },\r\n          axisLabel: {\r\n            showMinLabel: true,\r\n            showMaxLabel: true\r\n          }\r\n        },\r\n        visualMap: {\r\n          min: Math.min(...virtualMapRange),\r\n          max: Math.max(...virtualMapRange),\r\n          show: false\r\n        },\r\n        series: [markLines].concat(chartsData.map((series: SeriesData) => seriesOption(series)))\r\n      })\r\n    }, 300)\r\n\r\n    return () => clearTimeout(timer)\r\n  }, [props.chartData, props.chartOption, props.slider])\r\n\r\n  if (!option) return null\r\n\r\n  return (\r\n    <ReactEcharts\r\n      lazyUpdate\r\n      option={option}\r\n      style={{ height: '100%' }}\r\n    />\r\n  )\r\n}\r\n\r\nexport default HistoryChart","import { useState, useEffect, useMemo, useRef } from 'react'\r\nimport { Slider } from 'antd'\r\nimport HistoryChart from './HistoryChart'\r\nimport { useDomSize } from 'src/hooks'\r\nimport { cloneDeep } from 'lodash'\r\nimport 'src/styles/modules/components/chartShow.less'\r\n\r\nexport interface SliderProps {\r\n  xAxis: string,\r\n  yAxis: number\r\n}\r\n\r\ntype Props = {\r\n  chartData: any,\r\n  alignChartData?: any,\r\n  chartOption?: any,\r\n  chartHeight?: number,\r\n  seriesData: any,\r\n  slider?: SliderProps,\r\n  sliderStyle?: Object,\r\n  sliderVisible?: boolean,\r\n  onChange?: Function,\r\n  onRangeChange?: Function,\r\n  onChartChange?: Function\r\n}\r\n\r\nconst HistoryChartShow = (props: Props) => {\r\n  /**\r\n   * P:[[1, 2, 4.55, 9.88, 0, 0]]\r\n   * P:[[位号, 对齐位号, SP值, PV值, 上界, 下界]]\r\n   */\r\n\r\n  // 图表数据有效的时间点集\r\n  const validPoints = useMemo(() => {\r\n    const { Data = [] } = props.chartData\r\n    return {\r\n      xAxis: Data.map((item: any) => item.T),\r\n      yAxis: Data[0]?.P.map((p: any) => p[0]) || []\r\n    }\r\n  }, [props.chartData])\r\n\r\n  // 对齐图表对齐的有效位号\r\n  const validAlignPoint = useMemo(() => {\r\n    const { alignChartData = [] } = props\r\n    let align: number[] = []\r\n    alignChartData.forEach((chart: any) => {\r\n      const { Data = [] } = chart\r\n      const points: number[] = []\r\n      Data[0]?.P && Data[0].P.forEach((p: any) => {\r\n        points.push(p[1])\r\n      })\r\n      // 取所有对齐图表都能对的上的被对齐图表的位号\r\n      !align.length && (align = points)\r\n      align = align.filter((val: number) => val && points.includes(val))\r\n    })\r\n    return align\r\n  }, [props.alignChartData])\r\n\r\n  // Slider min max 范围\r\n  const range = useMemo(() => {\r\n    return {\r\n      xAxis: {\r\n        min: 0,\r\n        max: validPoints.xAxis.length - 1\r\n      },\r\n      yAxis: {\r\n        min: 1,\r\n        max: validPoints.yAxis.length\r\n      }\r\n    }\r\n  }, [validPoints])\r\n  useEffect(() => {\r\n    props.onRangeChange instanceof Function && props.onRangeChange(range)\r\n  }, [range])\r\n\r\n  // Slider\r\n  const [slider, setSlider] = useState({ xAxis: 0, yAxis: 0 })\r\n\r\n  // slider 和 time 相互转换\r\n  const getValidSlider = (value: string | number, type: 'xAxis' | 'yAxis', revert: boolean = false) => {\r\n    if (revert) {\r\n      return type === 'xAxis' ? validPoints.xAxis.indexOf(value) : validPoints.yAxis.indexOf(value) + 1\r\n    }\r\n    // @ts-ignore\r\n    return type === 'xAxis' ? validPoints.xAxis[value] : validPoints.yAxis[value - 1]\r\n  }\r\n\r\n  // 滑块滑动处理\r\n  const handleSliderChange = (val: number, type: 'xAxis' | 'yAxis') => {\r\n    const newSlider = { ...slider, [type]: val }\r\n    setSlider(newSlider)\r\n    props.onChange instanceof Function && props.onChange({\r\n      xAxis: getValidSlider(newSlider.xAxis, 'xAxis'),\r\n      yAxis: getValidSlider(newSlider.yAxis, 'yAxis')\r\n    })\r\n  }\r\n\r\n  // 初始化 Slider 的位置\r\n  useEffect(() => {\r\n    const newSlider = {\r\n      xAxis: Math.ceil(validPoints.xAxis.length / 2),\r\n      yAxis: Math.ceil(validPoints.yAxis.length / 2)\r\n    }\r\n    // 从 validAlignPoint 中取离当前滑块最近的一个有效值\r\n    if (validAlignPoint.length && !validAlignPoint.includes(newSlider.yAxis)) {\r\n      const copyData = cloneDeep(validAlignPoint)\r\n      copyData.push(newSlider.yAxis)\r\n      copyData.sort((a: number, b: number) => a - b)\r\n      const index = copyData.indexOf(newSlider.yAxis)\r\n      if (index === 0 || index === copyData.length - 1) {\r\n        newSlider.yAxis = index === 0 ? validAlignPoint[0] : validAlignPoint[validAlignPoint.length - 1]\r\n      } else {\r\n        const prevDiff = copyData[index] - copyData[index - 1]\r\n        const nextDiff = copyData[index + 1] - copyData[index]\r\n        newSlider.yAxis = prevDiff > nextDiff ? copyData[index + 1] : copyData[index - 1]\r\n      }\r\n    }\r\n    setSlider(newSlider)\r\n    props.onChange instanceof Function && props.onChange({\r\n      xAxis: getValidSlider(newSlider.xAxis, 'xAxis'),\r\n      yAxis: getValidSlider(newSlider.yAxis, 'yAxis')\r\n    })\r\n  }, [validPoints, validAlignPoint])\r\n\r\n  // 同步更新父组件的 props.slider，注意该 effect 需要在【初始化 Slider 的位置】的 effect 后面，以 props.slider 为主\r\n  useEffect(() => {\r\n    if (props.slider !== undefined) {\r\n      setSlider({\r\n        xAxis: getValidSlider(props.slider.xAxis, 'xAxis', true),\r\n        yAxis: getValidSlider(props.slider.yAxis, 'yAxis', true)\r\n      })\r\n    }\r\n  }, [props.slider])\r\n\r\n  // 滑块值匹配的图表数据\r\n  const matchMain = useMemo(() => {\r\n    const { Data = [] } = props.chartData\r\n    const xAxis = Data.find((item: any) => item.T === getValidSlider(slider.xAxis, 'xAxis'))\r\n    const main = {\r\n      xAxis,\r\n      yAxis: xAxis?.P.find((item: any) => item[0] === getValidSlider(slider.yAxis, 'yAxis'))\r\n    }\r\n    return main\r\n  }, [slider, props.chartData])\r\n  const matchAlign = useMemo(() => {\r\n    const { alignChartData = [] } = props\r\n    const align: any = []\r\n    alignChartData.forEach((chart: any) => {\r\n      const { Data = [] } = chart\r\n      const xAxis = Data.find((item: any) => item.T === matchMain.xAxis?.T)\r\n      const yAxis = xAxis?.P.find((item: any) => item[1] === getValidSlider(slider.yAxis, 'yAxis'))\r\n      align.push({ xAxis, yAxis })\r\n    })\r\n    return align\r\n  }, [slider, props.alignChartData, matchMain])\r\n  useEffect(() => {\r\n    props.onChartChange instanceof Function && props.onChartChange({ main: matchMain, align: matchAlign })\r\n  }, [matchMain, matchAlign])\r\n\r\n  const refOfDiv = useRef(null)\r\n  const domSize = useDomSize(refOfDiv)\r\n  const sliderPadding = useMemo(() => {\r\n    if (!validPoints.xAxis.length) return '6px 30px 6px 60px'\r\n\r\n    const { clientWidth } = domSize\r\n    const padding = clientWidth / validPoints.xAxis.length / 2\r\n    return `6px ${padding + 30}px 6px ${padding + 60}px`\r\n  }, [domSize, validPoints])\r\n\r\n  const {\r\n    sliderStyle,\r\n    sliderVisible = true,\r\n    chartData,\r\n    chartHeight,\r\n    chartOption,\r\n    seriesData\r\n  } = props\r\n\r\n  return (\r\n    <div className='chart-show'>\r\n      {\r\n        sliderVisible\r\n          ? (\r\n            <div className='chart-show__slider' style={{ ...sliderStyle, padding: sliderPadding }}>\r\n              <Slider\r\n                {...range.xAxis}\r\n                value={slider.xAxis}\r\n                // @ts-ignore\r\n                tipFormatter={val => getValidSlider(val, 'xAxis')}\r\n                onChange={(val) => handleSliderChange(val, 'xAxis')}\r\n              />\r\n            </div>\r\n          )\r\n          : null\r\n      }\r\n      <div\r\n        ref={refOfDiv}\r\n        className='chart-show__chart'\r\n        style={{ height: chartHeight || 360 }}\r\n      >\r\n        <HistoryChart\r\n          chartData={chartData}\r\n          chartOption={chartOption}\r\n          seriesData={seriesData}\r\n          slider={slider}\r\n        />\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default HistoryChartShow","import { RealTimeAct, RealTimeMea } from '.'\r\nimport { $consts } from 'src/plugins'\r\n\r\ntype Props = {\r\n  filter: any,\r\n  controlId: string | number,\r\n  previewType: string\r\n}\r\nconst DataPreviewRealtime = (props: Props) => {\r\n  if (props.previewType === $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR']) {\r\n    return <RealTimeAct filter={props.filter} controlId={props.controlId} />\r\n  }\r\n  return <RealTimeMea filter={props.filter} controlId={props.controlId} />\r\n}\r\n\r\nexport default DataPreviewRealtime","import { useState, useEffect, useMemo } from 'react'\r\nimport { Form, Input, InputNumber } from 'antd'\r\nimport { ClockCircleOutlined } from '@ant-design/icons'\r\nimport { CollpaseZone } from 'src/components'\r\nimport { TimeChartShow } from '.'\r\nimport { $api, $consts } from 'src/plugins'\r\nimport moment from 'moment'\r\n\r\ntype Props = {\r\n  slider: string,\r\n  chart: any,\r\n  matchChart?: any\r\n}\r\nconst MatchChartOptions = (props: Props) => {\r\n  return (\r\n    <Form layout='horizontal' labelCol={{ span: 10 }} wrapperCol={{ span: 14 }}>\r\n      <Form.Item label='时间'>\r\n        <Input\r\n          readOnly\r\n          value={props.slider}\r\n          suffix={<ClockCircleOutlined />}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label='当前值'>\r\n        <InputNumber\r\n          disabled\r\n          value={props.matchChart?.Value}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label='Max'>\r\n        <InputNumber\r\n          disabled\r\n          value={props.chart.Max}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label='Min'>\r\n        <InputNumber\r\n          disabled\r\n          value={props.chart.Min}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label='Avg'>\r\n        <InputNumber\r\n          disabled\r\n          value={props.chart.Avg}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label='坐标上界'>\r\n        <InputNumber\r\n          disabled\r\n          value={props.chart.CoordinateMax}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label='坐标下界'>\r\n        <InputNumber\r\n          disabled\r\n          value={props.chart.CoordinateMin}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n    </Form>\r\n  )\r\n}\r\n\r\nexport type AvgProps = {\r\n  previewType: string,\r\n  filter: any,\r\n  controlId: string | number,\r\n  timeRange: any[],\r\n  isSigma?: boolean\r\n}\r\n\r\nconst series = [\r\n  {\r\n    field: 'Value',\r\n    chartOption: {\r\n      lineOption: {\r\n        name: '当前值'\r\n      }\r\n    }\r\n  }\r\n]\r\nconst DataPreviewAvg = (props: AvgProps) => {\r\n  // 执行器、测量对象请求参数\r\n  const request = useMemo(() => {\r\n    if (!props.filter) return\r\n\r\n    const { previewType, controlId: ControllerId, filter, timeRange } = props\r\n    const { ActuatorId, MeasuringObjectId } = filter\r\n    // 执行器预览\r\n    if (previewType === $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR']) {\r\n      return {\r\n        url: 'datapreview/getAvgOrSigmaDataByMV',\r\n        payload: {\r\n          Type: props.isSigma ? 2 : 1,\r\n          ControllerId,\r\n          ActuatorId: ActuatorId[0],\r\n          MeasuringObjectIds: MeasuringObjectId,\r\n          StartTime: moment(timeRange[0]).format('YYYY-MM-DD HH:mm:ss'),\r\n          EndTime: moment(timeRange[1]).format('YYYY-MM-DD HH:mm:ss')\r\n        },\r\n        actChartsField: 'Actuator',\r\n        meaChartsField: 'MeasuringObjects',\r\n        mainChartField: 'actCharts',\r\n        alignChartsField: 'meaCharts'\r\n      }\r\n    }\r\n    // 测量对象预览\r\n    return {\r\n      url: 'datapreview/getAvgOrSigmaDataByCV',\r\n      payload: {\r\n        Type: props.isSigma ? 2 : 1,\r\n        ControllerId,\r\n        ActuatorIds: ActuatorId,\r\n        MeasuringObjectId: MeasuringObjectId[0],\r\n        StartTime: moment(timeRange[0]).format('YYYY-MM-DD HH:mm:ss'),\r\n        EndTime: moment(timeRange[1]).format('YYYY-MM-DD HH:mm:ss')\r\n      },\r\n      actChartsField: 'Actuators',\r\n      meaChartsField: 'MeasuringObject',\r\n      mainChartField: 'meaCharts',\r\n      alignChartsField: 'actCharts'\r\n    }\r\n  }, [props.previewType, props.controlId, props.filter, props.timeRange, props.isSigma])\r\n\r\n  // 总的图表数据\r\n  const [charts, setCharts] = useState<any>({ actCharts: [], meaCharts: [] })\r\n  const getCharts = () => {\r\n    if (request) {\r\n      $api[request.url](request.payload).then((res: any) => {\r\n        if (res) {\r\n          const actCharts = [].concat(res[request.actChartsField])\r\n          const meaCharts = [].concat(res[request.meaChartsField])\r\n          setCharts({ actCharts, meaCharts })\r\n        }\r\n      })\r\n    }\r\n  }\r\n  useEffect(() => {\r\n    getCharts()\r\n  }, [request])\r\n\r\n  // Slider 对应图表数据\r\n  const [slider, setSlider] = useState('')\r\n  const [matchMainChart, setMatchMainChart] = useState<any>()\r\n  const matchAlignCharts = useMemo(() => {\r\n    const matchCharts: any = []\r\n    const alignField = request?.alignChartsField || 'meaCharts'\r\n    charts[alignField].forEach((chart: any) => {\r\n      const { Data = [] } = chart\r\n      const find = Data.find((item: any) => item.Time === matchMainChart?.Time)\r\n      matchCharts.push(find)\r\n    })\r\n    return matchCharts\r\n  }, [request, charts, matchMainChart])\r\n\r\n  // options 展开收起\r\n  const [visible, setVisible] = useState(false)\r\n\r\n  const mainField = request?.mainChartField || 'actCharts'\r\n  const alignField = request?.alignChartsField || 'meaCharts'\r\n  return (\r\n    <div className='pd-b36'>\r\n      {\r\n        charts[mainField].map((chart: any, index: number) => {\r\n          return (\r\n            <CollpaseZone\r\n              key={`avg-main__chart-${index}`}\r\n              collapse={<MatchChartOptions slider={slider} chart={chart} matchChart={matchMainChart} />}\r\n              onChange={setVisible}\r\n            >\r\n              <TimeChartShow\r\n                slider={slider}\r\n                chartData={chart}\r\n                chartOption={{ legend: { show: false }, yAxis: { name: '' }, title: { text: chart?.Name } }}\r\n                chartHeight={260}\r\n                seriesData={series}\r\n                onChange={setSlider}\r\n                onChartChange={setMatchMainChart}\r\n              />\r\n            </CollpaseZone>\r\n          )\r\n        })\r\n      }\r\n      {\r\n        charts[alignField].map((chart: any, index: number) => {\r\n          const matchChart = matchAlignCharts[index]\r\n          return (\r\n            <CollpaseZone\r\n              key={`avg-align__chart-${index}`}\r\n              showHandler={false}\r\n              visible={visible}\r\n              collapse={<MatchChartOptions slider={slider} chart={chart} matchChart={matchChart} />}\r\n              zoneClass='border-top'\r\n              zoneRightClass='pd-t12'\r\n            >\r\n              <TimeChartShow\r\n                sliderVisible={false}\r\n                slider={slider}\r\n                chartData={chart}\r\n                chartOption={{ legend: { show: false }, yAxis: { name: '' }, title: { text: chart?.Name } }}\r\n                chartHeight={291}\r\n                seriesData={series}\r\n              />\r\n            </CollpaseZone>\r\n          )\r\n        })\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default DataPreviewAvg","import DataPreviewAvg, { AvgProps } from './DataPreviewAvg'\r\n\r\nconst DataPreviewTwosigma = (props: AvgProps) => {\r\n  return <DataPreviewAvg isSigma {...props} />\r\n}\r\n\r\nexport default DataPreviewTwosigma","import { useState, useEffect, useMemo } from 'react'\r\nimport { Form, Input, InputNumber } from 'antd'\r\nimport { ClockCircleOutlined } from '@ant-design/icons'\r\nimport { CollpaseZone } from 'src/components'\r\nimport { HistoryPreviewMain, HistoryPreviewAlign } from '.'\r\nimport HistoryChartShow, { SliderProps } from './HistoryChartShow'\r\nimport { $api, $consts, $evt } from 'src/plugins'\r\nimport moment from 'moment'\r\n\r\ntype Props = {\r\n  chartType: string,\r\n  chart: any,\r\n  matchChart: any,\r\n  slider: SliderProps,\r\n  sliderDisabled?: boolean,\r\n  range?: any,\r\n  onSliderChange?: Function\r\n}\r\nconst MatchChartOptions = (props: Props) => {\r\n  const { chartType, chart = {}, matchChart = {}, slider, range = {} } = props\r\n  const { xAxis, yAxis } = slider\r\n  const { yAxis: yAxisRange } = range\r\n  const { xAxis: xAxisChart = {}, yAxis: yAxisChart = [] } = matchChart\r\n  const { S, A, I } = xAxisChart\r\n  const unit = chartType === 'actCharts' ? 'U' : 'Y'\r\n\r\n  return (\r\n    <Form layout='horizontal' labelCol={{ span: 10 }} wrapperCol={{ span: 14 }}>\r\n      <Form.Item label='时间'>\r\n        <Input\r\n          readOnly\r\n          value={xAxis}\r\n          suffix={<ClockCircleOutlined />}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label='2σ'>\r\n        <InputNumber\r\n          disabled\r\n          value={S}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label={`${unit}Max`}>\r\n        <InputNumber\r\n          disabled\r\n          value={A}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label={`${unit}Min`}>\r\n        <InputNumber\r\n          disabled\r\n          value={I}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label='位号'>\r\n        <InputNumber\r\n          disabled={props.sliderDisabled}\r\n          value={yAxis}\r\n          {...yAxisRange}\r\n          onChange={val => props.onSliderChange instanceof Function && props.onSliderChange(val)}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label='目标值'>\r\n        <InputNumber\r\n          disabled\r\n          value={yAxisChart[2]}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label='当前值'>\r\n        <InputNumber\r\n          disabled\r\n          value={yAxisChart[3]}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label='上界'>\r\n        <InputNumber\r\n          disabled\r\n          value={yAxisChart[4]}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label='下界'>\r\n        <InputNumber\r\n          disabled\r\n          value={yAxisChart[5]}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label='坐标上界'>\r\n        <InputNumber\r\n          disabled\r\n          value={chart.CoordinateMax}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label='坐标下界'>\r\n        <InputNumber\r\n          disabled\r\n          value={chart.CoordinateMin}\r\n          className='data-preview__form-input'\r\n        />\r\n      </Form.Item>\r\n    </Form>\r\n  )\r\n}\r\n\r\ntype HisProps = {\r\n  previewType: string,\r\n  filter: any,\r\n  controlId: string | number,\r\n  timeRange: any[]\r\n}\r\n\r\nconst DataPreviewHistory = (props: HisProps) => {\r\n  // 执行器、测量对象请求参数\r\n  const request = useMemo(() => {\r\n    if (!props.filter) return\r\n\r\n    const { previewType, controlId: ControllerId, filter, timeRange } = props\r\n    const { ActuatorId, MeasuringObjectId } = filter\r\n    // 执行器预览\r\n    if (previewType === $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR']) {\r\n      return {\r\n        urls: ['datapreview/getActuatorHistoryData', 'datapreview/getHistoryDataByMV'],\r\n        payload: {\r\n          ControllerId,\r\n          ActuatorId: ActuatorId[0],\r\n          MeasuringObjectIds: MeasuringObjectId,\r\n          StartTime: moment(timeRange[0]).format('YYYY-MM-DD HH:mm:ss'),\r\n          EndTime: moment(timeRange[1]).format('YYYY-MM-DD HH:mm:ss')\r\n        },\r\n        dataChartsField: 'Actuator'\r\n      }\r\n    }\r\n    // 测量对象预览\r\n    return {\r\n      urls: ['datapreview/getMeasuringObjectHistoryData', 'datapreview/getHistoryDataByCV'],\r\n      payload: {\r\n        ControllerId,\r\n        ActuatorIds: ActuatorId,\r\n        MeasuringObjectId: MeasuringObjectId[0],\r\n        StartTime: moment(timeRange[0]).format('YYYY-MM-DD HH:mm:ss'),\r\n        EndTime: moment(timeRange[1]).format('YYYY-MM-DD HH:mm:ss')\r\n      },\r\n      dataChartsField: 'MeasuringObject'\r\n    }\r\n  }, [props.previewType, props.controlId, props.filter, props.timeRange])\r\n\r\n  // 总的图表数据\r\n  const [charts, setCharts] = useState<any>({\r\n    actCharts: [],\r\n    meaCharts: [],\r\n    previewType: $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR'],\r\n    mainField: 'actCharts',\r\n    alignField: 'meaCharts'\r\n  })\r\n  const getCharts = () => {\r\n    if (request) {\r\n      Promise.all(request.urls.map((url: string) => $api[url](request.payload))).then((datas: any[]) => {\r\n        if (request.dataChartsField === 'Actuator') {\r\n          const actCharts = [].concat(datas[0] ? datas[0][request.dataChartsField] : [])\r\n          const meaCharts = [].concat(datas[1] || [])\r\n          setCharts({\r\n            actCharts,\r\n            meaCharts,\r\n            previewType: $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR'],\r\n            mainField: 'actCharts',\r\n            alignField: 'meaCharts'\r\n          })\r\n        } else {\r\n          const actCharts = [].concat(datas[1] || [])\r\n          const meaCharts = [].concat(datas[0] ? datas[0][request.dataChartsField] : [])\r\n          setCharts({\r\n            actCharts,\r\n            meaCharts,\r\n            previewType: $consts['DATAPREVIEW/PREVIEW_TYPE_MEASURE'],\r\n            mainField: 'meaCharts',\r\n            alignField: 'actCharts'\r\n          })\r\n        }\r\n      })\r\n    }\r\n  }\r\n  useEffect(() => {\r\n    getCharts()\r\n  }, [request])\r\n\r\n  // Slider 对应图表数据\r\n  const [slider, setSlider] = useState<SliderProps>({ xAxis: '', yAxis: 0 })\r\n  const [range, setRange] = useState({ yAxis: { min: 0, max: 100 } })\r\n  const [matchChart, setMatchChart] = useState({ main: {}, align: [] })\r\n\r\n  // 监听CDM预览事件\r\n  const [preview, setPreview] = useState('')\r\n  useEffect(() => {\r\n    const handlePreview = (type: string) => {\r\n      setPreview(type)\r\n    }\r\n    $evt.addListener($consts['DATAPREVIEW/EVT_CMDPREVIEW'], handlePreview)\r\n\r\n    return () => {\r\n      $evt.removeListener($consts['DATAPREVIEW/EVT_CMDPREVIEW'], handlePreview)\r\n    }\r\n  }, [])\r\n\r\n  // options 展开收起\r\n  const [visible, setVisible] = useState(false)\r\n\r\n  return (\r\n    <div className='pd-b36'>\r\n      {\r\n        charts[charts.mainField].map((chart: any, index: number) => {\r\n          return (\r\n            <CollpaseZone\r\n              key={`his-main__chart-${index}`}\r\n              collapse={\r\n                <MatchChartOptions\r\n                  chartType={charts.mainField}\r\n                  chart={chart}\r\n                  matchChart={matchChart.main}\r\n                  slider={slider}\r\n                  range={range}\r\n                  onSliderChange={(val: number) => setSlider({ ...slider, yAxis: val })}\r\n                />\r\n              }\r\n              onChange={setVisible}\r\n            >\r\n              <HistoryChartShow\r\n                slider={slider}\r\n                chartData={chart}\r\n                alignChartData={charts[charts.alignField]}\r\n                chartOption={{ legend: { show: false }, yAxis: { name: '' }, title: { text: chart?.Name } }}\r\n                chartHeight={420}\r\n                seriesData={[{ fieldIndex: 2, chartOption: { progressive: 0 } }]}\r\n                onChange={setSlider}\r\n                onRangeChange={setRange}\r\n                onChartChange={setMatchChart}\r\n              />\r\n              {\r\n                preview ?\r\n                  (\r\n                    <HistoryPreviewMain\r\n                      previewType={charts.previewType}\r\n                      preview={preview}\r\n                      chart={chart}\r\n                      matchChart={matchChart.main}\r\n                    />\r\n                  )\r\n                  : null\r\n              }\r\n            </CollpaseZone>\r\n          )\r\n        })\r\n      }\r\n      {\r\n        charts[charts.alignField].map((chart: any, index: number) => {\r\n          const matchAlign: any = matchChart.align[index]\r\n          const matchSlider = { ...slider, yAxis: matchAlign && matchAlign.yAxis ? matchAlign.yAxis[0] : 0 }\r\n          return (\r\n            <CollpaseZone\r\n              key={`his-align__chart-${index}`}\r\n              showHandler={false}\r\n              visible={visible}\r\n              collapse={\r\n                <MatchChartOptions\r\n                  sliderDisabled\r\n                  chartType={charts.alignField}\r\n                  chart={chart}\r\n                  matchChart={matchAlign}\r\n                  slider={matchSlider}\r\n                />\r\n              }\r\n              zoneClass='border-top'\r\n              zoneRightClass='pd-t12'\r\n            >\r\n              <HistoryChartShow\r\n                sliderVisible={false}\r\n                slider={matchSlider}\r\n                chartData={chart}\r\n                chartOption={{ legend: { show: false }, yAxis: { name: '' }, title: { text: chart?.Name } }}\r\n                chartHeight={452}\r\n                seriesData={[{ fieldIndex: 3, chartOption: { progressive: 0 } }]}\r\n              />\r\n              {\r\n                preview\r\n                  ? (\r\n                    <HistoryPreviewAlign\r\n                      previewType={charts.previewType}\r\n                      preview={preview}\r\n                      chart={chart}\r\n                      matchChart={matchAlign}\r\n                    />\r\n                  )\r\n                  : null\r\n              }\r\n            </CollpaseZone>\r\n          )\r\n        })\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default DataPreviewHistory","import { useMemo } from 'react'\r\nimport { $consts } from 'src/plugins'\r\n\r\ntype Props = {\r\n  status: string | number,\r\n  className?: string,\r\n  style?: Object\r\n}\r\nconst PaperMachineStatus = (props: Props) => {\r\n  const backgroundColor = useMemo(() => {\r\n    switch (props.status) {\r\n      case $consts['PAPERMONITOR/MACHINE_OFFLINE']:\r\n        return '#ff4d4f'\r\n      case $consts['PAPERMONITOR/MACHINE_DISABLED']:\r\n        return '#c4c4c4'\r\n      default:\r\n        return '#52c41a'\r\n    }\r\n  }, [props.status])\r\n\r\n  return <div className={props.className} style={{ width: 20, height: 20, borderRadius: 10, ...props.style, backgroundColor }} />\r\n}\r\n\r\nexport default PaperMachineStatus","import { useState } from 'react'\r\nimport { useHistory } from 'react-router-dom'\r\nimport { Button, Switch } from 'antd'\r\nimport { UpOutlined } from '@ant-design/icons'\r\nimport { EnergyIcon } from 'src/components'\r\nimport { PaperMachineStatus } from '.'\r\nimport { commonStore } from 'src/stores'\r\nimport { $consts } from 'src/plugins'\r\n\r\ntype Props = {\r\n  orgId: string,\r\n  machine: any\r\n}\r\nconst PaperMonitorControl = (props: Props) => {\r\n  const [visible, setVisible] = useState(true)\r\n\r\n  const history = useHistory()\r\n  const handleNav = () => {\r\n    // 跳转去控制器监测页面\r\n    const find = commonStore.flatMenus.find((item: any) => item.Nav_MenuForm?.CODE === $consts['FORM/CODE_RTM003'])\r\n    find && history.push({\r\n      pathname: `/main/${find.ID}`,\r\n      search: `?OrgId=${props.orgId}`\r\n    })\r\n  }\r\n\r\n  const { CVList = [], MVList = [] } = props.machine\r\n  // fakes 用于布局补齐\r\n  const fakeCount = Math.ceil(MVList.length / 4) * 4 - MVList.length\r\n  const fakes = fakeCount > 0 ? new Array(fakeCount).fill(true) : []\r\n  return (\r\n    <div className='paper-monitor__control'>\r\n      {/** CVList */}\r\n      <div className='paper-monitor__control-header'>\r\n        {/** MD控制 */}\r\n        <div className='paper-monitor__control-zone disabled'>\r\n          <div className='display-flex flex-rowfsc'>\r\n            <div className='display-flex flex-1 flex-rowfsc'>\r\n              <PaperMachineStatus status={$consts['PAPERMONITOR/MACHINE_DISABLED']} />\r\n              <Button\r\n                disabled\r\n                size='small'\r\n                type='primary'\r\n                className='mg-l18 pd-l24 pd-r24'\r\n                style={{ borderRadius: 12 }}\r\n              >MD控制</Button>\r\n            </div>\r\n            <UpOutlined\r\n              onClick={() => setVisible(!visible)}\r\n              className={`fz-16 cursor-pointer ${visible ? 'expand' : 'collapse'}`}\r\n            />\r\n          </div>\r\n          <div className='mg-t8' style={{ display: visible ? 'block' : 'none' }}>\r\n            {/** 单位 */}\r\n            <div className='display-flex flex-rowfsc'>\r\n              <div className='display-flex flex-3'></div>\r\n              <div className='display-flex flex-2'>\r\n                <div className='flex-1 fz-14 text-center'>PV</div>\r\n                <div className='flex-1 fz-14 text-center'>SP</div>\r\n              </div>\r\n            </div>\r\n            {/** 具体项 */}\r\n            <div className='display-flex flex-rowfsc pd-t10 pd-b10 border-bottom'>\r\n              <div className='display-flex flex-3 flex-rowfsc'>\r\n                <EnergyIcon type='icon-zhongliang' size={28} />\r\n                <span className='fz-14 pd-l18'>克重 gsm</span>\r\n              </div>\r\n              <div className='display-flex flex-2'>\r\n                <div className='flex-1 fz-14 text-center'>163</div>\r\n                <div className='flex-1 fz-14 text-center'>52</div>\r\n              </div>\r\n            </div>\r\n            <div className='display-flex flex-rowfsc pd-t10'>\r\n              <div className='display-flex flex-3 flex-rowfsc'>\r\n                <EnergyIcon type='icon-shiyangshuifen' size={28} />\r\n                <span className='fz-14 pd-l18'>水分 %</span>\r\n              </div>\r\n              <div className='display-flex flex-2'>\r\n                <div className='flex-1 fz-14 text-center'>95</div>\r\n                <div className='flex-1 fz-14 text-center'>226</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        {/** CD控制 */}\r\n        <div className='paper-monitor__control-zone'>\r\n          <div className='display-flex flex-rowfsc'>\r\n            <div className='display-flex flex-1 flex-rowfsc'>\r\n              <PaperMachineStatus status={$consts['PAPERMONITOR/MACHINE_ONLINE']} />\r\n              <Button\r\n                size='small'\r\n                type='primary'\r\n                onClick={handleNav}\r\n                className='mg-l18 pd-l24 pd-r24'\r\n                style={{ borderRadius: 12 }}\r\n              >CD控制</Button>\r\n            </div>\r\n            <UpOutlined\r\n              onClick={() => setVisible(!visible)}\r\n              className={`fz-16 cursor-pointer ${visible ? 'expand' : 'collapse'}`}\r\n            />\r\n          </div>\r\n          <div className='mg-t8' style={{ display: visible ? 'block' : 'none' }}>\r\n            {/** 单位 */}\r\n            <div className='display-flex flex-rowfsc'>\r\n              <div className='display-flex flex-3'></div>\r\n              <div className='display-flex flex-2'>\r\n                <div className='flex-1 fz-14 text-center'></div>\r\n                <div className='flex-1 fz-14 text-center'>2σ</div>\r\n              </div>\r\n            </div>\r\n            {/** 具体项 */}\r\n            {\r\n              CVList.map((item: any, index: number) => {\r\n                const className = `display-flex flex-rowfsc pd-t10 ${index === 0 || index !== CVList.length - 1 ? 'pd-b10 border-bottom' : ''}`\r\n                return (\r\n                  <div key={`${item.Name}_${index}`} className={className}>\r\n                    <div className='display-flex flex-3 flex-rowfsc'>\r\n                      <EnergyIcon type={item.Icon} size={28} />\r\n                      <span className='fz-14 pd-l18'>{item.Name}</span>\r\n                    </div>\r\n                    <div className='display-flex flex-2'>\r\n                      <div className='flex-1 fz-14 text-center'></div>\r\n                      <div className='flex-1 fz-14 text-center'>{item.TowSigma}</div>\r\n                    </div>\r\n                  </div>\r\n                )\r\n              })\r\n            }\r\n          </div>\r\n        </div>\r\n        {/** 一键启停 */}\r\n        <div className='paper-monitor__control-zone disabled'>\r\n          <div className='display-flex flex-rowfsc'>\r\n            <div className='display-flex flex-1 flex-rowfsc'>\r\n              <PaperMachineStatus status={$consts['PAPERMONITOR/MACHINE_DISABLED']} />\r\n              <Button\r\n                disabled\r\n                size='small'\r\n                type='primary'\r\n                className='mg-l18 pd-l24 pd-r24'\r\n                style={{ borderRadius: 12 }}\r\n              >一键启停</Button>\r\n            </div>\r\n            <UpOutlined\r\n              onClick={() => setVisible(!visible)}\r\n              className={`fz-16 cursor-pointer ${visible ? 'expand' : 'collapse'}`}\r\n            />\r\n          </div>\r\n          <div className='mg-t8' style={{ display: visible ? 'block' : 'none' }}>\r\n            {/** 单位 */}\r\n            <div className='display-flex flex-rowfsc'>\r\n              <div className='display-flex flex-3'></div>\r\n              <div className='display-flex flex-2'>\r\n                <div className='flex-1 fz-14 text-center'></div>\r\n                <div className='flex-1 fz-14 text-center opacity-0'>opacity</div>\r\n              </div>\r\n            </div>\r\n            {/** 具体项 */}\r\n            <div className='display-flex flex-rowfsc pd-t10 pd-b10 border-bottom'>\r\n              <div className='display-flex flex-3 flex-rowfsc'>\r\n                <EnergyIcon type='icon-yijianqiting' size={28} />\r\n                <span className='fz-14 pd-l18'>一键启停</span>\r\n              </div>\r\n              <div className='display-flex flex-2'>\r\n                <div className='flex-1 fz-14 text-center'></div>\r\n                <div className='flex-1 fz-14 text-center'>\r\n                  <Switch disabled />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        {/** 智能改抄 */}\r\n        <div className='paper-monitor__control-zone disabled'>\r\n          <div className='display-flex flex-rowfsc'>\r\n            <div className='display-flex flex-1 flex-rowfsc'>\r\n              <PaperMachineStatus status={$consts['PAPERMONITOR/MACHINE_DISABLED']} />\r\n              <Button\r\n                disabled\r\n                size='small'\r\n                type='primary'\r\n                className='mg-l18 pd-l24 pd-r24'\r\n                style={{ borderRadius: 12 }}\r\n              >智能改抄</Button>\r\n            </div>\r\n            <UpOutlined\r\n              onClick={() => setVisible(!visible)}\r\n              className={`fz-16 cursor-pointer ${visible ? 'expand' : 'collapse'}`}\r\n            />\r\n          </div>\r\n          <div className='mg-t8' style={{ display: visible ? 'block' : 'none' }}>\r\n            {/** 单位 */}\r\n            <div className='display-flex flex-rowfsc'>\r\n              <div className='display-flex flex-3'></div>\r\n              <div className='display-flex flex-2'>\r\n                <div className='flex-1 fz-14 text-center'>SP</div>\r\n                <div className='flex-1 fz-14 text-center'>目标</div>\r\n              </div>\r\n            </div>\r\n            {/** 具体项 */}\r\n            <div className='display-flex flex-rowfsc pd-t10 pd-b10 border-bottom'>\r\n              <div className='display-flex flex-3 flex-rowfsc'>\r\n                <EnergyIcon type='icon-zhongliang' size={28} />\r\n                <span className='fz-14 pd-l18'>克重 gsm</span>\r\n              </div>\r\n              <div className='display-flex flex-2'>\r\n                <div className='flex-1 fz-14 text-center'>163</div>\r\n                <div className='flex-1 fz-14 text-center'>52</div>\r\n              </div>\r\n            </div>\r\n            <div className='display-flex flex-rowfsc pd-t10'>\r\n              <div className='display-flex flex-3 flex-rowfsc'>\r\n                <EnergyIcon type='icon-shiyangshuifen' size={28} />\r\n                <span className='fz-14 pd-l18'>水分 %</span>\r\n              </div>\r\n              <div className='display-flex flex-2'>\r\n                <div className='flex-1 fz-14 text-center'>95</div>\r\n                <div className='flex-1 fz-14 text-center'>226</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className='paper-monitor__control-img' style={{ backgroundImage: `url(${require('src/assets/custom/paper-company.svg').default})` }} />\r\n      {/** MVList */}\r\n      <div className='paper-monitor__control-mv'>\r\n        {\r\n          MVList.map((item: any, index: number) => {\r\n            const { Name, Icon, Values = [] } = item\r\n            return (\r\n              <div key={`${Name}_${index}`} className='paper-monitor__control-mvZone'>\r\n                <div className='display-flex flex-rowfsc mg-b8'>\r\n                  <EnergyIcon type={Icon} size={28} />\r\n                  <span className='fz-16 pd-l12'>{Name}</span>\r\n                </div>\r\n                {\r\n                  Values.map((v: any, vi: number) => {\r\n                    const className = `pd-t10 overflow-hidden ${vi === 0 || vi !== Values.length - 1 ? 'pd-b10 border-bottom' : ''}`\r\n                    return (\r\n                      <div key={`${v.Name}_${vi}`} className={className}>\r\n                        <span className='float-left fz-14'>{v.Name}</span>\r\n                        <span className='float-right fz-14'>{v.Value}</span>\r\n                      </div>\r\n                    )\r\n                  })\r\n                }\r\n              </div>\r\n            )\r\n          })\r\n        }\r\n        {\r\n          fakes.map((f: any, fi: number) => {\r\n            return <div key={`fake-mv_${fi}`} className='paper-monitor__control-mvZone opacity-0' />\r\n          })\r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default PaperMonitorControl","import { useState, useEffect, useMemo } from 'react'\r\nimport { Form, Select, Row, Col, Table } from 'antd'\r\nimport { TimeChartShow } from '.'\r\nimport { $api } from 'src/plugins'\r\n\r\nconst lineTypes = [\r\n  { label: '平均值', value: 'AvgValue' },\r\n  { label: '2σ', value: 'TwoSigma' }\r\n]\r\n\r\ntype Props = {\r\n  orgId: string,\r\n  // machine: any\r\n}\r\nconst PaperMonitorChart = (props: Props) => {\r\n  const [actuatorList, setActuatorList] = useState([])\r\n  const [actuator, setActuator] = useState('')\r\n  const [measureList, setMeasureList] = useState([])\r\n  const [measures, setMeasures] = useState<string[]>([])\r\n\r\n  useEffect(() => {\r\n    $api['home/getActuatorsByMachine']({\r\n      OrgId: props.orgId\r\n    }).then((res: any) => {\r\n      res && setActuatorList(res)\r\n    })\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    const { Id, CVList = [] } = actuatorList[0] || {}\r\n    setActuator(Id)\r\n    setMeasureList(CVList)\r\n    setMeasures(CVList.map((item: any) => item.Id))\r\n  }, [actuatorList])\r\n\r\n  const handleActuatorChange = (val: string) => {\r\n    const find: any = actuatorList.find((item: any) => item.Id === val)\r\n    const { Id, CVList = [] } = find\r\n    setActuator(Id)\r\n    setMeasureList(CVList)\r\n    setMeasures(CVList.map((item: any) => item.Id))\r\n  }\r\n\r\n  const [chartData, setChartData] = useState<any>([])\r\n  useEffect(() => {\r\n    if (!actuator) return\r\n\r\n    $api['home/getMachineCurveData']({\r\n      ActuatorId: actuator,\r\n      MeasuringObjectIds: measures\r\n    }).then((res: any) => {\r\n      res && setChartData(res)\r\n    })\r\n  }, [actuator, measures])\r\n\r\n  const [lineType, setLineType] = useState('AvgValue')\r\n\r\n  const [slider, setSlider] = useState('')\r\n\r\n  const series = useMemo(() => {\r\n    return chartData.map((item: any) => {\r\n      return {\r\n        field: item.Id,\r\n        chartOption: {\r\n          lineOption: {\r\n            name: item.Name\r\n          }\r\n        }\r\n      }\r\n    })\r\n  }, [chartData])\r\n\r\n  const targetData = useMemo(() => {\r\n    const data = chartData[0]?.Data?.map((item: any) => ({ Time: item.Time })) || []\r\n    data.forEach((item: any) => {\r\n      series.forEach((se: any) => {\r\n        const matchChart = chartData.find((chart: any) => chart.Id === se.field)\r\n        const matchData = matchChart.Data.find((d: any) => d.Time === item.Time)\r\n        item[se.field] = matchData[lineType]\r\n      })\r\n    })\r\n    return {\r\n      Data: data\r\n    }\r\n  }, [series, chartData, lineType])\r\n\r\n  const tableData = useMemo(() => {\r\n    const columns = [\r\n      { title: '序号', dataIndex: 'No' },\r\n      { title: '名称', dataIndex: 'Name' },\r\n      { title: '状态', dataIndex: 'Value' },\r\n      { title: '单位', dataIndex: 'Unit' },\r\n    ]\r\n    const dataSource: any = []\r\n    measures.forEach((item: string, index: number) => {\r\n      const matchChart = chartData.find((chart: any) => chart.Id === item)\r\n      const matchData = matchChart?.Data?.find((d: any) => d.Time === slider)\r\n      dataSource.push({\r\n        No: index + 1,\r\n        Name: matchChart?.Name,\r\n        Value: matchData?.[lineType],\r\n        Unit: matchChart?.Unit\r\n      })\r\n    })\r\n    return { columns, dataSource }\r\n  }, [slider, measures, chartData, lineType])\r\n  console.log('tableData', tableData)\r\n\r\n  return (\r\n    <div className='paper-monitor__chart'>\r\n      <Form\r\n        layout='horizontal'\r\n        labelCol={{ span: 6 }}\r\n        wrapperCol={{ span: 18 }}\r\n        className='mg-b18'\r\n      >\r\n        <Row gutter={24}>\r\n          <Col span={8}>\r\n            <Form.Item label='执行器'>\r\n              <Select\r\n                fieldNames={{ label: 'Name', value: 'Id' }}\r\n                options={actuatorList}\r\n                value={actuator}\r\n                onChange={handleActuatorChange}\r\n                style={{ width: '100%' }}\r\n              />\r\n            </Form.Item>\r\n          </Col>\r\n          <Col span={8}>\r\n            <Form.Item label='测量对象'>\r\n              <Select\r\n                mode='multiple'\r\n                fieldNames={{ label: 'Name', value: 'Id' }}\r\n                options={measureList}\r\n                value={measures}\r\n                onChange={setMeasures}\r\n                style={{ width: '100%' }}\r\n              />\r\n            </Form.Item>\r\n          </Col>\r\n          <Col span={8}>\r\n            <Form.Item label='曲线类别'>\r\n              <Select\r\n                options={lineTypes}\r\n                value={lineType}\r\n                onChange={setLineType}\r\n                style={{ width: '100%' }}\r\n              />\r\n            </Form.Item>\r\n          </Col>\r\n        </Row>\r\n      </Form>\r\n      <TimeChartShow\r\n        slider={slider}\r\n        sliderPosition='bottom'\r\n        chartData={targetData}\r\n        chartHeight={260}\r\n        seriesData={series}\r\n        onChange={setSlider}\r\n      />\r\n      <Table\r\n        pagination={false}\r\n        columns={tableData.columns}\r\n        dataSource={tableData.dataSource}\r\n        className='mg-t18'\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default PaperMonitorChart","import { useState, useEffect, useMemo } from 'react'\r\nimport { Form, InputNumber } from 'antd'\r\nimport { CollpaseZone } from 'src/components'\r\nimport { CDChartShow } from '.'\r\nimport { $api, $consts, $evt } from 'src/plugins'\r\nimport { cloneDeep } from 'lodash'\r\n\r\ninterface Props {\r\n  filter: any,\r\n  controlId: string | number\r\n}\r\nconst RealTimeAct = (props: Props) => {\r\n  // 总的图表数据\r\n  const [charts, setCharts] = useState<any>({ actChart: {}, measureCharts: [] })\r\n  const getCharts = () => {\r\n    if (props.filter) {\r\n      const { ActuatorId, MeasuringObjectId } = props.filter\r\n      const funcs = []\r\n      ActuatorId.length ? funcs.push(\r\n        $api['datapreview/getActuatorRealTimeData']({\r\n          ControllerId: props.controlId,\r\n          ActuatorId: ActuatorId[0]\r\n        })\r\n      ) : funcs.push(Promise.resolve({}))\r\n      MeasuringObjectId.length ? funcs.push(\r\n        $api['datapreview/getRealTimeDataByMV']({\r\n          ControllerId: props.controlId,\r\n          ActuatorId: ActuatorId[0],\r\n          MeasuringObjectIds: MeasuringObjectId\r\n        })\r\n      ) : funcs.push(Promise.resolve([]))\r\n      Promise.all(funcs).then((datas: any[]) => {\r\n        const [actChart = {}, measureCharts = []] = datas\r\n        setCharts({ actChart, measureCharts })\r\n      })\r\n    }\r\n  }\r\n  useEffect(() => {\r\n    getCharts()\r\n  }, [props.controlId, props.filter])\r\n\r\n  // 取位号数最大的测量对象图表作为被对齐图表\r\n  const measureAlignChart = useMemo(() => {\r\n    const { measureCharts } = charts\r\n    if (!measureCharts.length) return {}\r\n    let alignChart = measureCharts[0]\r\n    for (let i = 1, j = measureCharts.length; i < j; i++) {\r\n      const { PositionNumbers } = measureCharts[i]\r\n      if (PositionNumbers.length > alignChart.PositionNumbers.length) {\r\n        alignChart = measureCharts[i]\r\n      }\r\n    }\r\n    return alignChart\r\n  }, [charts])\r\n\r\n  // 执行器图表对齐数据\r\n  const actAlignChart = useMemo(() => {\r\n    const { actChart } = cloneDeep(charts)\r\n    const { PositionNumbers: actPoints = [] } = actChart\r\n    const { PositionNumbers: meaPoints = [] } = measureAlignChart\r\n    meaPoints.forEach((point: any) => {\r\n      const find = actPoints.find((act: any) => act.PositionNumber === point.AlignPositionNumber)\r\n      find && (find.AlignPositionNumber = point.PositionNumber)\r\n    })\r\n    return actChart\r\n  }, [charts, measureAlignChart])\r\n\r\n  // Slider 对应图表数据\r\n  const [slider, setSlider] = useState(0)\r\n  const [matchActChart, setMatchChartData] = useState<any>()\r\n  const matchMeasureCharts = useMemo(() => {\r\n    const matchCharts: any = []\r\n    charts.measureCharts.forEach((chart: any) => {\r\n      const { PositionNumbers = [] } = chart\r\n      const find = PositionNumbers.find((item: any) => item.AlignPositionNumber === matchActChart?.PositionNumber)\r\n      matchCharts.push(find)\r\n    })\r\n    return matchCharts\r\n  }, [charts, matchActChart])\r\n\r\n  // 将与执行器对齐的测量对象图表变更为与 measureAlignChart 对齐\r\n  const getAlignChart = (chart: any) => {\r\n    const { PositionNumbers: chartPoints = [] } = chart\r\n    const { PositionNumbers: actPoints = [] } = actAlignChart\r\n    chartPoints.forEach((point: any) => {\r\n      const actFind = actPoints.find((act: any) => point.AlignPositionNumber === act.PositionNumber)\r\n      if (!actFind) return\r\n      point.AlignPositionNumber = actFind.AlignPositionNumber\r\n    })\r\n    return chart\r\n  }\r\n\r\n  // 监听快照事件\r\n  useEffect(() => {\r\n    $evt.addListener($consts['DATAPREVIEW/EVT_SNAPSHOT'], getCharts)\r\n\r\n    return () => {\r\n      $evt.removeListener($consts['DATAPREVIEW/EVT_SNAPSHOT'], getCharts)\r\n    }\r\n  }, [props.controlId, props.filter])\r\n\r\n  // options 展开收起\r\n  const [visible, setVisible] = useState(false)\r\n\r\n  // 测量对象图表 series 数据\r\n  const measureSeries = [\r\n    {\r\n      field: 'PVValue',\r\n      chartOption: {\r\n        lineOption: {\r\n          name: '当前值',\r\n        }\r\n      }\r\n    }\r\n  ]\r\n\r\n  // 测量对象图表配置\r\n  const getMeasureChart = (chartData: any) => {\r\n    const { PositionNumbers = [] } = chartData\r\n    const PVValues = PositionNumbers.map((item: any) => item.PVValue).filter((item: number) => item)\r\n    const max = Math.max(...PVValues)\r\n    const min = Math.min(...PVValues)\r\n    return {\r\n      legend: { show: false },\r\n      yAxis: { name: '' },\r\n      dataZoom: [\r\n        {\r\n          type: 'slider',\r\n          right: 10,\r\n          width: 18,\r\n          yAxisIndex: 0,\r\n          filterMode: 'none',\r\n          startValue: min || 0,\r\n          endValue: max || undefined\r\n        },\r\n        {\r\n          type: 'inside',\r\n          yAxisIndex: 0,\r\n          filterMode: 'none'\r\n        }\r\n      ]\r\n    }\r\n  }\r\n\r\n  // 执行器图表 series 数据\r\n  const actSeries = useMemo(() => {\r\n    const { PositionNumbers = [] } = actAlignChart\r\n    const barMaxWidth = 13 - Math.floor(PositionNumbers.length / 50) * 2\r\n    return [\r\n      {\r\n        field: 'SPValue',\r\n        chartOption: {\r\n          barOption: {\r\n            name: '当前值SP',\r\n            barMaxWidth\r\n          }\r\n        }\r\n      },\r\n      {\r\n        field: 'PVValue',\r\n        zeroToUndefined: true, // 0 值不画\r\n        chartOption: {\r\n          legend: { data: [{ icon: 'circle' }] },\r\n          lineOption: {\r\n            name: '当前值PV',\r\n            symbol: 'circle',\r\n            symbolSize: 6,\r\n            lineStyle: { opacity: 0 },\r\n            areaStyle: { color: 'rgba(0,0,0,0)' }\r\n          },\r\n        }\r\n      },\r\n      {\r\n        field: 'SnapSPValue',\r\n        chartOption: {\r\n          legend: { data: [{ icon: 'path://M0 0 H150 V12 H0 Z' }] },\r\n          lineOption: {\r\n            name: '快照SP',\r\n            areaStyle: { color: 'rgba(0,0,0,0)' }\r\n          },\r\n        }\r\n      }\r\n    ]\r\n  }, [actAlignChart])\r\n\r\n  // 执行器图表配置\r\n  const actChart = useMemo(() => {\r\n    const { PositionNumbers = [] } = actAlignChart\r\n    const maxInterval = Math.ceil(PositionNumbers.length / 50)\r\n    return {\r\n      title: { show: false },\r\n      xAxis: { maxInterval, axisTick: { show: false } }\r\n    }\r\n  }, [actAlignChart])\r\n\r\n  return (\r\n    <div className='pd-b36'>\r\n      <CollpaseZone\r\n        collapse={\r\n          <Form layout='horizontal' labelCol={{ span: 10 }} wrapperCol={{ span: 14 }}>\r\n            <Form.Item label='位号'>\r\n              <InputNumber\r\n                value={slider}\r\n                onChange={setSlider}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='当前SP'>\r\n              <InputNumber\r\n                disabled\r\n                value={matchActChart?.SPValue}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='当前PV'>\r\n              <InputNumber\r\n                disabled\r\n                value={matchActChart?.PVValue}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n            {\r\n              charts.measureCharts.map((chart: any, index: number) => {\r\n                const matchChart = matchMeasureCharts[index]\r\n                return (\r\n                  <Form.Item key={`act-realtime__form-${index}`} label={`对齐Y${index + 1}`}>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={matchChart?.AlignValue}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                )\r\n              })\r\n            }\r\n            <Form.Item label='2σ'>\r\n              <InputNumber\r\n                disabled\r\n                value={charts.actChart.TwoSigma}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='UMax'>\r\n              <InputNumber\r\n                disabled\r\n                value={charts.actChart.UMax}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='UMin'>\r\n              <InputNumber\r\n                disabled\r\n                value={charts.actChart.UMin}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='U平均'>\r\n              <InputNumber\r\n                disabled\r\n                value={charts.actChart.UAvg}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='坐标上界'>\r\n              <InputNumber\r\n                disabled\r\n                value={charts.actChart.CoordinateMax}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='坐标下界'>\r\n              <InputNumber\r\n                disabled\r\n                value={charts.actChart.CoordinateMin}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n          </Form>\r\n        }\r\n        onChange={setVisible}\r\n      >\r\n        <CDChartShow\r\n          slider={slider}\r\n          chartData={actAlignChart}\r\n          alignChartData={measureAlignChart}\r\n          chartOption={actChart}\r\n          chartHeight={340 + charts.measureCharts.length * 40}\r\n          seriesData={actSeries}\r\n          onChange={setSlider}\r\n          onChartChange={setMatchChartData}\r\n        />\r\n      </CollpaseZone>\r\n      {\r\n        charts.measureCharts.map((chart: any, index: number) => {\r\n          const matchChart = matchMeasureCharts[index]\r\n          const chartData = chart !== measureAlignChart ? getAlignChart(cloneDeep(chart)) : chart\r\n          const alignChartData = chart !== measureAlignChart ? measureAlignChart : undefined\r\n          const baseOption: any = {\r\n            title: { text: `Y${index + 1}：${chart.Name}` }\r\n          }\r\n          !alignChartData && (baseOption.xAxis = { axisLabel: { showMinLabel: true, showMaxLabel: true } })\r\n          const chartOption = Object.assign(baseOption, getMeasureChart(chartData))\r\n          return (\r\n            <CollpaseZone\r\n              key={`act-realtime__chart-${index}`}\r\n              showHandler={false}\r\n              visible={visible}\r\n              collapse={\r\n                <Form layout='horizontal' labelCol={{ span: 10 }} wrapperCol={{ span: 14 }}>\r\n                  <Form.Item label='对齐位号'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={matchChart?.PositionNumber}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                  <Form.Item label='当前值'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={matchChart?.PVValue}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                  <Form.Item label='2σ'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={chart.TwoSigma}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                  <Form.Item label='YMax'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={chart.YMax}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                  <Form.Item label='YMin'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={chart.YMin}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                  <Form.Item label='Y平均'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={chart.YAvg}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                  <Form.Item label='坐标上界'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={chart.CoordinateMax}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                  <Form.Item label='坐标下界'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={chart.CoordinateMin}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                </Form>\r\n              }\r\n              zoneClass='border-top'\r\n              zoneRightClass='pd-t12'\r\n            >\r\n              <CDChartShow\r\n                slider={matchChart?.PositionNumber}\r\n                sliderVisible={false}\r\n                chartData={chartData}\r\n                alignChartData={alignChartData}\r\n                chartOption={chartOption}\r\n                chartHeight={330}\r\n                seriesData={measureSeries}\r\n              />\r\n            </CollpaseZone>\r\n          )\r\n        })\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default RealTimeAct","export const dashLine_bcbcbc = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjQwNzY5OTA2MjYwIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEzMjY1IiB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTE1OC43MiA1NDcuODRIMjUuNmMtNS42MzIgMC0xMC4yNC00LjYwOC0xMC4yNC0xMC4yNFY0ODEuMjhjMC01LjYzMiA0LjYwOC0xMC4yNCAxMC4yNC0xMC4yNGgxMzMuMTJjNS42MzIgMCAxMC4yNCA0LjYwOCAxMC4yNCAxMC4yNHY1Ni4zMmMwIDUuNjMyLTQuNjA4IDEwLjI0LTEwLjI0IDEwLjI0ek00NDAuMzIgNTQ3Ljg0SDMwNy4yYy01LjYzMiAwLTEwLjI0LTQuNjA4LTEwLjI0LTEwLjI0VjQ4MS4yOGMwLTUuNjMyIDQuNjA4LTEwLjI0IDEwLjI0LTEwLjI0aDEzMy4xMmM1LjYzMiAwIDEwLjI0IDQuNjA4IDEwLjI0IDEwLjI0djU2LjMyYzAgNS42MzItNC42MDggMTAuMjQtMTAuMjQgMTAuMjR6TTcyMS45MiA1NDcuODRoLTEzMy4xMmMtNS42MzIgMC0xMC4yNC00LjYwOC0xMC4yNC0xMC4yNFY0ODEuMjhjMC01LjYzMiA0LjYwOC0xMC4yNCAxMC4yNC0xMC4yNGgxMzMuMTJjNS42MzIgMCAxMC4yNCA0LjYwOCAxMC4yNCAxMC4yNHY1Ni4zMmMwIDUuNjMyLTQuNjA4IDEwLjI0LTEwLjI0IDEwLjI0ek0xMDAzLjUyIDU0Ny44NGgtMTMzLjEyYy01LjYzMiAwLTEwLjI0LTQuNjA4LTEwLjI0LTEwLjI0VjQ4MS4yOGMwLTUuNjMyIDQuNjA4LTEwLjI0IDEwLjI0LTEwLjI0aDEzMy4xMmM1LjYzMiAwIDEwLjI0IDQuNjA4IDEwLjI0IDEwLjI0djU2LjMyYzAgNS42MzItNC42MDggMTAuMjQtMTAuMjQgMTAuMjR6IiBwLWlkPSIxMzI2NiIgZmlsbD0iI2JjYmNiYyI+PC9wYXRoPjwvc3ZnPg=='\r\nexport const ffc355And5bb86d = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAYCAYAAAC8/X7cAAAAsUlEQVRYhe3XsYkCQRiG4cfBzENsQmzBWOQKMLUGc8FcLMTYWMQCLEG4Bi481ALklw3MTFbnBuYpYPZ7l0mmM98vYIgNpuhr0bb32+Zx4YIjlvjpYoQTBm1/6U3iB88wwThhXdD4Z7F5nZprU6rv1Pad/7CvVPD4hxqQWw3IrQbkVgNyqwG51YDcakBuqXljluqWmgdyqQ4RsMJfgQGxeRUB53jdY4frPxj2SmyMrWOc74F/FoZed58lAAAAAElFTkSuQmCC'","import { useState, useEffect, useMemo } from 'react'\r\nimport { Form, InputNumber } from 'antd'\r\nimport { CollpaseZone } from 'src/components'\r\nimport { CDChartShow } from '.'\r\nimport { $api, $consts, $evt } from 'src/plugins'\r\nimport { dashLine_bcbcbc } from 'src/assets/base64'\r\n\r\ninterface Props {\r\n  filter: any,\r\n  controlId: string | number\r\n}\r\nconst RealTimeMea = (props: Props) => {\r\n  // 总的图表数据\r\n  const [charts, setCharts] = useState<any>({ actCharts: [], measureChart: {} })\r\n  const getCharts = () => {\r\n    if (props.filter) {\r\n      const { ActuatorId, MeasuringObjectId } = props.filter\r\n      const funcs = []\r\n      ActuatorId.length ? funcs.push(\r\n        $api['datapreview/getRealTimeDataByCV']({\r\n          ControllerId: props.controlId,\r\n          MeasuringObjectId: MeasuringObjectId[0],\r\n          ActuatorIds: ActuatorId\r\n        })\r\n      ) : funcs.push(Promise.resolve([]))\r\n      MeasuringObjectId.length ? funcs.push(\r\n        $api['datapreview/getMeasuringObjectRealTimeData']({\r\n          ControllerId: props.controlId,\r\n          MeasuringObjectId: MeasuringObjectId[0]\r\n        })\r\n      ) : funcs.push(Promise.resolve({}))\r\n      Promise.all(funcs).then((datas: any[]) => {\r\n        const [actCharts = [], measureChart = {}] = datas\r\n        setCharts({ actCharts, measureChart })\r\n      })\r\n    }\r\n  }\r\n  useEffect(() => {\r\n    getCharts()\r\n  }, [props.controlId, props.filter])\r\n\r\n  // Slider 对应图表数据\r\n  const [slider, setSlider] = useState(0)\r\n  const [matchMeaChart, setMatchChartData] = useState<any>()\r\n  const matchActCharts = useMemo(() => {\r\n    const matchCharts: any = []\r\n    charts.actCharts.forEach((chart: any) => {\r\n      const { PositionNumbers = [] } = chart\r\n      const find = PositionNumbers.find((item: any) => item.AlignPositionNumber === matchMeaChart?.PositionNumber)\r\n      matchCharts.push(find)\r\n    })\r\n    return matchCharts\r\n  }, [charts, matchMeaChart])\r\n\r\n  // 监听快照事件\r\n  useEffect(() => {\r\n    $evt.addListener($consts['DATAPREVIEW/EVT_SNAPSHOT'], getCharts)\r\n\r\n    return () => {\r\n      $evt.removeListener($consts['DATAPREVIEW/EVT_SNAPSHOT'], getCharts)\r\n    }\r\n  }, [props.controlId, props.filter])\r\n\r\n  // options 展开收起\r\n  const [visible, setVisible] = useState(false)\r\n\r\n  // 测量对象图表 series 数据\r\n  const measureSeries = [\r\n    {\r\n      field: 'PVValue',\r\n      chartOption: {\r\n        legend: { data: [{ icon: 'path://M0 0 H150 V12 H0 Z' }] },\r\n        lineOption: {\r\n          name: '当前值',\r\n        }\r\n      }\r\n    },\r\n    {\r\n      field: 'SnapPVValue',\r\n      chartOption: {\r\n        legend: { data: [{ icon: 'path://M0 0 H150 V12 H0 Z' }] },\r\n        lineOption: {\r\n          name: '快照值',\r\n        }\r\n      }\r\n    },\r\n    {\r\n      field: 'SPValue',\r\n      chartOption: {\r\n        legend: { data: [{ icon: `image://${dashLine_bcbcbc}` }] },\r\n        lineOption: {\r\n          name: '目标值',\r\n          lineStyle: { type: 'dashed', color: '#bcbcbc' },\r\n          areaStyle: { color: 'rgba(0,0,0,0)' }\r\n        }\r\n      }\r\n    }\r\n  ]\r\n\r\n  // 测量对象图表配置\r\n  const measureChart = useMemo(() => {\r\n    const { PositionNumbers = [] } = charts.measureChart\r\n    const PVValues = PositionNumbers.map((item: any) => item.PVValue).filter((item: number) => item)\r\n    const max = Math.max(...PVValues)\r\n    const min = Math.min(...PVValues)\r\n    return {\r\n      title: { top: 40 },\r\n      grid: { top: 60 },\r\n      xAxis: { axisLabel: { showMinLabel: true, showMaxLabel: true } },\r\n      dataZoom: [\r\n        {\r\n          type: 'slider',\r\n          right: 10,\r\n          width: 18,\r\n          yAxisIndex: 0,\r\n          filterMode: 'none',\r\n          startValue: min || 0,\r\n          endValue: max || undefined\r\n        },\r\n        {\r\n          type: 'inside',\r\n          yAxisIndex: 0,\r\n          filterMode: 'none'\r\n        }\r\n      ]\r\n    }\r\n  }, [charts.measureChart])\r\n\r\n  // 执行器图表 series 数据\r\n  const getActSeries = (chartData: any) => {\r\n    const { PositionNumbers = [] } = chartData\r\n    const barMaxWidth = 13 - Math.floor(PositionNumbers.length / 50) * 2\r\n    return [\r\n      {\r\n        field: 'SPValue',\r\n        chartOption: {\r\n          barOption: {\r\n            name: '当前值SP',\r\n            barMaxWidth\r\n          }\r\n        }\r\n      }\r\n    ]\r\n  }\r\n\r\n  // 执行器图表配置\r\n  const getActChart = (chartData: any) => {\r\n    const { PositionNumbers = [] } = chartData\r\n    const maxInterval = Math.ceil(PositionNumbers.length / 50)\r\n    return {\r\n      legend: { show: false },\r\n      xAxis: { maxInterval, axisTick: { show: false } },\r\n      yAxis: { name: '' }\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className='pd-b36'>\r\n      <CollpaseZone\r\n        collapse={\r\n          <Form layout='horizontal' labelCol={{ span: 10 }} wrapperCol={{ span: 14 }}>\r\n            <Form.Item label='位号'>\r\n              <InputNumber\r\n                value={slider}\r\n                onChange={setSlider}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='当前值'>\r\n              <InputNumber\r\n                disabled\r\n                value={matchMeaChart?.PVValue}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='目标值'>\r\n              <InputNumber\r\n                disabled\r\n                value={matchMeaChart?.SPValue}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='2σ'>\r\n              <InputNumber\r\n                disabled\r\n                value={charts.measureChart.TwoSigma}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='YMax'>\r\n              <InputNumber\r\n                disabled\r\n                value={charts.measureChart.YMax}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='YMin'>\r\n              <InputNumber\r\n                disabled\r\n                value={charts.measureChart.YMin}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='Y平均'>\r\n              <InputNumber\r\n                disabled\r\n                value={charts.measureChart.YAvg}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='坐标上界'>\r\n              <InputNumber\r\n                disabled\r\n                value={charts.measureChart.CoordinateMax}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='坐标下界'>\r\n              <InputNumber\r\n                disabled\r\n                value={charts.measureChart.CoordinateMin}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n          </Form>\r\n        }\r\n        onChange={setVisible}\r\n      >\r\n        <CDChartShow\r\n          timeVisible\r\n          slider={slider}\r\n          chartData={charts.measureChart}\r\n          chartOption={measureChart}\r\n          chartHeight={340}\r\n          seriesData={measureSeries}\r\n          onChange={setSlider}\r\n          onChartChange={setMatchChartData}\r\n        />\r\n      </CollpaseZone>\r\n      {\r\n        charts.actCharts.map((chart: any, index: number) => {\r\n          const matchChart = matchActCharts[index]\r\n          const chartOption = getActChart(chart)\r\n          const chartSeries = getActSeries(chart)\r\n          return (\r\n            <CollpaseZone\r\n              key={`mea-realtime__chart-${index}`}\r\n              showHandler={false}\r\n              visible={visible}\r\n              collapse={\r\n                <Form layout='horizontal' labelCol={{ span: 10 }} wrapperCol={{ span: 14 }}>\r\n                  <Form.Item label='对齐位号'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={matchChart?.PositionNumber}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                  <Form.Item label='当前SP'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={matchChart?.SPValue}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                  <Form.Item label='当前PV'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={matchChart?.PVValue}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                  <Form.Item label='2σ'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={chart.TwoSigma}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                  <Form.Item label='UMax'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={chart.UMax}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                  <Form.Item label='UMin'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={chart.UMin}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                  <Form.Item label='U平均'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={chart.UAvg}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                  <Form.Item label='坐标上界'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={chart.CoordinateMax}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                  <Form.Item label='坐标下界'>\r\n                    <InputNumber\r\n                      disabled\r\n                      value={chart.CoordinateMin}\r\n                      className='data-preview__form-input'\r\n                    />\r\n                  </Form.Item>\r\n                </Form>\r\n              }\r\n              zoneClass='border-top'\r\n              zoneRightClass='pd-t12'\r\n            >\r\n              <CDChartShow\r\n                slider={matchChart?.PositionNumber}\r\n                sliderVisible={false}\r\n                chartData={chart}\r\n                alignChartData={charts.measureChart}\r\n                chartOption={Object.assign(chartOption, { title: { text: chart.Name } })}\r\n                chartHeight={330}\r\n                seriesData={chartSeries}\r\n                onAlignChange={setSlider}\r\n              />\r\n            </CollpaseZone>\r\n          )\r\n        })\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default RealTimeMea","import { useMemo } from 'react'\r\nimport { Form, Input, InputNumber } from 'antd'\r\nimport { CollpaseZone } from 'src/components'\r\nimport { CDChartShow, TimeChartShow } from '.'\r\nimport { $consts } from 'src/plugins'\r\nimport { omit, cloneDeep } from 'lodash'\r\n\r\ninterface CMDProps {\r\n  previewType: string,\r\n  chart: any,\r\n  matchChart: any\r\n}\r\n// 主图 MD 预览：执行器和测量对象当前位号在所选时间段内的详细图表\r\nconst MainMDPreview = (props: CMDProps) => {\r\n  const mainChart = useMemo(() => {\r\n    const { previewType, chart, matchChart } = props\r\n    const { xAxis = {}, yAxis = [] } = matchChart\r\n\r\n    const chartData = cloneDeep(chart)\r\n    chartData.Data.forEach((item: any) => {\r\n      const target = item.P.find((p: any) => p[0] === yAxis[0])\r\n      item.Time = item.T\r\n      item.Value = target ? (previewType === $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR'] ? target[2] : target[3]) : 0\r\n    })\r\n    const target = {\r\n      xAxis,\r\n      yAxis,\r\n      chartData,\r\n      series: [\r\n        {\r\n          field: 'Value',\r\n          chartOption: {\r\n            lineOption: {\r\n              name: '当前值'\r\n            }\r\n          }\r\n        }\r\n      ],\r\n      option: {\r\n        title: { text: chartData.Name },\r\n        legend: { show: false },\r\n        yAxis: { name: '' },\r\n      }\r\n    }\r\n\r\n    if (previewType === $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR']) {\r\n      return {\r\n        ...target,\r\n        maxText: 'UMax',\r\n        minText: 'UMin'\r\n      }\r\n    }\r\n    return {\r\n      ...target,\r\n      maxText: 'YMax',\r\n      minText: 'YMin'\r\n    }\r\n  }, [props.previewType, props.chart, props.matchChart])\r\n\r\n  return (\r\n    <CollpaseZone\r\n      collapse={\r\n        <Form layout='horizontal' labelCol={{ span: 10 }} wrapperCol={{ span: 14 }}>\r\n          <Form.Item label='位号'>\r\n            <Input\r\n              disabled\r\n              value={mainChart.yAxis[0]}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label='SP'>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.yAxis[2]}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label='PV'>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.yAxis[3]}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label={mainChart.maxText}>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.xAxis.A}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label={mainChart?.minText}>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.xAxis.I}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label='坐标上界'>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.chartData.CoordinateMax}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label='坐标下界'>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.chartData.CoordinateMin}\r\n              className='data-preview__form-input'\r\n            />\r\n          </Form.Item>\r\n        </Form>\r\n      }\r\n      zoneRightClass='pd-t12'\r\n    >\r\n      <TimeChartShow\r\n        sliderVisible={false}\r\n        chartData={mainChart.chartData}\r\n        chartOption={mainChart.option}\r\n        chartHeight={444}\r\n        seriesData={mainChart.series}\r\n      />\r\n    </CollpaseZone>\r\n  )\r\n}\r\n\r\n// 主图 CD 预览：执行器和测量对象所有位号在当前时间的详细图表\r\nconst MainCDPreview = (props: CMDProps) => {\r\n  const mainChart = useMemo(() => {\r\n    const { previewType, chart, matchChart } = props\r\n    const { xAxis = {}, yAxis = [] } = matchChart\r\n\r\n    const chartData: any = omit(chart, ['Data'])\r\n    chartData.PositionNumbers = xAxis.P?.map((p: any) => {\r\n      return {\r\n        PositionNumber: p[0],\r\n        SPValue: p[2],\r\n        PVValue: p[3]\r\n      }\r\n    }) || []\r\n\r\n    const target = {\r\n      xAxis,\r\n      yAxis,\r\n      chartData\r\n    }\r\n\r\n    if (previewType === $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR']) {\r\n      return {\r\n        ...target,\r\n        series: [\r\n          {\r\n            field: 'SPValue',\r\n            chartOption: {\r\n              barOption: {\r\n                name: 'SP值'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'PVValue',\r\n            chartOption: {\r\n              legend: { data: [{ icon: 'circle' }] },\r\n              lineOption: {\r\n                name: 'PV值',\r\n                symbol: 'circle',\r\n                symbolSize: 6,\r\n                areaStyle: { color: 'rgba(0,0,0,0)' }\r\n              },\r\n            }\r\n          },\r\n        ],\r\n        option: {\r\n          title: { text: chartData.Name },\r\n          legend: { show: false },\r\n          xAxis: { maxInterval: 1, axisTick: { show: false } },\r\n          yAxis: { name: '' }\r\n        },\r\n        maxText: 'UMax',\r\n        minText: 'UMin'\r\n      }\r\n    }\r\n\r\n    return {\r\n      ...target,\r\n      series: [\r\n        {\r\n          field: 'PVValue',\r\n          chartOption: {\r\n            lineOption: {\r\n              name: 'PV值'\r\n            }\r\n          }\r\n        }\r\n      ],\r\n      option: {\r\n        title: { text: chartData.Name },\r\n        legend: { show: false },\r\n        yAxis: { name: '' }\r\n      },\r\n      maxText: 'YMax',\r\n      minText: 'YMin'\r\n    }\r\n  }, [props.previewType, props.chart, props.matchChart])\r\n\r\n  return (\r\n    <CollpaseZone\r\n      collapse={\r\n        <Form layout='horizontal' labelCol={{ span: 10 }} wrapperCol={{ span: 14 }}>\r\n          <Form.Item label='当前时间'>\r\n            <Input\r\n              disabled\r\n              value={mainChart.xAxis.T}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label='SP'>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.yAxis[2]}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label='PV'>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.yAxis[3]}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label={mainChart.maxText}>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.xAxis.A}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label={mainChart?.minText}>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.xAxis.I}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label='坐标上界'>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.chartData.CoordinateMax}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label='坐标下界'>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.chartData.CoordinateMin}\r\n              className='data-preview__form-input'\r\n            />\r\n          </Form.Item>\r\n        </Form>\r\n      }\r\n      zoneRightClass='pd-t12'\r\n    >\r\n      <CDChartShow\r\n        sliderVisible={false}\r\n        chartData={mainChart.chartData}\r\n        chartOption={mainChart.option}\r\n        chartHeight={444}\r\n        seriesData={mainChart.series}\r\n      />\r\n    </CollpaseZone>\r\n  )\r\n}\r\n\r\ninterface Props extends CMDProps {\r\n  preview: string\r\n}\r\n// 主图预览 执行器/测量对象\r\nconst HistoryPreviewMain = (props: Props) => {\r\n  const { previewType, preview, chart, matchChart } = props\r\n  return (\r\n    <div className='data-preview__chart-preview'>\r\n      {\r\n        preview === $consts['DATAPREVIEW/PREVIEW_TYPE_CD']\r\n          ? <MainCDPreview previewType={previewType} chart={chart} matchChart={matchChart} />\r\n          : <MainMDPreview previewType={previewType} chart={chart} matchChart={matchChart} />\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default HistoryPreviewMain","import { useMemo } from 'react'\r\nimport { Form, Input, InputNumber } from 'antd'\r\nimport { CollpaseZone } from 'src/components'\r\nimport { CDChartShow, TimeChartShow } from '.'\r\nimport { $consts } from 'src/plugins'\r\nimport { omit, cloneDeep } from 'lodash'\r\n\r\ninterface CMDProps {\r\n  previewType: string,\r\n  chart: any,\r\n  matchChart: any\r\n}\r\n// 对齐图 MD 预览：执行器和测量对象当前位号在所选时间段内的详细图表\r\nconst AlignMDPreview = (props: CMDProps) => {\r\n  const mainChart = useMemo(() => {\r\n    const { previewType, chart, matchChart } = props\r\n    const { xAxis = {}, yAxis = [] } = matchChart\r\n\r\n    const chartData = cloneDeep(chart)\r\n    chartData.Data.forEach((item: any) => {\r\n      const target = item.P.find((p: any) => p[0] === yAxis[0])\r\n      item.Time = item.T\r\n      item.Value = target ? (previewType === $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR'] ? target[3] : target[2]) : 0\r\n    })\r\n    const target = {\r\n      xAxis,\r\n      yAxis,\r\n      chartData,\r\n      series: [\r\n        {\r\n          field: 'Value',\r\n          chartOption: {\r\n            lineOption: {\r\n              name: '当前值'\r\n            }\r\n          }\r\n        }\r\n      ],\r\n      option: {\r\n        title: { text: chartData.Name },\r\n        legend: { show: false },\r\n        yAxis: { name: '' },\r\n      }\r\n    }\r\n\r\n    if (previewType === $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR']) {\r\n      return {\r\n        ...target,\r\n        maxText: 'YMax',\r\n        minText: 'YMin'\r\n      }\r\n    }\r\n    return {\r\n      ...target,\r\n      maxText: 'UMax',\r\n      minText: 'UMin'\r\n    }\r\n  }, [props.previewType, props.chart, props.matchChart])\r\n\r\n  return (\r\n    <CollpaseZone\r\n      collapse={\r\n        <Form layout='horizontal' labelCol={{ span: 10 }} wrapperCol={{ span: 14 }}>\r\n          <Form.Item label='对齐位号'>\r\n            <Input\r\n              disabled\r\n              value={mainChart.yAxis[0]}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label='SP'>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.yAxis[2]}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label='PV'>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.yAxis[3]}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label={mainChart.maxText}>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.xAxis.A}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label={mainChart?.minText}>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.xAxis.I}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label='坐标上界'>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.chartData.CoordinateMax}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label='坐标下界'>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.chartData.CoordinateMin}\r\n              className='data-preview__form-input'\r\n            />\r\n          </Form.Item>\r\n        </Form>\r\n      }\r\n      zoneRightClass='pd-t12'\r\n    >\r\n      <TimeChartShow\r\n        sliderVisible={false}\r\n        chartData={mainChart.chartData}\r\n        chartOption={mainChart.option}\r\n        chartHeight={452}\r\n        seriesData={mainChart.series}\r\n      />\r\n    </CollpaseZone>\r\n  )\r\n}\r\n\r\n// 对齐图 CD 预览：执行器和测量对象所有位号在当前时间的详细图表\r\nconst AlignCDPreview = (props: CMDProps) => {\r\n  const mainChart = useMemo(() => {\r\n    const { previewType, chart, matchChart } = props\r\n    const { xAxis = {}, yAxis = [] } = matchChart\r\n\r\n    const chartData: any = omit(chart, ['Data'])\r\n    chartData.PositionNumbers = xAxis.P?.map((p: any) => {\r\n      return {\r\n        PositionNumber: p[0],\r\n        SPValue: p[2],\r\n        PVValue: p[3]\r\n      }\r\n    }) || []\r\n\r\n    const target = {\r\n      xAxis,\r\n      yAxis,\r\n      chartData\r\n    }\r\n\r\n    if (previewType === $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR']) {\r\n      return {\r\n        ...target,\r\n        series: [\r\n          {\r\n            field: 'PVValue',\r\n            chartOption: {\r\n              legend: { data: [{ icon: 'circle' }] },\r\n              lineOption: {\r\n                name: 'PV值'\r\n              }\r\n            }\r\n          }\r\n        ],\r\n        option: {\r\n          title: { text: chartData.Name },\r\n          legend: { show: false },\r\n          yAxis: { name: '' }\r\n        },\r\n        maxText: 'YMax',\r\n        minText: 'YMin'\r\n      }\r\n    }\r\n\r\n    return {\r\n      ...target,\r\n      series: [\r\n        {\r\n          field: 'SPValue',\r\n          chartOption: {\r\n            barOption: {\r\n              name: 'SP值'\r\n            }\r\n          }\r\n        }\r\n      ],\r\n      option: {\r\n        title: { text: chartData.Name },\r\n        legend: { show: false },\r\n        xAxis: { maxInterval: 1, axisTick: { show: false } },\r\n        yAxis: { name: '' }\r\n      },\r\n      maxText: 'UMax',\r\n      minText: 'UMin'\r\n    }\r\n  }, [props.previewType, props.chart, props.matchChart])\r\n\r\n  return (\r\n    <CollpaseZone\r\n      collapse={\r\n        <Form layout='horizontal' labelCol={{ span: 10 }} wrapperCol={{ span: 14 }}>\r\n          <Form.Item label='当前时间'>\r\n            <Input\r\n              disabled\r\n              value={mainChart.xAxis.T}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label='SP'>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.yAxis[2]}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label='PV'>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.yAxis[3]}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label={mainChart.maxText}>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.xAxis.A}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label={mainChart?.minText}>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.xAxis.I}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label='坐标上界'>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.chartData.CoordinateMax}\r\n              className='data-preview__form-input mg-b26'\r\n            />\r\n          </Form.Item>\r\n          <Form.Item label='坐标下界'>\r\n            <InputNumber\r\n              disabled\r\n              value={mainChart.chartData.CoordinateMin}\r\n              className='data-preview__form-input'\r\n            />\r\n          </Form.Item>\r\n        </Form>\r\n      }\r\n      zoneRightClass='pd-t12'\r\n    >\r\n      <CDChartShow\r\n        sliderVisible={false}\r\n        chartData={mainChart.chartData}\r\n        chartOption={mainChart.option}\r\n        chartHeight={452}\r\n        seriesData={mainChart.series}\r\n      />\r\n    </CollpaseZone>\r\n  )\r\n}\r\n\r\ninterface Props extends CMDProps {\r\n  preview: string\r\n}\r\n// 对齐图预览 执行器/测量对象\r\nconst HistoryPreviewAlign = (props: Props) => {\r\n  const { previewType, preview, chart, matchChart } = props\r\n  return (\r\n    <div className='data-preview__chart-preview'>\r\n      {\r\n        preview === $consts['DATAPREVIEW/PREVIEW_TYPE_CD']\r\n          ? <AlignCDPreview previewType={previewType} chart={chart} matchChart={matchChart} />\r\n          : <AlignMDPreview previewType={previewType} chart={chart} matchChart={matchChart} />\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default HistoryPreviewAlign","import { useState, useEffect } from 'react'\r\nimport { useHistory } from 'react-router-dom'\r\nimport { Button, Tabs, Empty } from 'antd'\r\nimport { DownOutlined, UpOutlined } from '@ant-design/icons'\r\nimport { EnergyIcon } from 'src/components'\r\nimport { PaperMachineStatus } from './components'\r\nimport { commonStore } from 'src/stores'\r\nimport { $api, $consts } from 'src/plugins'\r\nimport { cloneDeep } from 'lodash'\r\nimport 'src/styles/modules/custom/home.less'\r\n\r\nconst { TabPane } = Tabs\r\nconst Home = () => {\r\n  const [machines, setMachines] = useState([])\r\n  useEffect(() => {\r\n    const { ORG_ID: OrgId } = commonStore.userinfo\r\n    $api['home/getMachines']({ OrgId }).then((res: any) => {\r\n      res && setMachines(res)\r\n    })\r\n  }, [])\r\n\r\n  const history = useHistory()\r\n  const handleNav = (search: string) => {\r\n    // 跳转去纸机监测页面\r\n    const find = commonStore.flatMenus.find((item: any) => item.Nav_MenuForm?.CODE === $consts['FORM/CODE_RTM002'])\r\n    find && history.push({\r\n      pathname: `/main/${find.ID}`,\r\n      search: `?OrgId=${search}`\r\n    })\r\n  }\r\n\r\n  return (\r\n    <div className='home'>\r\n      {\r\n        machines.map((item: any, index: number) => {\r\n          const { Name, Img, IsOnline, OrgId, Tops = [], Groups = [], collapsed = false } = item\r\n          const backgroundImage = Img || `url(${require('src/assets/custom/paper-machine.svg').default})`\r\n          const copyTops = cloneDeep(Tops)\r\n          copyTops.splice(1, 0, { isName: true })\r\n          return (\r\n            <div key={`${Name}_${index}`} className='home__paper'>\r\n              <div className='home__paper-overview'>\r\n                <div className='home__paper-pic'>\r\n                  <div className='home__paper-pic--bg' style={{ backgroundImage }} />\r\n                  <div\r\n                    onClick={() => {\r\n                      item.collapsed = !collapsed\r\n                      setMachines([...machines])\r\n                    }}\r\n                    className='home__paper-pic--more'\r\n                  >\r\n                    <span>更多参数</span>\r\n                    {collapsed ? <UpOutlined className='fz-16 pd-l8' /> : <DownOutlined className='fz-16 pd-l8' />}\r\n                    <PaperMachineStatus\r\n                      status={IsOnline ? $consts['PAPERMONITOR/MACHINE_ONLINE'] : $consts['PAPERMONITOR/MACHINE_OFFLINE']}\r\n                      className='home__paper-pic--status'\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className='home__paper-vars overview'>\r\n                  {\r\n                    copyTops.map((t: any, ti: number) => {\r\n                      if (t.isName) {\r\n                        return (\r\n                          <div key={`${t.Name}_${ti}`} className='home__paper-vars--zone is-name'>\r\n                            <Button\r\n                              block\r\n                              type='primary'\r\n                              size='large'\r\n                              onClick={() => handleNav(OrgId)}\r\n                            >{Name}</Button>\r\n                          </div>\r\n                        )\r\n                      }\r\n                      return (\r\n                        <div key={`${t.Name}_${ti}`} className='home__paper-vars--zone'>\r\n                          <EnergyIcon type={t.Icon} size={52} style={{ margin: '0 10%' }} />\r\n                          <div className='text-left'>\r\n                            <div className='fz-16'>{t.Name}</div>\r\n                            <div className='fz-24'>{t.Value}</div>\r\n                          </div>\r\n                        </div>\r\n                      )\r\n                    })\r\n                  }\r\n                </div>\r\n              </div>\r\n              <div className='home__paper-detail' style={{ display: item.collapsed ? 'block' : 'none' }}>\r\n                <Tabs>\r\n                  {\r\n                    Groups.map((g: any, gi: number) => {\r\n                      const { Vars = [] } = g\r\n                      // fakes 用于布局补齐\r\n                      const fakeCount = Math.ceil(Vars.length / 3) * 3 - Vars.length\r\n                      const fakes = fakeCount > 0 ? new Array(fakeCount).fill(true) : []\r\n                      return (\r\n                        <TabPane key={`${g.Id}_${gi}`} tab={g.Name}>\r\n                          <div className='home__paper-vars details'>\r\n                            {\r\n                              Vars.map((v: any, vi: number) => {\r\n                                return (\r\n                                  <div key={`${v.Name}_${vi}`} className='home__paper-vars--zone'>\r\n                                    <EnergyIcon type={v.Icon} size={52} style={{ margin: '0 10%' }} />\r\n                                    <div className='text-left'>\r\n                                      <div className='fz-16'>{v.Name}</div>\r\n                                      <div className='fz-24'>{v.Value}</div>\r\n                                    </div>\r\n                                  </div>\r\n                                )\r\n                              })\r\n                            }\r\n                            {\r\n                              fakes.map((f: any, fi: number) => {\r\n                                return <div key={`fake-vars_${fi}`} className='home__paper-vars--zone opacity-0' />\r\n                              })\r\n                            }\r\n                          </div>\r\n                        </TabPane>\r\n                      )\r\n                    })\r\n                  }\r\n                  {\r\n                    !Groups.length\r\n                      ? (\r\n                        <div className='text-center'>\r\n                          <Empty description={<p className='text-attach'>暂无更多参数</p>} />\r\n                        </div>\r\n                      )\r\n                      : null\r\n                  }\r\n                </Tabs>\r\n              </div>\r\n            </div>\r\n          )\r\n        })\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Home","import { useState, useEffect, useMemo } from 'react'\r\nimport { useLocation } from 'react-router-dom'\r\nimport { Scrollbars } from 'react-custom-scrollbars'\r\nimport { EnergyIcon } from 'src/components'\r\nimport { PaperMachineStatus, PaperMonitorControl, PaperMonitorChart } from './components'\r\nimport { commonStore } from 'src/stores'\r\nimport { $api, $consts } from 'src/plugins'\r\nimport queryString from 'query-string'\r\nimport 'src/styles/modules/custom/paperMonitor.less'\r\n\r\nconst switchOptions = [{ label: '控制页面', value: 1 }, { label: '曲线页面', value: 2 }]\r\nconst PaperMonitor = () => {\r\n  const location = useLocation()\r\n  const OrgId = useMemo<any>(() => {\r\n    const { ORG_ID: OrgId } = commonStore.userinfo\r\n    const target = queryString.parse(location.search)\r\n    return target.OrgId || OrgId\r\n  }, [location.search])\r\n\r\n  const [machine, setMachine] = useState<any>({})\r\n  const getMachine = () => {\r\n    $api['home/getOneDetail']({ OrgId }).then((res: any) => {\r\n      res && setMachine(res)\r\n    })\r\n  }\r\n  useEffect(() => {\r\n    getMachine()\r\n\r\n    let timer = setInterval(() => {\r\n      getMachine()\r\n    }, 5000)\r\n\r\n    return () => clearInterval(timer)\r\n  }, [OrgId])\r\n\r\n  const [switchType, setSwitchType] = useState(1)\r\n\r\n  const { Name, IsOnline = true, Vars = [] } = machine\r\n  return (\r\n    <div className='paper-monitor'>\r\n      <div className='paper-monitor__sider'>\r\n        <div className='paper-monitor__machine'>\r\n          {/** 纸机名称 */}\r\n          <div className='paper-monitor__machine-item border-bottom'>\r\n            <div className='display-flex flex-1 lineheight-1'>{Name}</div>\r\n            <PaperMachineStatus status={IsOnline ? $consts['PAPERMONITOR/MACHINE_ONLINE'] : $consts['PAPERMONITOR/MACHINE_OFFLINE']} />\r\n          </div>\r\n          {/** 纸机变量 */}\r\n          <Scrollbars\r\n            autoHide\r\n            autoHeight\r\n            autoHeightMax='65vh'\r\n            autoHideTimeout={1000}\r\n            autoHideDuration={200}\r\n          >\r\n            {\r\n              Vars.map((item: any, index: number) => {\r\n                return (\r\n                  <div\r\n                    key={`${item.Name}_${index}`}\r\n                    className={`paper-monitor__machine-item lineheight-1 ${index !== Vars.length - 1 ? 'border-bottom' : ''}`}\r\n                  >\r\n                    <div className='display-flex flex-1 flex-rowfsc'>\r\n                      <EnergyIcon type={item.Icon} size={40} />\r\n                      <span className='fz-18 pd-l24'>{item.Name}</span>\r\n                    </div>\r\n                    <span className='fz-24'>{item.Value}</span>\r\n                  </div>\r\n                )\r\n              })\r\n            }\r\n          </Scrollbars>\r\n        </div>\r\n        {/** 控制与曲线切换 */}\r\n        <div className='paper-monitor__switch'>\r\n          {\r\n            switchOptions.map((item: any) => {\r\n              return (\r\n                <div\r\n                  key={`${item.label}_${item.value}`}\r\n                  onClick={() => setSwitchType(item.value)}\r\n                  className={`paper-monitor__switch-item ${item.value === switchType ? 'active' : ''}`}\r\n                >{item.label}</div>\r\n              )\r\n            })\r\n          }\r\n        </div>\r\n      </div>\r\n      <div className='paper-monitor__main'>\r\n        {\r\n          switchType === 1\r\n          ? <PaperMonitorControl orgId={OrgId} machine={machine} />\r\n          : <PaperMonitorChart orgId={OrgId} />\r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default PaperMonitor","/**\r\n * 存储全局 WebSocket 实例以及对应监听的消息\r\n */\r\nclass StorageSocket {\r\n  socket?: WebSocket\r\n  onopen: any[]\r\n  onmessage: any[]\r\n  onerror: any[]\r\n  onclose: any[]\r\n  reconnectTimer: any\r\n\r\n  constructor () {\r\n    this.socket = undefined\r\n    this.onopen = []\r\n    this.onmessage = []\r\n    this.onerror = []\r\n    this.onclose = []\r\n    this.reconnectTimer = -1\r\n  }\r\n}\r\nconst storageSocket = new StorageSocket()\r\n\r\n/**\r\n * 全局 WebSocket 实例\r\n */\r\ntype GlobalSocketProps = {\r\n  url: string,\r\n  autoReconnect?: boolean,\r\n  reconnectInterval?: number\r\n}\r\nclass GlobalSocket {\r\n  // 全局 socket\r\n  socket?: WebSocket\r\n  socketUrl: string\r\n  // 自动重连\r\n  autoReconnect: boolean\r\n  reconnectInterval?: number\r\n  reconnectCount: number\r\n\r\n  /**\r\n   * 全局 socket 构造函数\r\n   * @param props \r\n   * @param props.url socket url\r\n   * @param props.autoReconnect socket 是否自动重连\r\n   * @param props.reconnectInterval socket 自动重连间隔\r\n   */\r\n  constructor (props: GlobalSocketProps) {\r\n    const { url, autoReconnect = true, reconnectInterval } = props\r\n    this.socketUrl = url\r\n    // 重连配置\r\n    this.autoReconnect = autoReconnect\r\n    this.reconnectInterval = reconnectInterval\r\n    this.reconnectCount = 1\r\n    // 构建 socket 实例\r\n    clearTimeout(storageSocket.reconnectTimer)\r\n    this.constructorSocket()\r\n  }\r\n\r\n  constructorSocket () {\r\n    this.socket = storageSocket.socket = new window.WebSocket(this.socketUrl)\r\n    this.socket.onopen = () => { this.evalFuncs('onopen') }\r\n    this.socket.onmessage = (evt) => { this.evalFuncs('onmessage', evt.data) }\r\n    this.socket.onerror = (err) => {\r\n      console.error('socket error', err, new Date().toLocaleString())\r\n      this.evalFuncs('onerror', err)\r\n    }\r\n    this.socket.onclose = (evt) => {\r\n      console.error('socket close', evt.code, evt.reason, new Date().toLocaleString())\r\n      this.evalFuncs('onclose', evt.code, evt.reason)\r\n      console.error('socket reconnect', this.autoReconnect)\r\n      this.autoReconnect && this.reconnect()\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 执行 socket 监听的所有事件\r\n   * @param type 'onopen' | 'onmessage' | 'onerror' | 'onclose'\r\n   * @param restProps 参数\r\n   */\r\n  evalFuncs (type: 'onopen' | 'onmessage' | 'onerror' | 'onclose', ...restProps: any) {\r\n    const funcs = storageSocket[type].filter(item => !!item)\r\n    Array.isArray(funcs) && funcs.forEach(func => func instanceof Function && func(...restProps))\r\n  }\r\n\r\n  /**\r\n   * 生成重连时间，重连次数越多，重连时间越长\r\n   * 比如第一次重连 1000ms，第二次就是 3000ms，第三次就是 7000ms\r\n   * @param count 重连次数\r\n   * @returns 重连间隔时间\r\n   */\r\n  generateInterval (count: number) {\r\n    return this.reconnectInterval || Math.min(30, Math.pow(2, count) - 1) * 1000\r\n  }\r\n\r\n  reconnect () {\r\n    storageSocket.reconnectTimer = setTimeout(() => {\r\n      this.reconnectCount++\r\n      this.constructorSocket()\r\n    }, this.generateInterval(this.reconnectCount))\r\n  }\r\n}\r\n\r\ntype SocketProps = {\r\n  url: string,\r\n  onopen?: Function,\r\n  onmessage?: Function,\r\n  onerror?: Function,\r\n  onclose?: Function,\r\n  newSocket?: boolean,\r\n  autoReconnect?: boolean,\r\n  reconnectInterval?: number\r\n}\r\nclass Socket {\r\n  // WebSocket 实例\r\n  socket?: WebSocket\r\n  socketEvtIndex: number\r\n\r\n  constructor (props: SocketProps) {\r\n    const { onopen, onmessage, onerror, onclose, newSocket = false, ...restProps } = props\r\n    /**\r\n     * 全局 g_socket 始终保持只有一个，\r\n     * 只有在指定了 newSocket 时候，才会将 g_socket 对应新的 url 进行更新，\r\n     * 否则 g_socket 永远保持第一次 new Socket 时创建的 WebSocket 实例\r\n     */\r\n    let globalSocket = undefined\r\n    if (!storageSocket.socket || newSocket) {\r\n      globalSocket = new GlobalSocket({ ...restProps })\r\n    }\r\n    this.socket = globalSocket?.socket || storageSocket.socket\r\n    // 存储所有的监听函数，保证所有的监听信息都能执行\r\n    storageSocket.onopen.push(onopen)\r\n    storageSocket.onmessage.push(onmessage)\r\n    storageSocket.onerror.push(onerror)\r\n    storageSocket.onclose.push(onclose)\r\n    // 保证新的 Socket 实例在调用 close 函数时，能正确移除监听的消息\r\n    this.socketEvtIndex = storageSocket.onopen.length - 1\r\n    // 如果已经存在 socket，则判断 opened 状态，opened 则直接调用 onopen 方法\r\n    if (this.socket?.readyState === 1 && onopen instanceof Function) {\r\n      /**\r\n       * 由于已经存在 socket，所以在 new Socket 时会直接调用 onopen，\r\n       * 往往这个时候 new Socket 的实例还未正确赋值到新组件中，\r\n       * 这就会导致新组件 onopen 方法中使用 Socket 实例时报 Socket 实例为 undefined，\r\n       * 所以这边将 onopen 方法放在微服务中，以确保新组件能正确接收到 Socket 实例的赋值\r\n       */\r\n      Promise.resolve().then(() => {\r\n        onopen()\r\n      })\r\n    }\r\n  }\r\n\r\n  send (data: any) {\r\n    if (!this.socket) return\r\n    this.socket.send(data)\r\n  }\r\n\r\n  close () {\r\n    if (this.socketEvtIndex === -1) return\r\n    storageSocket.onopen.splice(this.socketEvtIndex, 1, undefined)\r\n    storageSocket.onmessage.splice(this.socketEvtIndex, 1, undefined)\r\n    storageSocket.onerror.splice(this.socketEvtIndex, 1, undefined)\r\n    storageSocket.onclose.splice(this.socketEvtIndex, 1, undefined)\r\n  }\r\n}\r\n\r\nexport default Socket","import React, { useState, useEffect, useMemo, useRef } from 'react'\r\nimport { reaction } from 'mobx'\r\nimport { observer } from 'mobx-react'\r\nimport { useLocation } from 'react-router-dom'\r\nimport { Form, Select, Input, InputNumber, Checkbox, Button, Divider, message } from 'antd'\r\nimport { CameraOutlined, SettingOutlined, ImportOutlined, ExportOutlined } from '@ant-design/icons'\r\nimport { NowTime, CountTime, EnergyIcon, EasyModal, Loading, CollpaseZone } from 'src/components'\r\nimport { ControlConfigSet, CDChartShow, TargetOffset, SPValueImport } from './components'\r\nimport { commonStore, controlStore } from 'src/stores'\r\nimport { $api, $consts } from 'src/plugins'\r\nimport { useLatest } from 'src/hooks'\r\nimport Socket from 'src/utils/socket'\r\nimport { getBaseURL, getSocketURL } from 'src/utils/tools'\r\nimport queryString from 'query-string'\r\nimport { cloneDeep, pick, isEqual } from 'lodash'\r\nimport { ffc355And5bb86d, dashLine_bcbcbc } from 'src/assets/base64'\r\nimport 'src/styles/modules/custom/controlMonitor.less'\r\n\r\nconst intervalTime = 5000\r\nconst ControlMonitor = () => {\r\n  const location = useLocation()\r\n  const OrgId = useMemo(() => {\r\n    const { ORG_ID: OrgId } = commonStore.userinfo\r\n    const target = queryString.parse(location.search)\r\n    return target.OrgId || OrgId\r\n  }, [location.search])\r\n\r\n  // 控制器组\r\n  const [group, setGroup] = useState<any>({})\r\n  const getGroupDetail = () => {\r\n    $api['controlmonitor/getGroupInfo']({\r\n      OrgId\r\n    }).then((res: any) => {\r\n      res && setGroup(res)\r\n    }).finally(() => {\r\n      controlStore.setGroupChangeStatus(true)\r\n    })\r\n  }\r\n  useEffect(() => {\r\n    getGroupDetail()\r\n  }, [])\r\n\r\n  // 控制器组下的控制器列表\r\n  const controlList = useMemo(() => {\r\n    return group.Controllers || []\r\n  }, [group])\r\n\r\n  // 控制器\r\n  const [controlId, setControlId] = useState<string | number>('')\r\n  useEffect(() => {\r\n    group.Controllers && setControlId(group.Controllers[0]?.Id || '')\r\n  }, [group])\r\n  const missControlId = (show?: boolean): boolean => {\r\n    !controlId && show && message.error('请选择控制器')\r\n    return !controlId\r\n  }\r\n  const latestControlId = useLatest(controlId)\r\n\r\n  // 控制器详情\r\n  const [controlDetail, setControlDetail] = useState<any>({})\r\n  const getControlDetail = () => {\r\n    if (missControlId()) return\r\n\r\n    $api['controlmonitor/getControllerInfo']({\r\n      ControllerId: controlId\r\n    }).then((res: any) => {\r\n      if (res) {\r\n        setControlDetail(res)\r\n        setControlStatus(pick(res, ['Status', 'StatusInfo', 'MidStatus', 'MidStatusInfo']))\r\n      }\r\n    })\r\n  }\r\n  useEffect(() => {\r\n    getControlDetail()\r\n  }, [controlId])\r\n\r\n  // 控制器中间状态\r\n  const [controlStatus, setControlStatus] = useState<any>({})\r\n  const getControlStatus = () => {\r\n    if (missControlId()) return\r\n\r\n    $api['controlmonitor/getControllerStatus']({\r\n      ControllerId: controlId\r\n    }).then((res: any) => {\r\n      res && setControlStatus((prev: any) => isEqual(prev, res) ? prev : res)\r\n    })\r\n  }\r\n\r\n  // 定时刷新控制器状态\r\n  const refOfTimerStatus = useRef<any>(-1)\r\n  useEffect(() => {\r\n    refOfTimerStatus.current = setInterval(() => {\r\n      getControlStatus()\r\n    }, intervalTime)\r\n\r\n    return () => clearInterval(refOfTimerStatus.current)\r\n  }, [controlId])\r\n\r\n  // 控制器下的测量对象与执行器列表\r\n  const filterList = useMemo(() => {\r\n    const { CVList: cvList = [], MVList: mvList = [] } = controlDetail\r\n    return { cvList, mvList }\r\n  }, [controlDetail])\r\n\r\n  // 测量对象与执行器过滤\r\n  const [filter, setFilter] = useState({ MeasuringObjectId: '', ActuatorId: '' })\r\n  useEffect(() => {\r\n    const initFilter = { MeasuringObjectId: '', ActuatorId: '' }\r\n    filterList.cvList[0]?.Id && (initFilter.MeasuringObjectId = filterList.cvList[0].Id)\r\n    filterList.mvList[0]?.Id && (initFilter.ActuatorId = filterList.mvList[0].Id)\r\n    setFilter(initFilter)\r\n  }, [filterList])\r\n  const missFilterId = (show?: boolean): boolean => {\r\n    const { MeasuringObjectId, ActuatorId } = filter\r\n    !MeasuringObjectId && show && message.error('请选择测量对象')\r\n    !ActuatorId && show && message.error('请选择执行器')\r\n    return !MeasuringObjectId || !ActuatorId\r\n  }\r\n\r\n  // 控制器位号数据\r\n  const [posData, setPosData] = useState<any>({ MeasuringObject: {}, Actuator: {} })\r\n  const getPosData = () => {\r\n    if (missControlId() || missFilterId()) return\r\n\r\n    $api['controlmonitor/getPositionData']({\r\n      ControllerId: controlId,\r\n      ...filter\r\n    }).then((res: any) => {\r\n      res && setPosData((prev: any) => isEqual(prev, res) ? prev : res)\r\n    })\r\n  }\r\n\r\n  // 定时刷新位号数据信息\r\n  const refOfTimerPos = useRef<any>(-1)\r\n  useEffect(() => {\r\n    getPosData()\r\n\r\n    refOfTimerPos.current = setInterval(() => {\r\n      getPosData()\r\n    }, intervalTime)\r\n\r\n    return () => clearInterval(refOfTimerPos.current)\r\n  }, [controlId, filter])\r\n\r\n  // Slider 对应图表数据\r\n  const [slider, setSlider] = useState(0)\r\n  const [matchActChart, setMatchChartData] = useState<any>()\r\n  const matchMeasureChart = useMemo(() => {\r\n    const { PositionNumbers = [] } = posData.MeasuringObject\r\n    return PositionNumbers.find((item: any) => item.PositionNumber === matchActChart?.AlignPositionNumber)\r\n  }, [posData, matchActChart])\r\n\r\n  // 手/自动组切换倒计时，该值倒计时结束后，表示手/自动组切换开始执行\r\n  const [counter, setCounter] = useState(0)\r\n\r\n  // 自动组切换倒计时，该值会更新 counter 值\r\n  const [countTime, updateCountTime] = useState(0)\r\n  useEffect(() => {\r\n    group.LeavingSeconds && updateCountTime(group.LeavingSeconds)\r\n  }, [group])\r\n\r\n  // 自动组切换启禁用\r\n  const handleAutoSwitchEnable = (Value: boolean, Type: number, silent?: boolean) => {\r\n    if (missControlId(true)) return Promise.reject(false)\r\n\r\n    return $api['controlmonitor/updateControllerEnableOption']({\r\n      ControllerId: controlId,\r\n      Type,\r\n      Value\r\n    }).then((res: boolean) => {\r\n      if (res) {\r\n        !silent && message.success('操作成功')\r\n      }\r\n    })\r\n  }\r\n\r\n  // 手动组切换\r\n  const refOfTargetGroup = useRef()\r\n  const handleGroupSwitch = (params: any) => {\r\n    let { leftTime, targetGroup, targetTimes, timeType, } = params\r\n    const start = () => {\r\n      refOfTargetGroup.current = targetGroup\r\n      updateCountTime(leftTime)\r\n      message.success(`将在${targetTimes}${timeType === 'seconds' ? '秒' : timeType === 'minutes' ? '分钟' : '小时'}后进行组切换`)\r\n    }\r\n    if (group.IsAutoChangeGroup) {\r\n      handleAutoSwitchEnable(false, $consts['CONTROLMONITOR/IS_AUTO_CHANGE_GROUP'], true).then(() => {\r\n        start()\r\n      })\r\n    } else {\r\n      start()\r\n    }\r\n  }\r\n\r\n  // 组切换倒计时结束\r\n  const handleSwitchCountDone = () => {\r\n    message.success('正在为您切换组，请稍后...')\r\n    // 停止状态和尾号数据的接口轮询\r\n    clearInterval(refOfTimerStatus.current)\r\n    clearInterval(refOfTimerPos.current)\r\n    // 切换 loading\r\n    controlStore.setGroupChangeStatus(false)\r\n    // 手动切换\r\n    if (refOfTargetGroup.current) {\r\n      const NewGroupId = refOfTargetGroup.current\r\n      refOfTargetGroup.current = undefined\r\n      $api['controlmonitor/manualExchangeGroup']({\r\n        NewGroupId\r\n      }).then(() => {\r\n        message.success('切换成功')\r\n      }).catch(() => {\r\n        message.error('切换失败')\r\n      }).finally(() => {\r\n        getGroupDetail()\r\n      })\r\n    }\r\n  }\r\n\r\n  // 组切换 loading\r\n  const [groupChanging, setGroupChanging] = useState(false)\r\n  useEffect(() => reaction(() => controlStore.groupChangeDone, (value) => {\r\n    setGroupChanging(!value)\r\n  }), [])\r\n\r\n  // 执行器写入动画\r\n  const [flicker, setFlicker] = useState<any>(false)\r\n  const refOfTimerFlicker = useRef<any>(-1)\r\n  useEffect(() => {\r\n    clearTimeout(refOfTimerFlicker.current)\r\n  }, [])\r\n\r\n  // socket 实例\r\n  const socket = useRef<any>()\r\n  useEffect(() => {\r\n    const handleSocketOnMsg = (data: any) => {\r\n      if (!data) return\r\n\r\n      const { TypeCode, Data } = JSON.parse(data)\r\n      switch (TypeCode) {\r\n        // 执行器写入成功\r\n        case $consts['SOCKET/ACTUATOR_WRITE']:\r\n          if (Data?.ControllerId === latestControlId.current) {\r\n            setFlicker(Data)\r\n            // 定时器展示动画\r\n            clearTimeout(refOfTimerFlicker.current)\r\n            refOfTimerFlicker.current = setTimeout(() => {\r\n              setFlicker(false)\r\n            }, 3000)\r\n          }\r\n          break\r\n        // 页面刷新\r\n        case $consts['SOCKET/PAGE_REFRESH']:\r\n          getGroupDetail()\r\n          break\r\n      }\r\n    }\r\n\r\n    socket.current = new Socket({\r\n      url: getSocketURL(),\r\n      onmessage: handleSocketOnMsg\r\n    })\r\n\r\n    return () => {\r\n      socket.current && socket.current.close()\r\n    }\r\n  }, [])\r\n\r\n  // 设置选中位号的开闭环状态\r\n  const [checkedKeys, setCheckedKeys] = useState<number[]>([])\r\n\r\n  // options 展开收起\r\n  const [visible, setVisible] = useState(false)\r\n\r\n  // 测量对象快照\r\n  const handleMeasureSnapshot = () => {\r\n    if (missControlId(true) || missFilterId(true)) return\r\n\r\n    $api['controlmonitor/saveMeasuringObjectSnapshot']({\r\n      Id: filter.MeasuringObjectId\r\n    }).then((res: any) => {\r\n      if (res) {\r\n        message.success('操作成功')\r\n        getPosData()\r\n      }\r\n    })\r\n  }\r\n\r\n  // 执行器快照\r\n  const handleActSnapshot = () => {\r\n    if (missControlId(true) || missFilterId(true)) return\r\n\r\n    $api['controlmonitor/saveActuatorSnapshot']({\r\n      Id: filter.ActuatorId\r\n    }).then((res: any) => {\r\n      if (res) {\r\n        message.success('操作成功')\r\n        getPosData()\r\n      }\r\n    })\r\n  }\r\n\r\n  // 开闭环\r\n  const handleLoop = (IsClose: boolean, type: string) => {\r\n    if (missControlId(true) || missFilterId(true)) return\r\n\r\n    // 全闭环、全开环\r\n    if (type === 'all') {\r\n      $api['controlmonitor/openOrCloseAllLoop']({\r\n        ...filter,\r\n        ControllerId: controlId,\r\n        IsClose\r\n      }).then((res: any) => {\r\n        if (res) {\r\n          message.success('操作成功')\r\n          getPosData()\r\n        }\r\n      })\r\n      return\r\n    }\r\n    if (!checkedKeys.length) {\r\n      message.error('没有选中位号数据')\r\n      return\r\n    }\r\n    $api['controlmonitor/openOrCloseLoop']({\r\n      ...filter,\r\n      ControllerId: controlId,\r\n      IsClose,\r\n      PositionNumbers: checkedKeys\r\n    }).then((res: any) => {\r\n      if (res) {\r\n        message.success('操作成功')\r\n        getPosData()\r\n      }\r\n    })\r\n  }\r\n\r\n  // 手动设定 SP\r\n  const [customActuator, setCustomActuator] = useState<any>({})\r\n  const handleSetSPValue = (val: number) => {\r\n    const { PositionNumbers = [] } = posData.Actuator\r\n    const find: any = PositionNumbers.find((item: any) => item.PositionNumber === slider)\r\n    if (find) {\r\n      setCustomActuator({\r\n        ...customActuator,\r\n        [find.PositionNumber]: val\r\n      })\r\n    }\r\n  }\r\n  const chartActuator = useMemo(() => {\r\n    const copyActuator = cloneDeep(posData.Actuator)\r\n    const { PositionNumbers = [] } = copyActuator\r\n    PositionNumbers.forEach((item: any) => {\r\n      if (customActuator[item.PositionNumber] !== undefined) {\r\n        item.SetSPValue = customActuator[item.PositionNumber]\r\n      }\r\n    })\r\n    return copyActuator\r\n  }, [customActuator, posData.Actuator])\r\n\r\n  // 启动、停止、初始化\r\n  const handleSetControl = (Cmd: number) => {\r\n    if (missControlId(true)) return\r\n\r\n    const find = controlList.find((item: any) => item.Id === controlId)\r\n    $api['controlmonitor/setStatus']({\r\n      Id: controlId,\r\n      Name: find.Name,\r\n      Cmd\r\n    }).then((res: boolean) => {\r\n      if (res) {\r\n        message.success('操作成功')\r\n        getControlDetail()\r\n      }\r\n    })\r\n  }\r\n\r\n  // 半闭环、DCS、调试\r\n  const handleControlEnable = (Value: boolean, Type: number, field: string) => {\r\n    if (missControlId(true)) return\r\n\r\n    $api['controlmonitor/updateControllerEnableOption']({\r\n      ControllerId: controlId,\r\n      Type,\r\n      Value\r\n    }).then((res: boolean) => {\r\n      if (res) {\r\n        message.success('操作成功')\r\n        setControlDetail({ ...controlDetail, [field]: Value })\r\n      }\r\n    })\r\n  }\r\n\r\n  // 写入操作\r\n  const handleWrite = () => {\r\n    if (missControlId(true) || missFilterId(true)) return\r\n\r\n    const { PositionNumbers = [] } = chartActuator\r\n    $api['controlmonitor/writeSetSPValue']({\r\n      ActuatorId: filter.ActuatorId,\r\n      ControllerId: controlId,\r\n      PositionNumbers: PositionNumbers.map((item: any) => ({\r\n        PositionNumber: item.PositionNumber,\r\n        SPValue: item.SetSPValue\r\n      }))\r\n    }).then((res: any) => {\r\n      res && message.success('操作成功')\r\n    })\r\n  }\r\n\r\n  // 导出\r\n  const handleExport = () => {\r\n    if (missControlId(true) || missFilterId(true)) return\r\n\r\n    const { Tenant: tenant } = commonStore.headers\r\n    const actionApi = 'CFG/ControllerMonitor/ExportSPValue'\r\n    const exportUrl = `${getBaseURL(actionApi)}/${actionApi}?ActuatorId=${filter.ActuatorId}&ControllerId=${controlId}&tenant=${tenant}`\r\n    window.open(exportUrl, '_blank')\r\n  }\r\n\r\n  // 启动按钮是否禁用\r\n  const startDisable = useMemo(() => {\r\n    const { Status, MidStatus } = controlStatus\r\n    return MidStatus !== $consts['CONTROLMONITOR/CONTROL_MID_NONE'] || (Status !== $consts['CONTROLMONITOR/CONTROL_CMD_STOP'] && Status !== $consts['CONTROLMONITOR/CONTROL_CMD_WAIT_BEGIN'])\r\n  }, [controlStatus])\r\n\r\n  // 停止按钮是否禁用\r\n  const stopDisable = useMemo(() => {\r\n    const { Status, MidStatus } = controlStatus\r\n    return MidStatus !== $consts['CONTROLMONITOR/CONTROL_MID_NONE'] || Status !== $consts['CONTROLMONITOR/CONTROL_CMD_START']\r\n  }, [controlStatus])\r\n\r\n  // 启动状态GIF图\r\n  const startStatusDom = useMemo(() => {\r\n    const { Status, MidStatus } = controlStatus\r\n    let gif = require('src/assets/custom/engine-stop.png').default\r\n    if (MidStatus === $consts['CONTROLMONITOR/CONTROL_MID_NONE'] && Status === $consts['CONTROLMONITOR/CONTROL_CMD_START']) {\r\n      gif = require('src/assets/custom/engine-start.gif').default\r\n    }\r\n    return <img src={gif} alt='' />\r\n  }, [controlStatus])\r\n\r\n  // 写入状态GIF图\r\n  const writeStatusDom = useMemo(() => {\r\n    if (!flicker) return null\r\n\r\n    const { IsSuccess: ok } = flicker\r\n    const gif = ok ? require('src/assets/custom/flicker.gif').default : require('src/assets/custom/flicker.gif').default\r\n    const className = `pd-l8 fz-14 color-${ok ? 'success' : 'error'} fontweight-bolder vertical-middle`\r\n    return (\r\n      <React.Fragment>\r\n        <img src={gif} alt='' />\r\n        <span className={className}>{`写入${ok ? '成功' : '失败'}`}</span>\r\n      </React.Fragment>\r\n    )\r\n  }, [flicker])\r\n\r\n  // 目标组切换时间\r\n  const groupLeftTime = useMemo(() => {\r\n    const { LeavingSeconds: secs = 0 } = group\r\n    const min = Math.floor(secs / 60)\r\n    const sec = secs % 60\r\n    return `${min}分${sec}秒`\r\n  }, [group])\r\n\r\n  // 测量对象图表 series 数据\r\n  const measureSeries = [\r\n    {\r\n      field: 'PVValue',\r\n      chartOption: {\r\n        legend: { data: [{ icon: 'path://M0 0 H150 V12 H0 Z' }] },\r\n        lineOption: {\r\n          name: '当前值',\r\n        }\r\n      }\r\n    },\r\n    {\r\n      field: 'SnapPVValue',\r\n      chartOption: {\r\n        legend: { data: [{ icon: 'path://M0 0 H150 V12 H0 Z' }] },\r\n        lineOption: {\r\n          name: '快照值',\r\n        }\r\n      }\r\n    },\r\n    {\r\n      field: 'SPValue',\r\n      chartOption: {\r\n        legend: { data: [{ icon: `image://${dashLine_bcbcbc}` }] },\r\n        lineOption: {\r\n          name: '目标值',\r\n          lineStyle: { type: 'dashed', color: '#bcbcbc' },\r\n          areaStyle: { color: 'rgba(0,0,0,0)' }\r\n        }\r\n      }\r\n    }\r\n  ]\r\n\r\n  // 测量对象图表配置\r\n  const measureChart = useMemo(() => {\r\n    const { PositionNumbers = [] } = posData.MeasuringObject\r\n    const PVValues = PositionNumbers.map((item: any) => item.PVValue).filter((item: number) => item)\r\n    const max = Math.max(...PVValues)\r\n    const min = Math.min(...PVValues)\r\n    return {\r\n      title: { top: 40 },\r\n      grid: { top: 60 },\r\n      xAxis: { axisLabel: { showMinLabel: true, showMaxLabel: true } },\r\n      dataZoom: [\r\n        {\r\n          type: 'slider',\r\n          right: 10,\r\n          width: 18,\r\n          yAxisIndex: 0,\r\n          filterMode: 'none',\r\n          startValue: min || 0,\r\n          endValue: max || undefined\r\n        },\r\n        {\r\n          type: 'inside',\r\n          yAxisIndex: 0,\r\n          filterMode: 'none'\r\n        }\r\n      ]\r\n    }\r\n  }, [posData.MeasuringObject])\r\n\r\n  // 执行器图表 series 数据\r\n  const actSeries = useMemo(() => {\r\n    const { PositionNumbers = [] } = chartActuator\r\n    const barMaxWidth = 13 - Math.floor(PositionNumbers.length / 50) * 2\r\n    return [\r\n      {\r\n        field: 'SetSPValue',\r\n        checkLoop: true,\r\n        chartOption: {\r\n          legend: { data: [{ icon: `image://${ffc355And5bb86d}` }] },\r\n          barOption: {\r\n            name: '手动设定SP值',\r\n            barMaxWidth\r\n          }\r\n        }\r\n      },\r\n      {\r\n        field: 'PVValue',\r\n        zeroToUndefined: true, // 0 值不画\r\n        chartOption: {\r\n          legend: { data: [{ icon: 'circle' }] },\r\n          lineOption: {\r\n            name: '当前PV',\r\n            symbol: 'circle',\r\n            symbolSize: 6,\r\n            lineStyle: { opacity: 0 },\r\n            areaStyle: { color: 'rgba(0,0,0,0)' }\r\n          },\r\n        }\r\n      }\r\n    ]\r\n  }, [chartActuator])\r\n\r\n  // 执行器图表配置\r\n  const actChart = useMemo(() => {\r\n    const { PositionNumbers = [] } = chartActuator\r\n    const maxInterval = Math.ceil(PositionNumbers.length / 50)\r\n    return {\r\n      title: { show: false },\r\n      legend: { itemWidth: 24, itemHeight: 12 },\r\n      xAxis: { maxInterval, axisTick: { show: false } }\r\n    }\r\n  }, [chartActuator])\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='control-monitor'>\r\n        {/** 配置以及控制 */}\r\n        <div className='control-monitor__header'>\r\n          <div className='control-monitor__header-form'>\r\n            <Form layout='inline'>\r\n              <Form.Item label='控制器组'>\r\n                <Input disabled value={group.GroupName} className='control-monitor__form-input' />\r\n              </Form.Item>\r\n              <Form.Item label='控制器'>\r\n                <Select\r\n                  fieldNames={{ label: 'Name', value: 'Id' }}\r\n                  options={controlList}\r\n                  value={controlId}\r\n                  onChange={setControlId}\r\n                  style={{ width: 120 }}\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='产品批号'>\r\n                <Input disabled value={group.LotNumber} className='control-monitor__form-input' />\r\n              </Form.Item>\r\n              <Form.Item label='扫描周期'>\r\n                <Input\r\n                  disabled\r\n                  value={controlDetail.ScanCycle}\r\n                  addonAfter={controlDetail.CycleUnit}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n            </Form>\r\n            <div className='control-monitor__header-gif'>\r\n              {flicker ? writeStatusDom : startStatusDom}\r\n              <div><span>{controlStatus.MidStatusInfo}</span></div>\r\n            </div>\r\n            <Button\r\n              type='primary'\r\n              disabled={startDisable}\r\n              onClick={() => handleSetControl($consts['CONTROLMONITOR/CONTROL_CMD_START'])}\r\n              className='mg-r8'\r\n            >启动</Button>\r\n            <Button\r\n              danger\r\n              disabled={stopDisable}\r\n              onClick={() => handleSetControl($consts['CONTROLMONITOR/CONTROL_CMD_STOP'])}\r\n              className='mg-l8'\r\n            >停止</Button>\r\n          </div>\r\n          <div className='control-monitor__header-group'>\r\n            <Checkbox\r\n              checked={controlDetail.IsSemiClosedLoop}\r\n              onChange={val => handleControlEnable(val.target.checked, $consts['CONTROLMONITOR/IS_SEMI_CLOSED_LOOP'], 'IsSemiClosedLoop')}\r\n            >半闭环</Checkbox>\r\n            <Checkbox\r\n              checked={group.IsAutoChangeGroup}\r\n              onChange={val => handleAutoSwitchEnable(val.target.checked, $consts['CONTROLMONITOR/IS_AUTO_CHANGE_GROUP'])}\r\n            >自动组切换</Checkbox>\r\n            <Checkbox\r\n              checked={controlDetail.IsDCS}\r\n              onChange={val => handleControlEnable(val.target.checked, $consts['CONTROLMONITOR/IS_DCS'], 'IsDCS')}\r\n            >DCS</Checkbox>\r\n            <Checkbox\r\n              checked={controlDetail.IsDebug}\r\n              onChange={val => handleControlEnable(val.target.checked, $consts['CONTROLMONITOR/IS_DEBUG'], 'IsDebug')}\r\n            >调试</Checkbox>\r\n          </div>\r\n          <div className='control-monitor__header-control'>\r\n            <Checkbox\r\n              checked={controlDetail.IsAutoInit}\r\n              onChange={val => handleControlEnable(val.target.checked, $consts['CONTROLMONITOR/IS_AUTO_INIT'], 'IsAutoInit')}\r\n            >自动</Checkbox>\r\n            <Button\r\n              type='primary'\r\n              disabled={controlDetail.IsAutoInit}\r\n              onClick={() => handleSetControl($consts['CONTROLMONITOR/CONTROL_CMD_INIT'])}\r\n            >初始化</Button>\r\n            <Divider type='vertical' />\r\n            <EasyModal\r\n              title='功能配置'\r\n              width='50%'\r\n              slot={<Button type='primary' icon={<SettingOutlined />}>配置</Button>}\r\n            >\r\n              <ControlConfigSet\r\n                group={group}\r\n                controlDetail={controlDetail}\r\n                counter={counter}\r\n                onGroupSwitch={handleGroupSwitch}\r\n                onSuccess={getControlDetail}\r\n              />\r\n            </EasyModal>\r\n          </div>\r\n        </div>\r\n        {/** CD 测量对象图表 */}\r\n        <CollpaseZone\r\n          collapse={\r\n            <React.Fragment>\r\n              <Form layout='horizontal' labelCol={{ span: 10 }} wrapperCol={{ span: 14 }}>\r\n                <Form.Item label='对齐位号'>\r\n                  <InputNumber\r\n                    disabled\r\n                    value={matchActChart?.AlignPositionNumber}\r\n                    className='control-monitor__form-input'\r\n                  />\r\n                </Form.Item>\r\n                <Form.Item label='目标'>\r\n                  <InputNumber\r\n                    disabled\r\n                    value={matchMeasureChart?.SPValue}\r\n                    className='control-monitor__form-input'\r\n                  />\r\n                </Form.Item>\r\n                <Form.Item label='当前值'>\r\n                  <InputNumber\r\n                    disabled\r\n                    value={matchMeasureChart?.PVValue}\r\n                    className='control-monitor__form-input'\r\n                  />\r\n                </Form.Item>\r\n                <Form.Item label='最大值'>\r\n                  <InputNumber\r\n                    disabled\r\n                    value={posData.MeasuringObject.MaxValue}\r\n                    className='control-monitor__form-input'\r\n                  />\r\n                </Form.Item>\r\n                <Form.Item label='最小值'>\r\n                  <InputNumber\r\n                    disabled\r\n                    value={posData.MeasuringObject.MinValue}\r\n                    className='control-monitor__form-input'\r\n                  />\r\n                </Form.Item>\r\n                <Form.Item label='坐标上界'>\r\n                  <InputNumber\r\n                    disabled\r\n                    value={posData.MeasuringObject.CoordinateMax}\r\n                    className='control-monitor__form-input'\r\n                  />\r\n                </Form.Item>\r\n                <Form.Item label='坐标下界'>\r\n                  <InputNumber\r\n                    disabled\r\n                    value={posData.MeasuringObject.CoordinateMin}\r\n                    className='control-monitor__form-input'\r\n                  />\r\n                </Form.Item>\r\n                <Form.Item label='2σ'>\r\n                  <InputNumber\r\n                    disabled\r\n                    value={posData.MeasuringObject.TwoSigma}\r\n                    className='control-monitor__form-input'\r\n                  />\r\n                </Form.Item>\r\n              </Form>\r\n              <div className='mg-t20 text-center'>\r\n                <EasyModal\r\n                  title='测量目标偏置'\r\n                  width='400px'\r\n                  slot={<Button type='primary' className='mg-r16'>测量目标偏置</Button>}\r\n                >\r\n                  <TargetOffset\r\n                    controlId={controlId}\r\n                    mesuringObjectId={filter.MeasuringObjectId}\r\n                    onSuccess={getControlDetail}\r\n                  />\r\n                </EasyModal>\r\n                <Button type='primary' icon={<CameraOutlined />} onClick={handleMeasureSnapshot}>快照</Button>\r\n              </div>\r\n            </React.Fragment>\r\n          }\r\n          onChange={setVisible}\r\n          zoneClass='border-top'\r\n          zoneStyle={{ top: -1 }}\r\n          zoneRightClass='pd-t12'\r\n        >\r\n          <Form layout='inline' className='pd-l12 pd-t12 mg-b6'>\r\n            <Form.Item label='CD测量对象'>\r\n              <Select\r\n                fieldNames={{ label: 'Name', value: 'Id' }}\r\n                options={filterList.cvList}\r\n                value={filter.MeasuringObjectId}\r\n                onChange={(val: any) => setFilter({ ...filter, MeasuringObjectId: val })}\r\n                style={{ width: 240 }}\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='CD执行器'>\r\n              <Select\r\n                fieldNames={{ label: 'Name', value: 'Id' }}\r\n                options={filterList.mvList}\r\n                value={filter.ActuatorId}\r\n                onChange={(val: any) => setFilter({ ...filter, ActuatorId: val })}\r\n                style={{ width: 240 }}\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='控制模式'>\r\n              <Input disabled value='CD' className='control-monitor__form-input--xl' />\r\n            </Form.Item>\r\n          </Form>\r\n          <CDChartShow\r\n            timeVisible\r\n            slider={matchActChart?.AlignPositionNumber}\r\n            sliderVisible={false}\r\n            chartData={posData.MeasuringObject}\r\n            chartOption={measureChart}\r\n            chartHeight={340}\r\n            seriesData={measureSeries}\r\n          />\r\n        </CollpaseZone>\r\n        {/** CD 执行器对齐图表 */}\r\n        <CollpaseZone\r\n          showHandler={false}\r\n          visible={visible}\r\n          collapse={\r\n            <Form layout='horizontal' labelCol={{ span: 10 }} wrapperCol={{ span: 14 }}>\r\n              <Form.Item label='位号'>\r\n                <InputNumber\r\n                  value={slider}\r\n                  onChange={setSlider}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='对齐测量值'>\r\n                <InputNumber\r\n                  disabled\r\n                  value={matchActChart?.AlignValue}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='当前SP'>\r\n                <InputNumber\r\n                  disabled\r\n                  value={matchActChart?.SPValue}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='手动设定SP'>\r\n                <InputNumber\r\n                  value={matchActChart?.SetSPValue}\r\n                  onChange={handleSetSPValue}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='当前PV'>\r\n                <InputNumber\r\n                  disabled\r\n                  value={matchActChart?.PVValue}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='最大值'>\r\n                <InputNumber\r\n                  disabled\r\n                  value={posData.Actuator.MaxValue}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='最小值'>\r\n                <InputNumber\r\n                  disabled\r\n                  value={posData.Actuator.MinValue}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='坐标上界'>\r\n                <InputNumber\r\n                  disabled\r\n                  value={posData.Actuator.CoordinateMax}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='坐标下界'>\r\n                <InputNumber\r\n                  disabled\r\n                  value={posData.Actuator.CoordinateMin}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n              <Form.Item label='2σ'>\r\n                <InputNumber\r\n                  disabled\r\n                  value={posData.Actuator.TwoSigma}\r\n                  className='control-monitor__form-input'\r\n                />\r\n              </Form.Item>\r\n            </Form>\r\n          }\r\n          zoneStyle={{ top: -1 }}\r\n          zoneRightClass='border-top pd-t12'\r\n        >\r\n          <CDChartShow\r\n            checkboxVisible\r\n            slider={slider}\r\n            chartData={chartActuator}\r\n            alignChartData={posData.MeasuringObject}\r\n            chartOption={actChart}\r\n            chartHeight={310}\r\n            seriesData={actSeries}\r\n            onChange={setSlider}\r\n            onChartChange={setMatchChartData}\r\n            onCheckedChange={setCheckedKeys}\r\n          />\r\n          <div className='control-monitor__btn-group'>\r\n            <Button icon={<EnergyIcon type='icon-bihuanchuzhi' className='pd-r8' />} onClick={() => handleLoop(true, 'checked')}>选中闭环</Button>\r\n            <Button icon={<EnergyIcon type='icon-kaihuan' className='pd-r8' />} onClick={() => handleLoop(false, 'checked')}>选中开环</Button>\r\n            <Button type='primary' icon={<EnergyIcon type='icon-xieru' className='pd-r8' />} onClick={handleWrite}>写入</Button>\r\n            <EasyModal\r\n              title='SP值导入'\r\n              width='400px'\r\n              slot={<Button type='primary' icon={<ImportOutlined />}>导入</Button>}\r\n              slotClass='mg-l18 mg-r18'\r\n            >\r\n              <SPValueImport\r\n                controlId={controlId}\r\n                actuatorId={filter.ActuatorId}\r\n                onSuccess={getControlDetail}\r\n              />\r\n            </EasyModal>\r\n            <Button type='primary' icon={<ExportOutlined />} onClick={handleExport}>导出</Button>\r\n            <Button type='primary' icon={<CameraOutlined />} onClick={handleActSnapshot}>快照</Button>\r\n            <div className='control-monitor__btn-group--full'>\r\n              <Button onClick={() => handleLoop(true, 'all')}>全闭环</Button>\r\n              <Button onClick={() => handleLoop(false, 'all')}>全开环</Button>\r\n            </div>\r\n          </div>\r\n        </CollpaseZone>\r\n        {/** 通讯状态 */}\r\n        <div className='control-monitor__footer'>\r\n          <div className='control-monitor__footer-left'>\r\n            {\r\n              group.IsOnline\r\n                ? <div className='display-flex'><i className='status fine' /><span>正常</span></div>\r\n                : <div className='display-flex'><i className='status error' /><span>异常</span></div>\r\n            }\r\n            <NowTime extraFont='当前时间：' className='mg-l30' />\r\n            <span className='mg-l30'>用户名：{commonStore.userinfo.NAME}</span>\r\n            <span className='mg-l30'>用户类型：高级工程师</span>\r\n          </div>\r\n          <div className='control-monitor__footer-right'>\r\n            <span>当前组剩余时间：{groupLeftTime}</span>\r\n            <span className='mg-l30'>目标组切换时间：{group.TargetGroupChangeTime}</span>\r\n            <CountTime\r\n              extraFont='组切换倒计时：'\r\n              // 与 counter 区分开，因为 setCounter 会一直刷新 counter\r\n              seconds={countTime}\r\n              onCountChange={setCounter}\r\n              onCountDone={handleSwitchCountDone}\r\n              className='mg-l30'\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <Loading loading={groupChanging} />\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\nexport default observer(ControlMonitor)","import React, { useState, useEffect, useMemo } from 'react'\r\nimport { observer } from 'mobx-react'\r\nimport { useLocation } from 'react-router-dom'\r\nimport { Form, Select, Input, Button, DatePicker, Tabs, message } from 'antd'\r\nimport { CameraOutlined, SearchOutlined } from '@ant-design/icons'\r\nimport { EnergyIcon } from 'src/components'\r\nimport { DataPreviewRealtime, DataPreviewAvg, DataPreviewTwosigma, DataPreviewHistory } from './components'\r\nimport { commonStore, loadingStore } from 'src/stores'\r\nimport { $api, $consts, $evt } from 'src/plugins'\r\nimport queryString from 'query-string'\r\nimport moment from 'moment'\r\nimport { cloneDeep } from 'lodash'\r\nimport 'src/styles/modules/custom/dataPreview.less'\r\n\r\nconst { RangePicker } = DatePicker\r\nconst { TabPane } = Tabs\r\n\r\ntype FilterProps = {\r\n  currTab: string,\r\n  previewType: string,\r\n  controlDetail: any,\r\n  onFilterChange: Function\r\n}\r\nconst Filter = (props: FilterProps) => {\r\n  // 控制器下的测量对象与执行器列表\r\n  const filterList = useMemo(() => {\r\n    const { MVList: mvList = [], CVList: cvList = [] } = props.controlDetail\r\n    return { mvList, cvList }\r\n  }, [props.controlDetail])\r\n\r\n  // 测量对象下的执行器筛选列表\r\n  const [actFilterList, setActFilterList] = useState<any[]>([])\r\n\r\n  // 执行器下的测量对象筛选列表\r\n  const [meaFilterList, setMeaFilterList] = useState<any[]>([])\r\n\r\n  const options = useMemo(() => {\r\n    switch (props.previewType) {\r\n      case $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR']:\r\n        return {\r\n          mvList: filterList.mvList,\r\n          cvList: meaFilterList\r\n        }\r\n      case $consts['DATAPREVIEW/PREVIEW_TYPE_MEASURE']:\r\n        return {\r\n          mvList: actFilterList,\r\n          cvList: filterList.cvList\r\n        }\r\n      default:\r\n        return filterList\r\n    }\r\n  }, [props.previewType, filterList, actFilterList, meaFilterList])\r\n\r\n  // 测量对象与执行器过滤\r\n  const [filter, setFilter] = useState({ ActuatorId: [], MeasuringObjectId: [] })\r\n  useEffect(() => {\r\n    const initFilter: any = { ActuatorId: [], MeasuringObjectId: [] }\r\n    switch (props.previewType) {\r\n      case $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR']:\r\n        {\r\n          const ActuatorId = filterList.mvList[0]?.Id\r\n          if (ActuatorId) {\r\n            initFilter.ActuatorId.push(ActuatorId)\r\n            // 获取控制器下测量对象列表\r\n            $api['datapreview/getMeasuringObjectListByActuator']({\r\n              ControllerId: props.controlDetail.Id,\r\n              ActuatorId\r\n            }).then((res: any[]) => {\r\n              if (res && Array.isArray(res)) {\r\n                res.forEach((item: any) => {\r\n                  initFilter.MeasuringObjectId.push(item.Id)\r\n                })\r\n                setMeaFilterList(res)\r\n                setFilter(initFilter)\r\n              }\r\n            })\r\n          }\r\n        }\r\n        break\r\n      case $consts['DATAPREVIEW/PREVIEW_TYPE_MEASURE']:\r\n        {\r\n          const MeasuringObjectId = filterList.cvList[0]?.Id\r\n          if (MeasuringObjectId) {\r\n            initFilter.MeasuringObjectId.push(MeasuringObjectId)\r\n            // 获取测量对象下控制器列表\r\n            $api['datapreview/getActuatorListByMeasuringObject']({\r\n              ControllerId: props.controlDetail.Id,\r\n              MeasuringObjectId\r\n            }).then((res: any[]) => {\r\n              if (res && Array.isArray(res)) {\r\n                res.forEach((item: any) => {\r\n                  initFilter.ActuatorId.push(item.Id)\r\n                })\r\n                setActFilterList(res)\r\n                setFilter(initFilter)\r\n              }\r\n            })\r\n          }\r\n        }\r\n        break\r\n    }\r\n  }, [props.previewType, props.controlDetail, filterList])\r\n\r\n  // 获取对应执行器和测量对象列表\r\n  useEffect(() => {\r\n    props.onFilterChange(filter)\r\n  }, [filter])\r\n\r\n  // CMD 预览\r\n  const [preview, setPreview] = useState('')\r\n  useEffect(() => {\r\n    $evt.emit($consts['DATAPREVIEW/EVT_CMDPREVIEW'], preview)\r\n  }, [preview])\r\n\r\n  // 附加的快照以及导出按钮\r\n  const btns = useMemo(() => {\r\n    // 快照\r\n    const handleSnapshot = () => {\r\n      if (props.previewType === $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR']) {\r\n        $api['datapreview/setSnapshotByActuator']({\r\n          ControllerId: props.controlDetail.Id,\r\n          ActuatorId: filter.ActuatorId[0],\r\n          MeasuringObjectIds: filter.MeasuringObjectId\r\n        }).then((res: any) => {\r\n          if (res) {\r\n            message.success('操作成功')\r\n            $evt.emit($consts['DATAPREVIEW/EVT_SNAPSHOT'])\r\n          }\r\n        })\r\n        return\r\n      }\r\n      $api['datapreview/setSnapshotByMeasuringObject']({\r\n        ControllerId: props.controlDetail.Id,\r\n        ActuatorIds: filter.ActuatorId,\r\n        MeasuringObjectId: filter.MeasuringObjectId[0]\r\n      }).then((res: any) => {\r\n        if (res) {\r\n          message.success('操作成功')\r\n          $evt.emit($consts['DATAPREVIEW/EVT_SNAPSHOT'])\r\n        }\r\n      })\r\n    }\r\n\r\n    // 导出\r\n    const handleExport = () => { }\r\n\r\n    switch (props.previewType) {\r\n      case $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR']:\r\n        if (props.currTab === 'realtime-data') {\r\n          return <Button type='primary' icon={<CameraOutlined />} onClick={handleSnapshot}>快照</Button>\r\n        }\r\n        if (props.currTab === 'history-data') {\r\n          return (\r\n            <React.Fragment>\r\n              <Button\r\n                type={preview === $consts['DATAPREVIEW/PREVIEW_TYPE_CD'] ? 'primary' : 'default'}\r\n                onClick={() => setPreview($consts['DATAPREVIEW/PREVIEW_TYPE_CD'])}\r\n              >CD预览</Button>\r\n              <Button\r\n                type={preview === $consts['DATAPREVIEW/PREVIEW_TYPE_MD'] ? 'primary' : 'default'}\r\n                onClick={() => setPreview($consts['DATAPREVIEW/PREVIEW_TYPE_MD'])}\r\n                className='mg-l8'\r\n              >MD预览</Button>\r\n              {preview ? <Button type='primary' onClick={() => setPreview('')} className='mg-l8'>返回</Button> : null}\r\n            </React.Fragment>\r\n          )\r\n        }\r\n        return null\r\n      case $consts['DATAPREVIEW/PREVIEW_TYPE_MEASURE']:\r\n        if (props.currTab === 'realtime-data') {\r\n          return (\r\n            <React.Fragment>\r\n              <Button type='primary' icon={<CameraOutlined />} onClick={handleSnapshot}>快照</Button>\r\n              <Button type='primary' icon={<CameraOutlined />} onClick={handleExport} className='mg-l8'>导出</Button>\r\n            </React.Fragment>\r\n          )\r\n        }\r\n        if (props.currTab === 'history-data') {\r\n          return (\r\n            <React.Fragment>\r\n              <Button\r\n                type={preview === $consts['DATAPREVIEW/PREVIEW_TYPE_CD'] ? 'primary' : 'default'}\r\n                onClick={() => setPreview($consts['DATAPREVIEW/PREVIEW_TYPE_CD'])}\r\n              >CD预览</Button>\r\n              <Button\r\n                type={preview === $consts['DATAPREVIEW/PREVIEW_TYPE_MD'] ? 'primary' : 'default'}\r\n                onClick={() => setPreview($consts['DATAPREVIEW/PREVIEW_TYPE_MD'])}\r\n                className='mg-l8'\r\n              >MD预览</Button>\r\n              {preview ? <Button type='primary' onClick={() => setPreview('')} className='mg-l8'>返回</Button> : null}\r\n              <Button type='primary' icon={<CameraOutlined />} onClick={handleExport} className='mg-l8'>导出</Button>\r\n            </React.Fragment>\r\n          )\r\n        }\r\n        return <Button type='primary' icon={<CameraOutlined />} onClick={handleExport}>导出</Button>\r\n      default:\r\n        return null\r\n    }\r\n  }, [props.currTab, props.previewType, props.controlDetail, filter, preview])\r\n\r\n  return (\r\n    <Form layout='inline'>\r\n      <Form.Item label='CD执行器'>\r\n        <Select\r\n          mode={props.previewType === $consts['DATAPREVIEW/PREVIEW_TYPE_MEASURE'] ? 'multiple' : undefined}\r\n          maxTagCount={1}\r\n          fieldNames={{ label: 'Name', value: 'Id' }}\r\n          options={options.mvList}\r\n          value={filter.ActuatorId}\r\n          onChange={(val: any) => setFilter({ ...filter, ActuatorId: val })}\r\n          style={{ width: 200 }}\r\n        />\r\n      </Form.Item>\r\n      <Form.Item label='CD测量对象'>\r\n        <Select\r\n          mode={props.previewType === $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR'] ? 'multiple' : undefined}\r\n          maxTagCount={1}\r\n          fieldNames={{ label: 'Name', value: 'Id' }}\r\n          options={options.cvList}\r\n          value={filter.MeasuringObjectId}\r\n          onChange={(val: any) => setFilter({ ...filter, MeasuringObjectId: val })}\r\n          style={{ width: 200 }}\r\n        />\r\n      </Form.Item>\r\n      {btns}\r\n    </Form>\r\n  )\r\n}\r\n\r\nconst DataPreview = () => {\r\n  const location = useLocation()\r\n  const OrgId = useMemo(() => {\r\n    const { ORG_ID: OrgId } = commonStore.userinfo\r\n    const target = queryString.parse(location.search)\r\n    return target.OrgId || OrgId\r\n  }, [location.search])\r\n\r\n  // 控制器组\r\n  const [group, setGroup] = useState<any>({})\r\n  useEffect(() => {\r\n    $api['controlmonitor/getGroupInfo']({ OrgId }).then((res: any) => {\r\n      res && setGroup(res)\r\n    })\r\n  }, [])\r\n\r\n  // 控制器组下的控制器列表\r\n  const controlList = useMemo(() => {\r\n    return group.Controllers || []\r\n  }, [group])\r\n\r\n  // 控制器\r\n  const [controlId, setControlId] = useState<string | number>('')\r\n  useEffect(() => {\r\n    group.Controllers && setControlId(group.Controllers[0]?.Id || '')\r\n  }, [group])\r\n  const missControlId = (show?: boolean): boolean => {\r\n    !controlId && show && message.error('请选择控制器')\r\n    return !controlId\r\n  }\r\n\r\n  // 控制器详情\r\n  const [controlDetail, setControlDetail] = useState<any>({})\r\n  const getControlDetail = () => {\r\n    if (missControlId()) return\r\n\r\n    $api['datapreview/getControllerInfo']({\r\n      ControllerId: controlId\r\n    }).then((res: any) => {\r\n      if (res) {\r\n        setControlDetail(res)\r\n      }\r\n    })\r\n  }\r\n  useEffect(() => {\r\n    getControlDetail()\r\n  }, [controlId])\r\n\r\n  // 过滤时间\r\n  const [timeRange, setTimeRange] = useState<any>([moment().subtract(10, 'minutes'), moment()])\r\n  const handleTimeChange = (dates: any) => {\r\n    dates = [moment(dates[0].format('YYYY-MM-DD HH:mm')), moment(dates[1].format('YYYY-MM-DD HH:mm'))]\r\n    const copyDates = cloneDeep(dates)\r\n    const isSame = copyDates[1].isSame(copyDates[0])\r\n    const isAfter = copyDates[1].isAfter(copyDates[0].add(1, 'hours'))\r\n    if (isSame || isAfter) {\r\n      isAfter && message.warning('只能查询1小时区间段的数据')\r\n      setTimeRange([dates[0], cloneDeep(dates[0]).add(10, 'minutes')])\r\n      return\r\n    }\r\n    setTimeRange(dates)\r\n  }\r\n\r\n  // 测量对象预览或执行器预览\r\n  const [previewType, setPreviewType] = useState($consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR'])\r\n\r\n  // 执行器和测量对象过滤\r\n  const [filter, setFilter] = useState()\r\n\r\n  // 当前 tab\r\n  const [currTab, setCurrTab] = useState('realtime-data')\r\n\r\n  return (\r\n    <div className='data-preview'>\r\n      <div className='data-preview__header'>\r\n        <div className='data-preview__header-form'>\r\n          <Form layout='inline'>\r\n            <Form.Item label='控制器组'>\r\n              <Input disabled value={group.GroupName} className='data-preview__form-input' />\r\n            </Form.Item>\r\n            <Form.Item label='控制器'>\r\n              <Select\r\n                fieldNames={{ label: 'Name', value: 'Id' }}\r\n                options={controlList}\r\n                value={controlId}\r\n                onChange={setControlId}\r\n                style={{ width: 120 }}\r\n              />\r\n            </Form.Item>\r\n            <Form.Item label='产品批号'>\r\n              <Input disabled value={group.LotNumber} className='data-preview__form-input' />\r\n            </Form.Item>\r\n            <Form.Item label='扫描周期'>\r\n              <Input\r\n                disabled\r\n                value={controlDetail.ScanCycle}\r\n                addonAfter={controlDetail.CycleUnit}\r\n                className='data-preview__form-input'\r\n              />\r\n            </Form.Item>\r\n          </Form>\r\n          <Button\r\n            type={previewType === $consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR'] ? 'primary' : 'default'}\r\n            icon={<EnergyIcon type='icon-PLCzhihangqi' className='pd-r8' />}\r\n            onClick={() => {\r\n              setPreviewType($consts['DATAPREVIEW/PREVIEW_TYPE_ACTUATOR'])\r\n              setFilter(undefined)\r\n            }}\r\n            className='mg-r8'\r\n          >执行器预览</Button>\r\n          <Button\r\n            type={previewType === $consts['DATAPREVIEW/PREVIEW_TYPE_MEASURE'] ? 'primary' : 'default'}\r\n            icon={<EnergyIcon type='icon-celiang' className='pd-r8' />}\r\n            onClick={() => {\r\n              setPreviewType($consts['DATAPREVIEW/PREVIEW_TYPE_MEASURE'])\r\n              setFilter(undefined)\r\n            }}\r\n            className='mg-l8'\r\n          >测量对象预览</Button>\r\n        </div>\r\n        {\r\n          currTab !== 'realtime-data'\r\n            ? (\r\n              <div className='data-preview__header-form'>\r\n                <Form layout='inline'>\r\n                  <Form.Item label='选择时间'>\r\n                    <RangePicker\r\n                      allowClear={false}\r\n                      showTime={{ format: 'HH:mm' }}\r\n                      format='YYYY-MM-DD HH:mm'\r\n                      value={timeRange}\r\n                      onChange={handleTimeChange}\r\n                      style={{ width: 300 }}\r\n                    />\r\n                  </Form.Item>\r\n                  <Form.Item label=''>\r\n                    <Button\r\n                      type='primary'\r\n                      icon={<SearchOutlined />}\r\n                      loading={loadingStore.visible}\r\n                      onClick={() => setTimeRange([...timeRange])}\r\n                    >查询</Button>\r\n                  </Form.Item>\r\n                </Form>\r\n              </div>\r\n            )\r\n            : null\r\n        }\r\n      </div>\r\n      <div className='data-preview__tabs'>\r\n        <Tabs\r\n          animated={false}\r\n          activeKey={currTab}\r\n          onChange={setCurrTab}\r\n          tabBarExtraContent={\r\n            <Filter\r\n              currTab={currTab}\r\n              previewType={previewType}\r\n              controlDetail={controlDetail}\r\n              onFilterChange={setFilter}\r\n            />\r\n          }\r\n        >\r\n          <TabPane tab='实时数据' key='realtime-data'>\r\n            <DataPreviewRealtime\r\n              previewType={previewType}\r\n              filter={filter}\r\n              controlId={controlId}\r\n            />\r\n          </TabPane>\r\n          <TabPane tab='历史数据' key='history-data'>\r\n            <DataPreviewHistory\r\n              previewType={previewType}\r\n              filter={filter}\r\n              controlId={controlId}\r\n              timeRange={timeRange}\r\n            />\r\n          </TabPane>\r\n          <TabPane tab='平均数据' key='average-data'>\r\n            <DataPreviewAvg\r\n              previewType={previewType}\r\n              filter={filter}\r\n              controlId={controlId}\r\n              timeRange={timeRange}\r\n            />\r\n          </TabPane>\r\n          <TabPane tab='2σ数据' key='xigema-data'>\r\n            <DataPreviewTwosigma\r\n              previewType={previewType}\r\n              filter={filter}\r\n              controlId={controlId}\r\n              timeRange={timeRange}\r\n            />\r\n          </TabPane>\r\n        </Tabs>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default observer(DataPreview)","import { useMemo } from 'react'\r\nimport * as customPages from 'src/modules/custom'\r\n\r\ntype Props = {\r\n  name: string\r\n}\r\n\r\nconst LoadablePage = (props: Props) => {\r\n  const Component = useMemo(() => {\r\n    // @ts-ignore\r\n    if (customPages[props.name]) return customPages[props.name]\r\n    return () => null\r\n  }, [props.name])\r\n\r\n  return <Component />\r\n}\r\n\r\nexport default LoadablePage","import { useContext } from 'react'\r\nimport { EasyModal, ListTableContext, FormPage, EnergyIcon } from 'src/components'\r\n\r\ntype Props = {\r\n  config: any\r\n}\r\n\r\nconst CustomModalBtn = (props: Props) => {\r\n  const table = useContext(ListTableContext)\r\n  const record = table.selectedData[0]\r\n  const { ICON, LABEL, FORM_CODE } = props.config\r\n\r\n  return (\r\n    <EasyModal\r\n      width='98%'\r\n      title={record?.NAME || record?.ALIAS || record?.ID || FORM_CODE}\r\n      slot={<span><EnergyIcon type={ICON} /><span className='pd-l4'>{LABEL}</span></span>}\r\n    >\r\n      <FormPage formCode={FORM_CODE} />\r\n    </EasyModal>\r\n  )\r\n}\r\n\r\nexport default CustomModalBtn","import { useContext } from 'react'\r\nimport { Popconfirm, message } from 'antd'\r\nimport { DeleteOutlined } from '@ant-design/icons'\r\nimport { ListTableContext } from 'src/components'\r\nimport { $api } from 'src/plugins'\r\n\r\ntype Props = {\r\n  config: any\r\n}\r\n\r\nconst DeleteConfirmBtn = (props: Props) => {\r\n  const table = useContext(ListTableContext)\r\n\r\n  const handleDelete = () => {\r\n    const record = table.selectedData[0]\r\n    const { API_URL } = props.config\r\n    if (!API_URL) {\r\n      message.error('未配置删除API接口')\r\n      return\r\n    }\r\n    $api['app/getDataByGet'](\r\n      { id: record?.ID },\r\n      { url: `/${API_URL}` }\r\n    ).then((res: any) => {\r\n      if (res) {\r\n        table.reload()\r\n        message.success('删除成功')\r\n      }\r\n    })\r\n  }\r\n\r\n  const { config } = props\r\n  const { LABEL } = config\r\n  return (\r\n    <Popconfirm title='确认删除？' onConfirm={handleDelete}>\r\n      <span className='color-error'><DeleteOutlined className='fz-16' /><span className='pd-l4'>{LABEL}</span></span>\r\n    </Popconfirm>\r\n  )\r\n}\r\n\r\nexport default DeleteConfirmBtn","import { useContext } from 'react'\r\nimport { Button } from 'antd'\r\nimport { FormPage, EasyModal, ListContext } from 'src/components'\r\n\r\ntype Props = {\r\n  config: any\r\n}\r\n\r\nconst AddBtn = (props: Props) => {\r\n  const list = useContext(ListContext)\r\n\r\n  const handleModalClose = () => {\r\n    list && list.reload()\r\n  }\r\n\r\n  const { LABEL, CSS, ICON, FORM_CODE } = props.config\r\n  return (\r\n    <EasyModal\r\n      width='98%'\r\n      slot={<Button type={CSS || 'primary'} icon={ICON}>{LABEL}</Button>}\r\n      afterClose={handleModalClose}\r\n    >\r\n      <FormPage formCode={FORM_CODE} />\r\n    </EasyModal>\r\n  )\r\n}\r\n\r\nexport default AddBtn","import { useContext } from 'react'\r\nimport { Button, message } from 'antd'\r\nimport { EditContext, ModalContext, ListTableContext } from 'src/components'\r\nimport { commonStore } from 'src/stores'\r\nimport { $api } from 'src/plugins'\r\n\r\ntype Props = {\r\n  config: any\r\n}\r\n\r\nconst SaveBtn = (props: Props) => {\r\n  const edit = useContext(EditContext)\r\n  const table = useContext(ListTableContext)\r\n  const modal = useContext(ModalContext)\r\n\r\n  const handleSave = () => {\r\n    // 表单校验\r\n    const verify = edit?.verifyFormBase?.()\r\n    if (verify && Object.entries(verify).map(([item, value]) => value).filter(item => !!item).length) return\r\n\r\n    const { Nav_PageEdit } = edit.formState\r\n    const { Nav_PageEdit: deepConfig } = Nav_PageEdit\r\n    if (deepConfig.API_URL) {\r\n      const { ORG_ID } = commonStore.userinfo\r\n      $api['app/getDataByPost'](\r\n        { ORG_ID, ...edit.formBase },\r\n        { url: `/${deepConfig.API_URL}` }\r\n      ).then((res: any) => {\r\n        if (res) {\r\n          message.success('操作成功')\r\n          table && table.reload()\r\n          modal && modal.close()\r\n        }\r\n      })\r\n    } else {\r\n      message.error('未配置对应接口，请检查配置')\r\n    }\r\n  }\r\n\r\n  const { LABEL } = props.config\r\n  return <Button type='primary' onClick={handleSave}>{LABEL}</Button>\r\n}\r\n\r\nexport default SaveBtn","import { Button } from 'antd'\r\nimport { PlusOutlined } from '@ant-design/icons'\r\n\r\ntype Props = {\r\n  config: any\r\n}\r\n\r\nconst AddBtn = (props: Props) => {\r\n  const { LABEL, CSS } = props.config\r\n  return <Button type={CSS || 'primary'} icon={<PlusOutlined />}>{LABEL}</Button>\r\n}\r\n\r\nexport default AddBtn","import * as ListBtns from './buttons/list'\r\nimport * as EditBtns from './buttons/edit'\r\nimport { $consts } from 'src/plugins'\r\n\r\n/**\r\n * 编辑表单配置的各种按钮\r\n * @param props \r\n * @returns \r\n */\r\nconst EditButton = (props: any) => {\r\n  const { BTN_TYPE } = props.config\r\n  const { SaveBtn, AddBtn } = EditBtns\r\n  switch (BTN_TYPE) {\r\n    // 保存按钮\r\n    case $consts['TABLE/BTN_TYPE_SAVE']:\r\n      return <SaveBtn config={props.config} />\r\n    // 新增按钮\r\n    case $consts['TABLE/BTN_TYPE_ADD']:\r\n      return <AddBtn config={props.config} />\r\n    default:\r\n      return <div />\r\n  }\r\n}\r\n\r\n/**\r\n * 列表表单配置的各种按钮\r\n * @param props \r\n * @returns \r\n */\r\nconst ListButton = (props: any) => {\r\n  const { BTN_TYPE } = props.config\r\n  const { CustomModalBtn, DeleteConfirmBtn, AddBtn } = ListBtns\r\n  switch (BTN_TYPE) {\r\n    // 自定义弹窗按钮\r\n    case $consts['TABLE/BTN_TYPE_CUSTOM_MODAL']:\r\n      return <CustomModalBtn config={props.config} />\r\n    // 新增按钮\r\n    case $consts['TABLE/BTN_TYPE_ADD']:\r\n      return <AddBtn config={props.config} />\r\n    // 删除按钮\r\n    case $consts['TABLE/BTN_TYPE_DELETE']:\r\n      return <DeleteConfirmBtn config={props.config} />\r\n    // 编辑按钮\r\n    case $consts['TABLE/BTN_TYPE_EDIT']:\r\n      return <CustomModalBtn config={props.config} />\r\n    default:\r\n      return <div />\r\n  }\r\n}\r\n\r\ntype Props = {\r\n  pageType: 0 | 1, // 0: ListPage 1: EditPage\r\n  config: any\r\n}\r\nconst LoadableButton = (props: Props) => {\r\n  return props.pageType === $consts['TABLE/FORM_TYPE_EDIT_PAGE'] ? <EditButton config={props.config} /> : <ListButton config={props.config} />\r\n}\r\n\r\nexport default LoadableButton","import { useMemo, useContext } from 'react'\r\nimport { Form, Input } from 'antd'\r\nimport { EditContext } from 'src/components'\r\nimport { get } from 'lodash'\r\nimport { ControlProps } from 'src/components/root/LoadableControl'\r\n\r\nconst TextInput = (props: ControlProps) => {\r\n  const edit = useContext(EditContext)\r\n\r\n  const handleChange = (evt: any) => {\r\n    const { FIELD_NAME } = props.config\r\n    // 表单数据\r\n    props.onChange instanceof Function && props.onChange({ [FIELD_NAME]: evt.target.value })\r\n  }\r\n\r\n  const value = useMemo(() => {\r\n    const { FIELD_NAME } = props.config\r\n    return get(edit?.formBase, FIELD_NAME)\r\n  }, [edit, props.config])\r\n\r\n  const { evtConfig = {} } = props\r\n  const { hidden = false, disabled = false } = evtConfig\r\n\r\n  if (hidden) return null\r\n\r\n  const { LABEL, REQUIRED } = props.config\r\n  return (\r\n    <Form.Item\r\n      label={LABEL}\r\n      required={REQUIRED}\r\n      validateStatus={props.verify ? 'error' : undefined}\r\n    >\r\n      <Input disabled={disabled} value={value} onChange={handleChange} />\r\n    </Form.Item>\r\n  )\r\n}\r\n\r\nexport default TextInput","import { useMemo, useContext } from 'react'\r\nimport { Form, InputNumber } from 'antd'\r\nimport { EditContext } from 'src/components'\r\nimport { get } from 'lodash'\r\nimport { ControlProps } from 'src/components/root/LoadableControl'\r\n\r\nconst NumberInput = (props: ControlProps) => {\r\n  const edit = useContext(EditContext)\r\n\r\n  const handleChange = (val: number) => {\r\n    const { FIELD_NAME } = props.config\r\n    // 表单数据\r\n    props.onChange instanceof Function && props.onChange({ [FIELD_NAME]: val })\r\n  }\r\n\r\n  const value = useMemo(() => {\r\n    const { FIELD_NAME } = props.config\r\n    return get(edit?.formBase, FIELD_NAME)\r\n  }, [edit, props.config])\r\n\r\n  const { evtConfig = {} } = props\r\n  const { hidden = false, disabled = false } = evtConfig\r\n\r\n  if (hidden) return null\r\n\r\n  const { LABEL, REQUIRED } = props.config\r\n  return (\r\n    <Form.Item\r\n      label={LABEL}\r\n      required={REQUIRED}\r\n      validateStatus={props.verify ? 'error' : undefined}\r\n    >\r\n      <InputNumber\r\n        disabled={disabled}\r\n        value={value}\r\n        onChange={handleChange}\r\n        style={{ width: '100%' }}\r\n      />\r\n    </Form.Item>\r\n  )\r\n}\r\n\r\nexport default NumberInput","import { useState, useMemo, useContext } from 'react'\r\nimport { Form } from 'antd'\r\nimport { EditContext, PaginationSelect as ControlSelect } from 'src/components'\r\nimport { commonStore } from 'src/stores'\r\nimport { $api } from 'src/plugins'\r\nimport { initFilter, getSingleRule, extendRules } from 'src/utils/common'\r\nimport { get } from 'lodash'\r\nimport { ControlProps } from 'src/components/root/LoadableControl'\r\n\r\nconst PaginationSelect = (props: ControlProps) => {\r\n  const [source, setSource] = useState([])\r\n  const getSource = (params: any) => {\r\n    const { INPUT_DATA_API: url, Nav_Filters: filters } = props.config\r\n    if (!url) return new Promise(resolve => { resolve(false) })\r\n\r\n    const { current: PageIndex, search, initSearch } = params\r\n    const { ORG_ID: OrgId } = commonStore.userinfo\r\n    const payload = initFilter({ OrgId, PageIndex })\r\n    // 搜索过滤字段\r\n    const singleRule = [getSingleRule('NAME', 9, search)]\r\n    !search && initSearch && singleRule.push(getSingleRule('ID', 1, initSearch))\r\n    // 配置过滤字段\r\n    Array.isArray(filters) && filters.length && filters.forEach(item => {\r\n      singleRule.push(getSingleRule(item.FIELD_NAME, item.OPERATION, item.VALUE))\r\n    })\r\n    extendRules(payload.FilterGroup, singleRule)\r\n\r\n    return $api['app/getDataByPost'](payload, {\r\n      url,\r\n      fullData: true\r\n    }).then((res: any) => {\r\n      res && res.Data && setSource(res.Data)\r\n      return res\r\n    })\r\n  }\r\n\r\n  const edit = useContext(EditContext)\r\n\r\n  /**\r\n   * 获取额外保存字段\r\n   * @param {*} val \r\n   */\r\n  const getExtraSaveField = (val: string | number) => {\r\n    const extraFields: any = {}\r\n    /**\r\n     * FIELD_NAME: 配置保存的字段\r\n     * INPUT_NAV_FIELD: 导航字段，比如 NAME，则从选中的项中取 NAME 字段的值，保存在保存字段中\r\n     * INPUT_SAVE_FIELD: 保存字段，该字段通过 INPUT_NAV_FIELD 字段赋值后，一并提交给后端\r\n     */\r\n    const { INPUT_NAV_FIELD: nav, INPUT_SAVE_FIELD: save } = props.config\r\n    if (nav && save) {\r\n      const target: any = source.find((item: any) => item.ID === val)\r\n      const navs = nav.split(',')\r\n      const saves = save.split(',')\r\n      navs.forEach((item: any, index: number) => {\r\n        target && target[item] && (extraFields[saves[index]] = target[item])\r\n      })\r\n    }\r\n    return extraFields\r\n  }\r\n\r\n  const handleChange = (val: string | number) => {\r\n    const extraFields = getExtraSaveField(val)\r\n    const { FIELD_NAME } = props.config\r\n    // 表单数据\r\n    props.onChange instanceof Function && props.onChange({ [FIELD_NAME]: val, ...extraFields })\r\n  }\r\n\r\n  const value = useMemo(() => {\r\n    const { FIELD_NAME } = props.config\r\n    return get(edit?.formBase, FIELD_NAME)\r\n  }, [edit, props.config])\r\n\r\n  const { evtConfig = {} } = props\r\n  const { hidden = false, disabled = false } = evtConfig\r\n\r\n  if (hidden) return null\r\n\r\n  const { LABEL, REQUIRED } = props.config\r\n  return (\r\n    <Form.Item\r\n      label={LABEL}\r\n      required={REQUIRED}\r\n      validateStatus={props.verify ? 'error' : undefined}\r\n    >\r\n      <ControlSelect\r\n        value={value}\r\n        remoteMethod={getSource}\r\n        onChange={handleChange}\r\n        selectProps={{\r\n          allowClear: true,\r\n          disabled\r\n        }}\r\n        style={{ width: '100%' }}\r\n      />\r\n    </Form.Item>\r\n  )\r\n}\r\n\r\nexport default PaginationSelect","import { useMemo, useContext } from 'react'\r\nimport { Form, Switch } from 'antd'\r\nimport { EditContext } from 'src/components'\r\nimport { get } from 'lodash'\r\nimport { ControlProps } from 'src/components/root/LoadableControl'\r\n\r\nconst SwitchControl = (props: ControlProps) => {\r\n  const edit = useContext(EditContext)\r\n\r\n  const handleChange = (checked: boolean) => {\r\n    const { FIELD_NAME } = props.config\r\n    // 表单数据\r\n    props.onChange instanceof Function && props.onChange({ [FIELD_NAME]: checked })\r\n  }\r\n\r\n  const value = useMemo(() => {\r\n    const { FIELD_NAME } = props.config\r\n    return get(edit?.formBase, FIELD_NAME)\r\n  }, [edit, props.config])\r\n\r\n  const { evtConfig = {} } = props\r\n  const { hidden = false, disabled = false } = evtConfig\r\n\r\n  if (hidden) return null\r\n\r\n  const { LABEL, REQUIRED } = props.config\r\n\r\n  return (\r\n    <Form.Item\r\n      label={LABEL}\r\n      required={REQUIRED}\r\n      validateStatus={props.verify ? 'error' : undefined}\r\n    >\r\n      <Switch disabled={disabled} checked={value} onChange={handleChange} />\r\n    </Form.Item>)\r\n}\r\n\r\nexport default SwitchControl\r\n","import { useState, useEffect, useMemo, useContext } from 'react'\r\nimport { TextInput, NumberInput, PaginationSelect, SwitchControl } from './controls'\r\nimport { EditContext } from 'src/components'\r\nimport { $consts, $evt } from 'src/plugins'\r\nimport { verifyField } from 'src/components/root/helper'\r\n\r\ntype Props = {\r\n  config: any\r\n}\r\n\r\nexport type EvtConfig = {\r\n  disabled?: boolean,\r\n  hidden?: boolean\r\n}\r\n\r\nexport type ControlProps = {\r\n  config: any,\r\n  onChange?: Function,\r\n  verify?: boolean,\r\n  evtConfig?: EvtConfig\r\n}\r\n\r\nconst LoadableControl = (props: Props) => {\r\n  const edit = useContext(EditContext)\r\n\r\n  // 监听控件相关事件\r\n  const [evtConfig, setEvtConfig] = useState<EvtConfig>({})\r\n  useEffect(() => {\r\n    const disableControl = (field: string) => {\r\n      const { FIELD_NAME } = props.config\r\n      field === FIELD_NAME && setEvtConfig(prev => ({ ...prev, disabled: true }))\r\n    }\r\n    const enableControl = (field: string) => {\r\n      const { FIELD_NAME } = props.config\r\n      field === FIELD_NAME && setEvtConfig(prev => ({ ...prev, disabled: false }))\r\n    }\r\n\r\n    $evt.addListener($consts['COMMON/EVT_DISABLE_CONTROL'], disableControl)\r\n    $evt.addListener($consts['COMMON/EVT_ENABLE_CONTROL'], enableControl)\r\n\r\n    return () => {\r\n      $evt.removeListener($consts['COMMON/EVT_DISABLE_CONTROL'], disableControl)\r\n      $evt.removeListener($consts['COMMON/EVT_ENABLE_CONTROL'], enableControl)\r\n    }\r\n  }, [props.config])\r\n\r\n  // 校验配置\r\n  const [verify, setVerify] = useState(false)\r\n  const handleChange = (fieldBase: any) => {\r\n    const { CHANGE_FUNC } = props.config\r\n    if (edit) {\r\n      const formBase = { ...edit.formBase, ...fieldBase }\r\n      // 表单数据\r\n      edit.setFormBase(formBase)\r\n      // 表单检验\r\n      setVerify(verifyField(props.config, formBase))\r\n      // 是否配置了动态加载 js 中的方法名\r\n      edit.dynamicJs[CHANGE_FUNC] instanceof Function && edit.dynamicJs[CHANGE_FUNC]({ ...edit, formBase })\r\n    }\r\n  }\r\n\r\n  // EditPage 保存时进行的总校验\r\n  const baseVerify = useMemo(() => {\r\n    const { FIELD_NAME } = props.config\r\n    // 原始校验字段\r\n    const matchVerify = edit?.verify?.[FIELD_NAME]\r\n    // 校验字段是否在白名单中，在则不校验\r\n    const matchWhiteList = edit?.verifyWhiteList?.includes(FIELD_NAME)\r\n    return matchWhiteList ? false : matchVerify\r\n  }, [edit, props.config])\r\n  useEffect(() => {\r\n    setVerify(baseVerify)\r\n  }, [baseVerify])\r\n\r\n  const { CONTROL_TYPE } = props.config\r\n  switch (CONTROL_TYPE) {\r\n    // 文本框控件\r\n    case $consts['TABLE/CONTROL_TYPE_TEXTINPUT']:\r\n      return (\r\n        <TextInput\r\n          config={props.config}\r\n          evtConfig={evtConfig}\r\n          verify={verify}\r\n          onChange={handleChange}\r\n        />\r\n      )\r\n    // 单选 Switch 控件\r\n    case $consts['TABLE/CONTROL_TYPE_SWITCH']:\r\n      return (\r\n        <SwitchControl\r\n          config={props.config}\r\n          evtConfig={evtConfig}\r\n          verify={verify}\r\n          onChange={handleChange}\r\n        />\r\n      )\r\n    // 数值框控件\r\n    case $consts['TABLE/CONTROL_TYPE_NUMBERINPUT']:\r\n      return (\r\n        <NumberInput\r\n          config={props.config}\r\n          evtConfig={evtConfig}\r\n          verify={verify}\r\n          onChange={handleChange}\r\n        />\r\n      )\r\n    // 分页下拉控件\r\n    case $consts['TABLE/CONTROL_TYPE_PAGINATION_SELECT']:\r\n      return (\r\n        <PaginationSelect\r\n          config={props.config}\r\n          evtConfig={evtConfig}\r\n          verify={verify}\r\n          onChange={handleChange}\r\n        />\r\n      )\r\n    default:\r\n      return <div />\r\n  }\r\n}\r\n\r\nexport default LoadableControl","import React, { useState, useMemo, useEffect } from 'react'\r\nimport { Table } from 'antd'\r\nimport { LoadableButton } from 'src/components'\r\nimport { commonStore } from 'src/stores'\r\nimport { $api, $consts } from 'src/plugins'\r\nimport { initFilter, getSingleRule, extendRules, addRuleAndGroups } from 'src/utils/common'\r\nimport { renderTableCell } from './helper'\r\nimport { isEqual, cloneDeep, pick } from 'lodash'\r\n\r\ntype Props = {\r\n  formCode: string,\r\n  singlePageTable?: boolean,\r\n  radioEnable?: boolean,\r\n  checkboxEnable?: boolean,\r\n  selectedKeys?: Array<any>,\r\n  onRef?: Function,\r\n  onLoadedData?: Function,\r\n  onSelectChange?: Function\r\n}\r\n\r\n// 获取 form 对应配置\r\nconst useFormOptions = (props: Props) => {\r\n  /**\r\n   * 获取 form 对应配置\r\n   */\r\n  const getFormOptions = () => {\r\n    const { ORG_ID: OrgId } = commonStore.userinfo\r\n    const payload = initFilter({ OrgId, Keyword: props.formCode })\r\n    $api['table/getTablePageTables'](payload).then((res: any) => {\r\n      res && setFormOptions(res)\r\n    })\r\n  }\r\n\r\n  const [formOptions, setFormOptions] = useState()\r\n  useEffect(() => {\r\n    getFormOptions()\r\n  }, [])\r\n\r\n  return formOptions\r\n}\r\n\r\n// 获取 form 对应的 tables 表格的配置信息\r\nconst useTablesConfig = (props: Props) => {\r\n  /**\r\n   * 获取 form 对应的 tables 表格的配置信息\r\n   * @param {Object} param0\r\n   * @param {Object} param0.Nav_Form form 表单配置\r\n   * @param {Array}  param0.Nav_Tables form 对应 tables 数据\r\n   */\r\n  const getTablesConfig = ({ Nav_Form, Nav_Tables }: any) => {\r\n    const { ORG_ID: OrgId, ID } = commonStore.userinfo\r\n    // TODO 获取用户自定义配置\r\n    // 获取 table 配置\r\n    const promiseFunc = (table: any) => {\r\n      const payload = initFilter({ OrgId, Sort: 'NUM', Parameter1: ID })\r\n      const singleRule = getSingleRule('ID', 1, table.ID)\r\n      extendRules(payload.FilterGroup, singleRule)\r\n      return $api['table/getTablePageConfigInfo'](payload)\r\n    }\r\n    Promise.all(\r\n      Nav_Tables.map((table: any) => promiseFunc(table))\r\n    ).then(datas => {\r\n      setTablesConfig(datas.filter(item => item))\r\n    })\r\n  }\r\n\r\n  const [tablesConfig, setTablesConfig] = useState<any>()\r\n\r\n  const formOptions = useFormOptions(props)\r\n  useEffect(() => {\r\n    formOptions && getTablesConfig(formOptions)\r\n  }, [formOptions])\r\n\r\n  return tablesConfig\r\n}\r\n\r\n// 获取 tables 对应数据\r\nconst useTablesData = (props: Props, pageOption: { PageIndex: number, Limit: number }): any => {\r\n  /**\r\n   * 获取 table dataSource\r\n   * @param {Object} option table 配置\r\n   * @param {Array}  option.Nav_Columns table columns\r\n   * @param {Object} option.PageTable table 配置\r\n   * @param {Array}  option.Btns table 按钮\r\n   * @param {Array}  option.RowBtns table row 行按钮\r\n   * @param {Array}  option.TableParams table dataSource 过滤参数\r\n   * @param {Object} extraData table 请求的额外参数\r\n   */\r\n  const getTableData = (option: any, extraData: Object) => {\r\n    /**\r\n     * 根据表格操作行按钮生成对应的 columns\r\n     * @param {Array} btns table row 行按钮\r\n     * @returns \r\n     */\r\n    const getTableOperateColumns = (btns: Array<any>): Array<any> => {\r\n      if (!Array.isArray(btns) || !btns.length) return []\r\n\r\n      return [{\r\n        title: <span className='mg-l6 mg-r4'>操作</span>,\r\n        key: 'operate-column',\r\n        render: () => {\r\n          return (\r\n            <div className='operate-column'>\r\n              {\r\n                btns.map(btn => (\r\n                  <div key={btn.ID} className='operate-column__btn'>\r\n                    <LoadableButton pageType={$consts['TABLE/FORM_TYPE_LIST_PAGE']} config={btn} />\r\n                  </div>\r\n                ))\r\n              }\r\n            </div>\r\n          )\r\n        }\r\n      }]\r\n    }\r\n\r\n    /**\r\n     * 获取 table columns\r\n     * @param {Object} option\r\n     * @param {Array}  option.Nav_Columns table columns\r\n     * @param {Object} option.PageTable table 配置\r\n     * @param {Array}  option.RowBtns table row 行按钮\r\n     */\r\n    const getTableColumns = ({ Nav_Columns = [], PageTable, RowBtns }: any) => {\r\n      const columns = []\r\n      if (PageTable.IS_SHOW_ROW_NO) {\r\n        columns.push({ title: '序号', key: 'ROW_NO', dataIndex: 'ROW_NO', width: 80 })\r\n      }\r\n      Nav_Columns.forEach((col: any) => {\r\n        const { IS_DEFAULT, LABEL, FIELD_NAME } = col\r\n        if (IS_DEFAULT) {\r\n          columns.push({\r\n            title: LABEL,\r\n            key: FIELD_NAME,\r\n            dataIndex: FIELD_NAME,\r\n            render: (text: any, record: any) => {\r\n              return renderTableCell({ record, field: FIELD_NAME })\r\n            }\r\n          })\r\n        }\r\n      })\r\n      return columns.concat(getTableOperateColumns(RowBtns))\r\n    }\r\n\r\n    /**\r\n     * 获取 table dataSource 请求参数\r\n     * @param {Object} param0\r\n     * @param {Array}  param0.Nav_Columns table columns\r\n     * @param {Object} param0.PageTable table 配置\r\n     * @param {Array}  param0.TableParams table dataSource 过滤参数\r\n     */\r\n    const getTableLoadPayload = ({ Nav_Columns = [], PageTable, TableParams }: any) => {\r\n      // 数据库 SelectField 参数\r\n      const {\r\n        SORT: Sort = 'CREATE_TIME',\r\n        ORDER: Order = PageTable.SORT ? PageTable.ORDER : 1,\r\n        DefaultPageSize: Limit,\r\n        NO_SELECT_FIELD\r\n      } = PageTable\r\n\r\n      const SelectField = Nav_Columns.map((item: any) => item.FIELD_NAME).filter((item: any) => item !== 'null')\r\n      if (SelectField.length && !NO_SELECT_FIELD) {\r\n        SelectField.indexOf('ID') === -1 && SelectField.push('ID')\r\n        SelectField.indexOf('ORG_ID') === -1 && SelectField.push('ORG_ID')\r\n      }\r\n\r\n      // payload 请求参数\r\n      const { ORG_ID: OrgId } = commonStore.userinfo\r\n      const payload = initFilter({ OrgId, Sort, Order, Limit, SelectField })\r\n\r\n      // 过滤参数\r\n      const filterRules: any = []\r\n      if (Array.isArray(TableParams) && TableParams.length) {\r\n        TableParams.forEach(item => {\r\n          filterRules.push({\r\n            isCustom: item.IS_CUSTOM,\r\n            isSysParam: item.IS_SYS_PARAM,\r\n            field: item.FIELD_NAME,\r\n            operator: item.OPERATION,\r\n            value: item.VALUE\r\n          })\r\n        })\r\n      }\r\n      if (filterRules.length) {\r\n        addRuleAndGroups(payload, { rules: filterRules })\r\n      }\r\n      return Object.assign(payload, extraData)\r\n    }\r\n\r\n    return new Promise((resolve) => {\r\n      const payload = getTableLoadPayload(option)\r\n      const { PageTable } = option\r\n      let dataSource: any = []\r\n      let dataTotal = 0\r\n      $api['app/getDataByPost'](payload, { url: PageTable.API_URL, fullData: true })\r\n        .then((res: any) => {\r\n          if (res?.IsSuccessful) {\r\n            if (res?.Data?.length) {\r\n              PageTable.IS_SHOW_ROW_NO && res.Data.forEach((item: any, index: number) => item.ROW_NO = index + 1)\r\n              dataSource = res.Data\r\n              dataTotal = res.TotalCount\r\n            }\r\n          }\r\n        }).finally(() => {\r\n          resolve({\r\n            config: option,\r\n            data: {\r\n              columns: getTableColumns(option),\r\n              dataSource,\r\n              dataTotal\r\n            }\r\n          })\r\n        })\r\n    })\r\n  }\r\n\r\n  // tables: [{ config, data: { columns, dataSource, dataTotal } }]\r\n  const [tables, setTables] = useState<any>()\r\n\r\n  const tablesConfig = useTablesConfig(props)\r\n  useEffect(() => {\r\n    if (tablesConfig && tablesConfig.length) {\r\n      Promise.all(\r\n        tablesConfig.map((option: any) => getTableData(option, pageOption))\r\n      ).then(datas => {\r\n        setTables(datas.filter(item => item))\r\n      })\r\n    }\r\n  }, [tablesConfig, pageOption])\r\n\r\n  return tables\r\n}\r\n\r\nconst ListTableContext = React.createContext<any>(undefined)\r\nconst ListTable = (props: Props) => {\r\n  // table 数据\r\n  const [tableData, setTableData] = useState({\r\n    columns: [],\r\n    dataSource: []\r\n  })\r\n\r\n  // table 配置\r\n  const [tableConfig, setTableConfig] = useState()\r\n\r\n  // 分页数据\r\n  const [pagination, setPagination] = useState({ current: 1, pageSize: 10, total: 0 })\r\n  const handleTableChange = (page: any) => {\r\n    !isEqual(pagination, page) && setPagination(page)\r\n  }\r\n\r\n  // 分页请求参数\r\n  const [pageOption, setPageOption] = useState({ PageIndex: 1, Limit: 10 })\r\n  useEffect(() => {\r\n    const { current: PageIndex, pageSize: Limit } = pagination\r\n    const newOption = { PageIndex, Limit }\r\n    setPageOption(prev => !isEqual(prev, newOption) ? newOption : prev)\r\n  }, [pagination.current, pagination.pageSize])\r\n\r\n  // 获取 table 配置与数据\r\n  const tablesData = useTablesData(props, pageOption)\r\n  useEffect(() => {\r\n    if (tablesData && tablesData.length) {\r\n      // data: { columns, dataSource, dataTotal }\r\n      const { data, config } = tablesData[0]\r\n      setTableData(pick(data, ['columns', 'dataSource']))\r\n      setTableConfig(config)\r\n      setPagination(prev => {\r\n        if (prev.total === data.dataTotal) return prev\r\n\r\n        let { current, pageSize } = prev\r\n        return {\r\n          current: current * pageSize > Math.ceil(data.dataTotal / pageSize) * pageSize ? current - 1 : current,\r\n          pageSize,\r\n          total: data.dataTotal\r\n        }\r\n      })\r\n      props.onLoadedData instanceof Function && props.onLoadedData(cloneDeep({ data, config }))\r\n    }\r\n  }, [tablesData])\r\n\r\n  // 当前选中\r\n  const [selectedKeys, setSelectedKeys] = useState<any>([])\r\n  useEffect(() => {\r\n    setSelectedKeys((prev: any) => !isEqual(prev, props.selectedKeys) ? props.selectedKeys : prev)\r\n  }, [props.selectedKeys])\r\n\r\n  // 选中 record\r\n  const [selectedData, setSelectedData] = useState({})\r\n  const handleRenderRow = (record: any) => {\r\n    return {\r\n      onClick: () => {\r\n        setSelectedData([tableData.dataSource.find((item: any) => item.ID === record.ID)])\r\n      }\r\n    }\r\n  }\r\n  useEffect(() => {\r\n    const { dataSource } = tableData\r\n    const newData = dataSource.filter((item: any) => selectedKeys.indexOf(item.ID) !== -1)\r\n    setSelectedData(prev => !isEqual(prev, newData) ? newData : prev)\r\n  }, [tableData.dataSource, selectedKeys])\r\n\r\n  // table 单选、多选\r\n  const rowSelection = useMemo<any>(() => {\r\n    const { radioEnable, checkboxEnable } = props\r\n    if (!radioEnable && !checkboxEnable) return\r\n\r\n    return {\r\n      fixed: true,\r\n      type: radioEnable ? 'radio' : checkboxEnable ? 'checkbox' : '',\r\n      columnWidth: 32,\r\n      selectedRowKeys: selectedKeys,\r\n      onChange: (newKeys: any) => {\r\n        if (!isEqual(newKeys, selectedKeys)) {\r\n          setSelectedKeys(newKeys)\r\n          props.onSelectChange instanceof Function && props.onSelectChange(newKeys)\r\n        }\r\n      }\r\n    }\r\n  }, [props.radioEnable, props.checkboxEnable, selectedKeys])\r\n\r\n  // context value\r\n  const contextValue = useMemo(() => {\r\n    const { dataSource } = tableData\r\n    return {\r\n      tableConfig,\r\n      dataSource,\r\n      selectedKeys,\r\n      selectedData,\r\n      reload: () => setPageOption(prev => ({ ...prev }))\r\n    }\r\n  }, [tableData.dataSource, tableConfig, selectedKeys, selectedData])\r\n  useEffect(() => {\r\n    props.onRef instanceof Function && props.onRef(contextValue)\r\n  }, [contextValue])\r\n\r\n  // 自适应滚动\r\n  const [scroll, setScroll] = useState({ x: undefined, y: undefined })\r\n  useEffect(() => {\r\n    const newScroll: any = { x: undefined, y: undefined }\r\n    const wrapper = document.getElementsByClassName('list-table')[0]\r\n    const list = wrapper.getElementsByTagName('table')[0]\r\n    list.offsetWidth > wrapper.clientWidth && (newScroll.x = true)\r\n    list.offsetHeight > wrapper.clientHeight && (newScroll.y = true)\r\n    setScroll(prev => !isEqual(prev, newScroll) ? newScroll : prev)\r\n  })\r\n\r\n  return (\r\n    <ListTableContext.Provider value={contextValue}>\r\n      <div className='list-table'>\r\n        <Table\r\n          rowKey='ID'\r\n          dataSource={tableData.dataSource}\r\n          columns={tableData.columns}\r\n          pagination={props.singlePageTable ? false : pagination}\r\n          rowSelection={rowSelection}\r\n          onRow={handleRenderRow}\r\n          onChange={handleTableChange}\r\n          scroll={scroll}\r\n        />\r\n      </div>\r\n    </ListTableContext.Provider>\r\n  )\r\n}\r\n\r\nListTable.defaultProps = {\r\n  singlePageTable: false,\r\n  radioEnable: false,\r\n  checkboxEnable: false,\r\n  selectedKeys: []\r\n}\r\n\r\nexport { ListTableContext }\r\nexport default ListTable","// import React from 'react'\r\nimport { observer } from 'mobx-react'\r\nimport { Zone } from 'src/components'\r\nimport { $consts } from 'src/plugins'\r\n\r\nconst Main = (props: any) => {\r\n  return (\r\n    <Zone settings={[$consts['COMMON/ZONE_TOOL_STYLE']]}>真棒</Zone>\r\n  )\r\n}\r\n\r\nexport default observer(Main)"],"sourceRoot":""}