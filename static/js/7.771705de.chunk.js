(this.webpackJsonpoptiweb_moi=this.webpackJsonpoptiweb_moi||[]).push([[7],{345:function(e,t,n){},561:function(e,t,n){"use strict";n.r(t);n(156);var o=n(155),a=(n(185),n(184)),r=(n(163),n(164)),c=(n(157),n(158)),i=(n(338),n(548)),s=n(12),l=n(77),d=n(0),u=n(89),g=n(562),m=n(563),p=n(564),j=n(35),b=n(11),f=n(54),O={getItem:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[-.+*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t,n,o,a,r){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var c="";if(n)switch(n.constructor){case Number:c=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:c="; expires="+n;break;case Date:c="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+c+(a?"; domain="+a:"")+(o?"; path="+o:"")+(r?"; secure":""),!0},removeItem:function(e,t,n){return!(!e||!this.hasItem(e))&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(t?"; path="+t:""),!0)},hasItem:function(e){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[-.+*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=0;t<e.length;t++)e[t]=decodeURIComponent(e[t]);return e}},v=n(342),h=n.n(v),x=(n(345),n(10)),I="Common/VerificationCode/Number";t.default=Object(u.a)((function(e){var t=Object(d.useState)([]),n=Object(l.a)(t,2),u=n[0],v=n[1],_=Object(d.useState)({orgId:"",username:"",password:"",verifyCode:""}),C=Object(l.a)(_,2),w=C[0],y=C[1],N=Object(d.useState)({orgId:void 0,username:void 0,password:void 0,verifyCode:void 0}),k=Object(l.a)(N,2),S=k[0],E=k[1],D=Object(d.useState)(Object(f.f)()),R=Object(l.a)(D,2),T=R[0],P=R[1],U=Object(d.useState)(""),$=Object(l.a)(U,2),A=$[0],G=$[1];Object(d.useEffect)((function(){var e=function e(t){t.forEach((function(t){var n=t.Node,o=void 0===n?t:n,a=t.Children;t.title="".concat(o.NAME,"(").concat(o.CODE,")"),t.key=o.ID,t.value=o.ID,t.children=a,a&&a.length&&e(a)}))};b.a["common/getOrgList"]().then((function(t){t&&t.Data&&(j.b.setOrgInfo(t),e(t.Data),v(t.Data))}))}),[]),Object(d.useEffect)((function(){if(!w.orgId){var e=O.getItem(b.b["STORAGE/COOKIE_ORG_ID"]);e&&y(Object(s.a)(Object(s.a)({},w),{},{orgId:e}))}}),[w]);var M=function(){var t=w.orgId,n=w.username,o=w.password,a=w.verifyCode;b.a["common/getToken"]({orgId:t,username:n,password:h()(o),random:T,verificationCode:a}).then((function(t){if(t&&!t.error)return j.b.setAccessToken(t),void function(){var t=w.orgId,n=w.username,o=w.password;b.a["common/login"]({Parameter1:n,Parameter2:h()(o),Parameter4:t}).then((function(a){if(a){var r;j.b.setLoginData(a,{username:n,password:h()(o),orgId:t}),b.a["common/getAllEnum"]();var c=(null===(r=j.a.activeMenu)||void 0===r?void 0:r.ID)||Object(f.b)(a.Menus[0]);e.history.push("/main/".concat(c))}}))}();G(t.error_description)})).catch((function(e){G(e.message)}))},z=function(){!function(){var e=w.orgId,t=w.username,n=w.password,o=w.verifyCode;return E({orgId:e?void 0:"error",username:t?void 0:"error",password:n?void 0:"error",verifyCode:o?void 0:"error"}),!e||!t||!n||!o}()&&M()},J=S.orgId,K=S.username,L=S.password,F=S.verifyCode;return Object(x.jsxs)("div",{className:"login-page",children:[Object(x.jsxs)("div",{className:"login-page__login",children:[Object(x.jsx)("p",{className:"login-page__login-cn",children:"OPTiWeb\u7eb8\u673a\u667a\u80fd\u63a7\u5236\u7cfb\u7edf"}),Object(x.jsx)("div",{className:"login-page__login-box",children:Object(x.jsxs)(c.a,{className:"login-page__login-form",children:[Object(x.jsx)(c.a.Item,{validateStatus:J,children:Object(x.jsx)(i.a,{treeDefaultExpandAll:!0,treeData:u,value:w.orgId,onChange:function(e){O.setItem(b.b["STORAGE/COOKIE_ORG_ID"],e),y(Object(s.a)(Object(s.a)({},w),{},{orgId:e}))},dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:"\u8bf7\u9009\u62e9\u7ec4\u7ec7",className:"login-page__login-tree"})}),Object(x.jsx)(c.a.Item,{validateStatus:K,children:Object(x.jsx)(r.a,{onChange:function(e){return y(Object(s.a)(Object(s.a)({},w),{},{username:e.target.value}))},onPressEnter:z,prefix:Object(x.jsx)(g.a,{style:{fontSize:18}}),placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d",className:"login-page__login-input"})}),Object(x.jsx)(c.a.Item,{validateStatus:L,children:Object(x.jsx)(r.a,{type:"password",onChange:function(e){return y(Object(s.a)(Object(s.a)({},w),{},{password:e.target.value}))},onPressEnter:z,prefix:Object(x.jsx)(m.a,{style:{fontSize:18}}),placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",className:"login-page__login-input"})}),Object(x.jsx)("div",{className:"login-page__login-pwd",children:Object(x.jsx)(a.a,{defaultChecked:!0,children:"\u8bb0\u4f4f\u5bc6\u7801"})}),Object(x.jsx)(c.a.Item,{validateStatus:F,children:Object(x.jsx)(r.a,{onChange:function(e){return y(Object(s.a)(Object(s.a)({},w),{},{verifyCode:e.target.value}))},onPressEnter:z,prefix:Object(x.jsx)(p.a,{style:{fontSize:18}}),suffix:Object(x.jsx)("img",{src:"".concat(Object(f.a)(I),"/").concat(I,"?random=").concat(T),alt:"\u9a8c\u8bc1\u7801",onClick:function(){return P(Object(f.f)())},className:"login-page__login-verifyCode"},T),placeholder:"\u9a8c\u8bc1\u7801",className:"login-page__login-input"})})]})}),Object(x.jsx)(o.a,{type:"primary",className:"login-page__login-btn",disabled:j.d.visible,loading:j.d.visible,onClick:z,children:"\u767b\u5f55"}),A?Object(x.jsx)("div",{className:"login-page__login-error",children:A}):null]}),Object(x.jsx)("div",{className:"login-page__copyright",children:Object(x.jsxs)("p",{children:["Copyright \xa92020-2021 \u53a6\u95e8\u5965\u666e\u62d3\u81ea\u63a7\u79d1\u6280\u6709\u9650\u516c\u53f8 optiems ",Object(x.jsx)("a",{href:"https://beian.miit.gov.cn/",rel:"noopener noreferrer",target:"_blank",style:{color:"inherit"},children:"\u95fdICP\u590717001301\u53f7-5"})]})})]})}))}}]);
//# sourceMappingURL=7.771705de.chunk.js.map